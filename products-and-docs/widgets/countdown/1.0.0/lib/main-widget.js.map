{"version":3,"sources":["../src/main-widget.es6"],"names":["CountdownClock","endTime","config","Date","interval","fn","onChange","time","updateClock","initInterval","timeinterval","setInterval","bind","clearInterval","timeRemaining","getTimeRemaining","total","parse","seconds","Math","floor","minutes","hours","days","monthLeft","daysInMonth","year","month","D","parseInt","setMonth","getMonth","today","curr_day","getUTCDate","curr_month","getUTCMonth","curr_year","getUTCFullYear","curr_days_in_month","servYear","servMonth","servDay","serv_days_in_month","abs","TicketmasterCountdownWidget","attr","hasOwnProperty","attrs","widgetConfig","loadConfig","responce","eventResponce","parseEvent","border","id","eventId","window","location","host","params","verboseName","i","item","isConfigAttrExistAndNotEmpty","root","widgetRoot","eventsRootContainer","document","createElement","classList","add","appendChild","eventsRoot","attributes","theme","getElementById","makeRequest","styleLoadingHandler","themeUrl","style","height","width","borderRadius","borderradius","borderWidth","borderSize","initBuyBtn","AdditionalElements","initMessage","buildCountdown","apiUrl","eventsLoadingHandler","eventReqAttrs","showMessage","embedUniversePlugin","embedTMPlugin","countDownWrapper","countdownClock","onCountdownChange","toggleSecondsVisibility","val","countDownMonth","innerHTML","remove","countDownDays","data","me","event","date","dateTime","chenHeaderEvent","eventT","now","msecsNow","eventDateStart","msecsStart","eventDateEnd","dateTimeEnd","msecsEnd","isNaN","timeLeft","getNormalizedDateValue","showStatusMessage","countDownHours","countDownMinute","countDownSecond","buyBtn","createTextNode","target","href","setAttribute","addEventListener","e","preventDefault","url","el","querySelector","isUniversePluginInitialized","isUniverseUrl","isTMPluginInitialized","isAllowedTMEvent","updateTransition","match","t","n","r","length","tmWidgetWhiteList","indexOf","script","portalUrl","head","getElementsByTagName","messageDialog","messageContent","message","hideMessageWithoutDelay","className","messageTimeout","clearTimeout","legalNoticeContent","legalNotice","legalNoticeUrl","logo","logoUrl","logoBox","question","toolTip","tooltipHtml","questionUrl","widgetVersion","toolTipHandler","nextSibling","toggle","result","day","MONTH_NAMES","DAY_NAMES","dayArray","split","d","M","E","getDay","timeArray","H","m","a","modificatorList","getElementsByClassName","parent","parentNode","removeChild","clearEvents","isFullWidthTheme","oldTheme","constructor","needToUpdate","updateExceptions","clear","heightStatic","display","update","events","undefined","newTheme","forCheck","Object","keys","map","key","NamedNodeMap","value","name","replace","readyState","XMLHttpRequest","DONE","status","widget","textContent","responseText","console","info","loadOnce","log","changeDefaultId","JSON","publishEvent","hideMessage","onEventLoadError","call","_ref","_ref2","setBuyBtnUrl","DOMElement","createDOMItem","images","sort","b","myImg","forEach","element","eventSet","currentEvent","dates","start","localDate","localTime","end","dayEnd","timeEnd","_embedded","venue","venues","address","img","getImageForEvent","prototype","addDays","setDate","getDate","zipVegas","newAttr","assign","convertedNewStartDate","setUTCSeconds","round","getTime","toJSON","slice","startDateTime","zipcode","changeDefaultIdHandler","getValidId","newStartDate","ii","setEventId","eventsWrap","newId","handler","method","join","xmlHTTP","ActiveXObject","setRequestHeader","onreadystatechange","open","send","isBlank","getAttribute","win","focus","itemConfig","medWrapper","image","backgroundImage","nameContent","initPretendedLink","dateTimeContent","formatDate","dateWraper","addressWrapper","addressNameText","addressName","addressOneText","line1","addressOne","addressTwoText","line2","addressTwo","categoriesWrapper","categories","categoryText","category","atob","btoa","widgetsCountdown","widgetContainers","querySelectorAll","push","s","o","g","q","arguments","l","async","src","insertBefore","ga","module","exports"],"mappings":";;;;;;IAAMA,c;;;sBACQC,O,EAAS;AAAE,WAAKC,MAAL,CAAYD,OAAZ,GAAsBA,OAAtB;AAAgC,K;wBAC1C;AAAE,aAAO,KAAKC,MAAL,CAAYD,OAAZ,IAAuB,IAAIE,IAAJ,EAA9B;AAA0C;;;sBAE5CC,Q,EAAU;AAAE,aAAO,KAAKF,MAAL,CAAYE,QAAZ,GAAuBA,QAA9B;AAAyC,K;wBACpD;AAAE,aAAO,KAAKF,MAAL,CAAYE,QAAZ,IAAwB,IAA/B;AAAqC;;;sBAExCC,E,EAAI;AAAE,aAAO,KAAKH,MAAL,CAAYI,QAAZ,GAAuBD,EAA9B;AAAmC,K;wBACxC;AAAE,aAAO,KAAKH,MAAL,CAAYI,QAAZ,IAAyB,UAACC,IAAD,EAAU,CAAE,CAA5C;AAA8C;;;AAE9D,4BAAyB;AAAA,QAAbL,MAAa,uEAAJ,EAAI;;AAAA;;AACvB,SAAKA,MAAL,GAAcA,MAAd;AACA,SAAKM,WAAL;AACA,QAAG,KAAKN,MAAL,CAAYD,OAAf,EAAwB,KAAKQ,YAAL;AACzB;;;;mCAEa;AACZ,WAAKC,YAAL,GAAoBC,YAAY,KAAKH,WAAL,CAAiBI,IAAjB,CAAsB,IAAtB,CAAZ,EAAyC,KAAKR,QAA9C,CAApB;AACD;;;2BAEMH,O,EAAQ;AACbY,oBAAc,KAAKH,YAAnB;AACA,WAAKT,OAAL,GAAeA,OAAf;AACA,WAAKO,WAAL;AACA,UAAGP,OAAH,EAAY,KAAKQ,YAAL;AACb;;;kCAEa;AACZ,UAAIK,gBAAgB,KAAKC,gBAAL,EAApB;AACA,WAAKT,QAAL,CAAcQ,aAAd;AACA,UAAIA,cAAcE,KAAd,IAAuB,CAA3B,EAA8BH,cAAc,KAAKH,YAAnB;AAC/B;;AAED;;;;;;;;;;;;;;;;;;uCAgBmB;AACjB,UAAIM,QAAQb,KAAKc,KAAL,CAAW,KAAKhB,OAAhB,IAA2BE,KAAKc,KAAL,CAAW,IAAId,IAAJ,EAAX,CAAvC;AACA,UAAGa,SAAS,CAAZ,EAAeA,QAAQ,CAAR;AACf,UAAIE,UAAUC,KAAKC,KAAL,CAAYJ,QAAQ,IAAT,GAAiB,EAA5B,CAAd;AAAA,UACEK,UAAUF,KAAKC,KAAL,CAAYJ,QAAQ,IAAR,GAAe,EAAhB,GAAsB,EAAjC,CADZ;AAAA,UAEEM,QAAQH,KAAKC,KAAL,CAAYJ,QAAQ,OAAT,CAAiB,sBAAjB,GAA2C,EAAtD,CAFV;AAAA,UAGEO,OAAOJ,KAAKC,KAAL,CAAWJ,QAAQ,QAAnB,CAA4B,2BAA5B,CAHT;AAAA,UAIEQ,YAAY,CAJd;AAKE;;AAEF,UAAIC,cAAc,SAAdA,WAAc,CAASC,IAAT,EAAcC,KAAd,EAAoB;AACpC,YAAIC,IAAE,IAAIzB,IAAJ,CAASuB,IAAT,EAAeC,QAAM,CAArB,EAAwB,CAAxB,EAA2B,EAA3B,CAAN;AACA,eAAOE,SAAS,CAAC,CAAC1B,KAAKc,KAAL,CAAWW,CAAX,CAAD,GAAeA,EAAEE,QAAF,CAAWF,EAAEG,QAAF,KAAa,CAAxB,CAAf,GAA0C,IAA3C,IAAiD,KAA1D,CAAP;AACD,OAHD;;AAKA,UAAIC,QAAQ,IAAI7B,IAAJ,EAAZ;AAAA,UACI8B,WAAWD,MAAME,UAAN,EADf;AAAA,UAEIC,aAAaH,MAAMI,WAAN,EAFjB;AAAA,UAGIC,YAAYL,MAAMM,cAAN,EAHhB;AAAA,UAIIC,qBAAqBd,YAAYY,SAAZ,EAAuBF,UAAvB,CAJzB;;AAMA,UAAGZ,OAAOgB,kBAAV,EAA6B;AAC3B,YAAIC,WAAW,IAAIrC,IAAJ,CAAS,KAAKF,OAAd,EAAuBqC,cAAvB,EAAf;AAAA,YACIG,YAAY,IAAItC,IAAJ,CAAS,KAAKF,OAAd,EAAuBmC,WAAvB,EADhB;AAAA,YAEIM,UAAU,IAAIvC,IAAJ,CAAS,KAAKF,OAAd,EAAuBiC,UAAvB,EAFd;AAAA,YAGIS,qBAAqBlB,YAAYe,QAAZ,EAAsBC,SAAtB,CAHzB;;AAKAjB,oBAAYL,KAAKC,KAAL,CAAYG,OAAKE,YAAYe,QAAZ,EAAqBC,SAArB,CAAjB,CAAZ;;AAEAlB,eAAOJ,KAAKyB,GAAL,CAASF,UAAUT,QAAnB,CAAP;;AAEA;;;;;AAKD;;AAED,aAAO;AACLjB,oBADK;AAEL;AACAQ,4BAHK;AAILD,kBAJK;AAKLD,oBALK;AAMLD,wBANK;AAOLH;AAPK,OAAP;AASD;;;;;;IAGG2B,2B;;;;;AA2CJ;;iDAE6BC,I,EAAM;AACjC,UAAI,CAAC,KAAK5C,MAAL,CAAY6C,cAAZ,CAA2BD,IAA3B,CAAD,IAAqC,KAAK5C,MAAL,CAAY4C,IAAZ,MAAsB,WAA/D,EAA2E;AACzE,eAAO,KAAP;AACD,OAFD,MAEM,IAAI,KAAK5C,MAAL,CAAY4C,IAAZ,MAAsB,EAA1B,EAA6B;AACjC,eAAO,KAAP;AACD;AACD,aAAO,IAAP;AACD;;;sBAlDUE,K,EAAO;AAAE,WAAKC,YAAL,GAAoB,KAAKC,UAAL,CAAgBF,KAAhB,CAApB;AAA6C,K;wBACpD;AAAE,aAAO,KAAKC,YAAZ;AAA2B;;;sBAEhCE,Q,EAAS;AAAE,WAAKC,aAAL,GAAqB,KAAKC,UAAL,CAAgBF,QAAhB,CAArB;AAAgD,K;wBAC1D;AAAE,aAAO,KAAKC,aAAZ;AAA2B;;;wBAExB;AAAE,aAAO,KAAKlD,MAAL,CAAYoD,MAAZ,IAAsB,CAA7B;AAAgC;;;wBAEpC;AAAE,aAAO,oCAAP;AAA8C;;;sBAElDC,E,EAAG;AAAE,WAAKrD,MAAL,CAAYqD,EAAZ,GAAiBA,EAAjB;AAAqB,K;wBACzB;AAAE,aAAO,KAAKrD,MAAL,CAAYqD,EAAnB;AAAuB;;;wBAE1B;AAAE,aAAO,KAAKrD,MAAL,CAAYqD,EAAZ,yDAAqE,KAAKrD,MAAL,CAAYqD,EAAjF,mEAAiJ,KAAKC,OAAtJ,UAAP;AAA8K;;;wBAE7K;AACb,aAAQC,OAAOC,QAAP,CAAgBC,IAAhB,KAAyB,4BAA1B,wLAAP;AAGD;;;wBAEc;AACb,aAAQF,OAAOC,QAAP,CAAgBC,IAAhB,KAAyB,4BAA1B,wFAAP;AAGD;;;wBAEa;AAAE,aAAO,+BAAP;AAAyC;;;wBAEpC;AAAE,aAAO,yDAAP;AAAmE;;;wBAEtE;AAAE,aAAO,OAAP;AAAiB;;;wBAErB;AAAE,aAAO,gDAAP;AAA0D;;;wBAEvD;AAAE,aAAO,CAAC,OAAD,EAAU,QAAV,EAAoB,QAApB,EAA8B,cAA9B,EAA8C,QAA9C,EAAwD,WAAxD,EAAqE,SAArE,CAAP;AAAuF;;;wBAE1F;AAAE,aAAO,IAAP;AAAc;;;wBAEf;AAAE,aAAO,CAAC,kBAAD,EAAqB,kBAArB,EAAyC,kBAAzC,EAA6D,kBAA7D,EAAiF,kBAAjF,EAAqG,kBAArG,EAAyH,kBAAzH,EAA6I,kBAA7I,EAAiK,kBAAjK,EAAqL,kBAArL,EAAyM,kBAAzM,EAA6N,kBAA7N,EAAiP,kBAAjP,EAAqQ,kBAArQ,EAAyR,kBAAzR,EAA6S,kBAA7S,EAAiU,kBAAjU,EAAqV,kBAArV,CAAP;AAAkX;;;wBAaxX;AACjB,UAAIX,QAAQ,EAAZ;AAAA,UACAY,SAAS,CACP;AACEd,cAAM,UADR;AAEEe,qBAAa;AAFf,OADO,CADT;;AAQA,WAAI,IAAIC,CAAR,IAAaF,MAAb,EAAoB;AAClB,YAAIG,OAAOH,OAAOE,CAAP,CAAX;AACA,YAAG,KAAKE,4BAAL,CAAkCD,KAAKjB,IAAvC,CAAH,EACEE,MAAMe,KAAKF,WAAX,IAA0B,KAAK3D,MAAL,CAAY6D,KAAKjB,IAAjB,CAA1B;AACH;;AAED,aAAOE,KAAP;AACD;;;AAED,uCAAYiB,IAAZ,EAAkB;AAAA;;AAChB,SAAKC,UAAL,GAAkBD,IAAlB;;AAEA,SAAKE,mBAAL,GAA2BC,SAASC,aAAT,CAAuB,KAAvB,CAA3B;AACA,SAAKF,mBAAL,CAAyBG,SAAzB,CAAmCC,GAAnC,CAAuC,uBAAvC;AACA,SAAKL,UAAL,CAAgBM,WAAhB,CAA4B,KAAKL,mBAAjC;;AAEA,SAAKM,UAAL,GAAkBL,SAASC,aAAT,CAAuB,IAAvB,CAAlB;AACA,SAAKI,UAAL,CAAgBH,SAAhB,CAA0BC,GAA1B,CAA8B,aAA9B;AACA,SAAKJ,mBAAL,CAAyBK,WAAzB,CAAqC,KAAKC,UAA1C;;AAEA;AACA;;;;AAIA,SAAKvE,MAAL,GAAc,KAAKgE,UAAL,CAAgBQ,UAA9B;AACA,SAAKlB,OAAL,GAAe,KAAKtD,MAAL,CAAYqD,EAA3B;;AAEA,QAAG,KAAKrD,MAAL,CAAYyE,KAAZ,KAAsB,IAAtB,IAA8B,CAACP,SAASQ,cAAT,mBAAwC,KAAK1E,MAAL,CAAYyE,KAApD,CAAlC,EAA+F;AAC7F,WAAKE,WAAL,CAAkB,KAAKC,mBAAvB,EAA4C,KAAKC,QAAL,GAAgB,KAAK7E,MAAL,CAAYyE,KAA5B,GAAoC,MAAhF;AACD;;AAED,SAAKT,UAAL,CAAgBc,KAAhB,CAAsBC,MAAtB,GAAkC,KAAK/E,MAAL,CAAY+E,MAA9C;AACA,SAAKf,UAAL,CAAgBc,KAAhB,CAAsBE,KAAtB,GAAkC,KAAKhF,MAAL,CAAYgF,KAA9C;;AAEA,SAAKf,mBAAL,CAAyBa,KAAzB,CAA+BC,MAA/B,GAA2C,KAAK/E,MAAL,CAAY+E,MAAvD;AACA,SAAKd,mBAAL,CAAyBa,KAAzB,CAA+BE,KAA/B,GAA2C,KAAKhF,MAAL,CAAYgF,KAAvD;AACA,SAAKf,mBAAL,CAAyBa,KAAzB,CAA+BG,YAA/B,GAAiD,KAAKjF,MAAL,CAAYkF,YAA7D;AACA,SAAKjB,mBAAL,CAAyBa,KAAzB,CAA+BK,WAA/B,GAAgD,KAAKC,UAArD;;AAEA,SAAKC,UAAL;;AAEA,SAAKC,kBAAL;;AAEA,SAAKC,WAAL;;AAEA,SAAKC,cAAL;;AAEA,QAAG,KAAKC,MAAR,EAAe;AACb,WAAKd,WAAL,CAAkB,KAAKe,oBAAvB,EAA6C,KAAKD,MAAlD,EAA0D,KAAKE,aAA/D;AACD,KAFD,MAEK;AACH,WAAKC,WAAL,CAAiB,wBAAjB,EAA2C,IAA3C,EAAiD,IAAjD;AACD;;AAED;;;;AAIA,SAAKC,mBAAL;AACA,SAAKC,aAAL;;AAEA,SAAKC,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,mBAApC;;AAEA,SAAK2B,cAAL,GAAsB,IAAIlG,cAAJ,CAAmB;AACvCM,gBAAU,KAAK6F,iBAAL,CAAuBvF,IAAvB,CAA4B,IAA5B;AAD6B,KAAnB,CAAtB;;AAIA,SAAKwF,uBAAL;AACD;;;;2CAEsBC,G,EAAI;AACzB,aAAO,CAACA,MAAM,CAAN,IAAWA,MAAM,CAAjB,GAAqB,EAArB,GAA0B,GAA3B,IAAkCA,GAAzC;AACD;;;8CAEwB;AACvB,UAAG,KAAKC,cAAL,CAAoBC,SAApB,GAAgC,CAAnC,EAAqC;AACnC,aAAKN,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,cAApC;AACA,aAAK0B,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,WAAvC;AACA,aAAKP,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,YAAvC,EAHmC,CAGkB;AACtD,OAJD,MAIM,IAAG,KAAKC,aAAL,CAAmBF,SAAnB,IAAgC,CAAnC,EAAqC;AACzC,aAAKN,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,YAApC;AACA,aAAK0B,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,WAApC;AACA,aAAK0B,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,cAAvC;AACD,OAJK,MAIA;AACJ,aAAKP,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,YAApC;AACA,aAAK0B,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,WAAvC;AACA,aAAKP,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,cAAvC;AACD;AACF;;;sCAEiBE,I,EAAK;AACrB,UAAIC,KAAK,IAAT;AACA,UAAG,KAAKC,KAAL,CAAWC,IAAX,IAAmB,KAAKD,KAAL,CAAWC,IAAX,CAAgBC,QAAtC,EAA+C;AAC7CC,wBAAgB,KAAKH,KAAL,CAAWC,IAA3B;AACD;;AAED,eAASE,eAAT,CAAyBC,MAAzB,EAAgC;AAC9B,YAAIC,MAAM,IAAI9G,IAAJ,EAAV;AAAA,YACI+G,WAAW/G,KAAKc,KAAL,CAAWgG,GAAX,CADf;AAAA,YAEIE,iBAAiB,IAAIhH,IAAJ,CAAS6G,OAAOF,QAAhB,CAFrB;AAAA,YAGIM,aAAajH,KAAKc,KAAL,CAAWkG,cAAX,CAHjB;AAAA,YAIIE,eAAe,IAAIlH,IAAJ,CAAS6G,OAAOM,WAAhB,CAJnB;AAAA,YAKIC,WAAWpH,KAAKc,KAAL,CAAWoG,YAAX,CALf;;AAOA,YAAIH,WAAWK,QAAX,IAAuBC,MAAMD,QAAN,CAA3B,EAA4C;AAC1CZ,aAAGb,WAAH,+BAA6C,KAA7C,EAAqD,uBAArD;AACD,SAFD,MAEO,IAAIsB,aAAaF,QAAb,GAAwBK,QAA5B,EAAsC;AAC3CZ,aAAGb,WAAH,yBAAuC,KAAvC,EAA+C,uBAA/C;AACD;AACF;AACF;;;sCAEiBY,I,EAAK;AACrB,UAAIe,WAAW,KAAKC,sBAAL,CAA4BhB,KAAK1F,KAAjC,CAAf;AAAA,UACIiG,MAAM9G,KAAKc,KAAL,CAAY,IAAId,IAAJ,EAAZ,CADV;;AAGA;AACA,UAAGsH,YAAY,CAAZ,IAAiBR,MAAMQ,QAA1B,EAAmC;AACjC,aAAKxB,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,mBAApC;AACA,YAAG,KAAKf,OAAL,IAAgB,KAAKoD,KAAxB,EAA8B;AAC5B,eAAKe,iBAAL,CAAuBjB,IAAvB;AACA,iBAAO,KAAP,CAF4B,CAEd;AACf;AACF,OAND,MAMM,KAAKT,gBAAL,CAAsB3B,SAAtB,CAAgCkC,MAAhC,CAAuC,mBAAvC;;AAEN,UAAGE,KAAKlF,SAAL,GAAiB,EAApB,EAAuB;AACrB,aAAKsE,WAAL,qCAAmDY,KAAKlF,SAAxD,gBAA4EkF,KAAKnF,IAAjF,eAA+FmF,KAAKpF,KAApG,aAAmH,KAAnH,EAA2H,uBAA3H;AACA,aAAK2E,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,mBAApC;AACA,eAAO,KAAP;AACD;;AAED,WAAK+B,cAAL,CAAoBC,SAApB,GAAgC,KAAKmB,sBAAL,CAA4BhB,KAAKlF,SAAjC,CAAhC;AACA,WAAKiF,aAAL,CAAmBF,SAAnB,GAA+B,KAAKmB,sBAAL,CAA4BhB,KAAKnF,IAAjC,CAA/B;AACA,WAAKqG,cAAL,CAAoBrB,SAApB,GAAgC,KAAKmB,sBAAL,CAA4BhB,KAAKpF,KAAjC,CAAhC;AACA,WAAKuG,eAAL,CAAqBtB,SAArB,GAAiC,KAAKmB,sBAAL,CAA4BhB,KAAKrF,OAAjC,CAAjC;AACA,WAAKyG,eAAL,CAAqBvB,SAArB,GAAiC,KAAKmB,sBAAL,CAA4BhB,KAAKxF,OAAjC,CAAjC;;AAEA,WAAKkF,uBAAL;AAED;;;qCAEe;AACd,WAAKH,gBAAL,GAAwB7B,SAASC,aAAT,CAAuB,KAAvB,CAAxB;AACA,WAAK4B,gBAAL,CAAsB3B,SAAtB,CAAgCC,GAAhC,CAAoC,mBAApC;AACA,WAAK+B,cAAL,GAAsBlC,SAASC,aAAT,CAAuB,MAAvB,CAAtB;AACA,WAAKoC,aAAL,GAAqBrC,SAASC,aAAT,CAAuB,MAAvB,CAArB;AACA,WAAKuD,cAAL,GAAsBxD,SAASC,aAAT,CAAuB,MAAvB,CAAtB;AACA,WAAKwD,eAAL,GAAuBzD,SAASC,aAAT,CAAuB,MAAvB,CAAvB;AACA,WAAKyD,eAAL,GAAuB1D,SAASC,aAAT,CAAuB,MAAvB,CAAvB;;AAEA,WAAKiC,cAAL,CAAoBC,SAApB,GAAgC,IAAhC;AACA,WAAKE,aAAL,CAAmBF,SAAnB,GAA+B,IAA/B;AACA,WAAKqB,cAAL,CAAoBrB,SAApB,GAAgC,IAAhC;AACA,WAAKsB,eAAL,CAAqBtB,SAArB,GAAiC,IAAjC;AACA,WAAKuB,eAAL,CAAqBvB,SAArB,GAAiC,IAAjC;;AAEA,WAAKD,cAAL,CAAoBhC,SAApB,CAA8BC,GAA9B,CAAkC,0BAAlC;AACA,WAAKkC,aAAL,CAAmBnC,SAAnB,CAA6BC,GAA7B,CAAiC,wBAAjC;AACA,WAAKqD,cAAL,CAAoBtD,SAApB,CAA8BC,GAA9B,CAAkC,yBAAlC;AACA,WAAKsD,eAAL,CAAqBvD,SAArB,CAA+BC,GAA/B,CAAmC,2BAAnC;AACA,WAAKuD,eAAL,CAAqBxD,SAArB,CAA+BC,GAA/B,CAAmC,2BAAnC;;AAEA,WAAK0B,gBAAL,CAAsBzB,WAAtB,CAAkC,KAAK8B,cAAvC;AACA,WAAKL,gBAAL,CAAsBzB,WAAtB,CAAkC,KAAKiC,aAAvC;AACA,WAAKR,gBAAL,CAAsBzB,WAAtB,CAAkC,KAAKoD,cAAvC;AACA,WAAK3B,gBAAL,CAAsBzB,WAAtB,CAAkC,KAAKqD,eAAvC;AACA,WAAK5B,gBAAL,CAAsBzB,WAAtB,CAAkC,KAAKsD,eAAvC;;AAEA,WAAK3D,mBAAL,CAAyBK,WAAzB,CAAqC,KAAKyB,gBAA1C;AACD;;;iCAEW;AACV,WAAK8B,MAAL,GAAc3D,SAASC,aAAT,CAAuB,GAAvB,CAAd;AACA,WAAK0D,MAAL,CAAYvD,WAAZ,CAAwBJ,SAAS4D,cAAT,CAAwB,SAAxB,CAAxB;AACA,WAAKD,MAAL,CAAYzD,SAAZ,CAAsBC,GAAtB,CAA0B,eAA1B;AACA,WAAKwD,MAAL,CAAYE,MAAZ,GAAqB,QAArB;AACA,WAAKF,MAAL,CAAYG,IAAZ,GAAmB,EAAnB;AACA,WAAKH,MAAL,CAAYI,YAAZ,CAAyB,SAAzB,EAAoC,0DAApC;AACA,WAAKJ,MAAL,CAAYK,gBAAZ,CAA6B,OAA7B,EAAsC,UAACC,CAAD,EAAO;AAC3CA,UAAEC,cAAF;AACD,OAFD;AAGA,WAAKnE,mBAAL,CAAyBK,WAAzB,CAAqC,KAAKuD,MAA1C;AACD;;;qCAEgBQ,G,EAAK;AACpB,UAAIC,KAAK,KAAKrE,mBAAL,CAAyBsE,aAAzB,CAAuC,2BAAvC,CAAT;AACA,UAAGF,QAAO,EAAV,EAAc;AACZ,YAAGC,EAAH,EAAM;AACJA,aAAGlE,SAAH,CAAaC,GAAb,CAAiB,YAAjB;AACAiE,aAAGlE,SAAH,CAAakC,MAAb,CAAoB,eAApB;AACD,SAHD,MAGM;AACP,OALD,MAMI;AACFgC,aAAK,KAAKrE,mBAAL,CAAyBsE,aAAzB,CAAuC,wBAAvC,CAAL;AACA,YAAGD,EAAH,EAAM;AACJA,aAAGlE,SAAH,CAAakC,MAAb,CAAoB,YAApB;AACAgC,aAAGlE,SAAH,CAAaC,GAAb,CAAiB,eAAjB;AACD;AACF;AACF;;;mCAEa;AACZ,UAAG,KAAKwD,MAAR,EAAe;AACb,YAAInB,QAAQ,KAAKA,KAAjB;AAAA,YACI2B,MAAM,EADV;AAEA,YAAG3B,KAAH,EAAS;AACP,cAAGA,MAAM2B,GAAT,EAAa;AACX,gBAAI,KAAKG,2BAAL,IAAoC,KAAKC,aAAL,CAAmB/B,MAAM2B,GAAzB,CAArC,IAAwE,KAAKK,qBAAL,IAA8B,KAAKC,gBAAL,CAAsBjC,MAAM2B,GAA5B,CAAzG,EAA2I;AACzIA,oBAAM3B,MAAM2B,GAAZ;AACD;AACD,iBAAKO,gBAAL,CAAsBP,GAAtB;AACD;AACF;AACD,aAAKR,MAAL,CAAYG,IAAZ,GAAmBK,GAAnB;AACD;AACF;;;kCAEaA,G,EAAI;AAChB,aAAQA,IAAIQ,KAAJ,CAAU,eAAV,KAA8BR,IAAIQ,KAAJ,CAAU,gBAAV,CAAtC;AACD;;;qCAEgBR,G,EAAI;AACnB,WAAK,IAAIS,IAAI,CAAC,iDAAD,EAAoD,yDAApD,CAAR,EAAwHC,IAAI,IAA5H,EAAkIC,IAAI,CAA3I,EAA8IA,IAAIF,EAAEG,MAAN,KAAiBF,IAAIV,IAAIQ,KAAJ,CAAUC,EAAEE,CAAF,CAAV,CAAJ,EAAqB,SAASD,CAA/C,CAA9I,EAAiMC,GAAjM;AACA,UAAI3F,KAAM,SAAS0F,CAAT,GAAaA,EAAE,CAAF,CAAb,GAAoB,KAAK,CAAnC;AACA,aAAQ,KAAKG,iBAAL,CAAuBC,OAAvB,CAA+B9F,EAA/B,IAAqC,CAAC,CAA9C;AACD;;;oCAEc;AACb,UAAIA,KAAK,cAAT;AACA,UAAI,CAACa,SAASQ,cAAT,CAAwBrB,EAAxB,CAAL,EAAmC;AACjC,YAAI+F,SAASlF,SAASC,aAAT,CAAuB,QAAvB,CAAb;AACAiF,eAAOnB,YAAP,CAAoB,KAApB,EAA2B,KAAKoB,SAAL,GAAiB,uBAA5C;AACAD,eAAOnB,YAAP,CAAoB,MAApB,EAA4B,iBAA5B;AACAmB,eAAOnB,YAAP,CAAoB,SAApB,EAA+B,OAA/B;AACAmB,eAAOnB,YAAP,CAAoB,IAApB,EAA0B5E,EAA1B;AACA,SAACa,SAASoF,IAAT,IAAiBpF,SAASqF,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAAlB,EAA4DjF,WAA5D,CAAwE8E,MAAxE;AACD;AACD,WAAKV,qBAAL,GAA6B,IAA7B;AACD;;;0CAEoB;AACnB,UAAIrF,KAAK,oBAAT;AACA,UAAI,CAACa,SAASQ,cAAT,CAAwBrB,EAAxB,CAAL,EAAkC;AAChC,YAAI+F,SAASlF,SAASC,aAAT,CAAuB,QAAvB,CAAb;AACAiF,eAAOnB,YAAP,CAAoB,KAApB,EAA2B,mCAA3B;AACAmB,eAAOnB,YAAP,CAAoB,MAApB,EAA4B,iBAA5B;AACAmB,eAAOnB,YAAP,CAAoB,SAApB,EAA+B,OAA/B;AACAmB,eAAOnB,YAAP,CAAoB,IAApB,EAA0B5E,EAA1B;AACA,SAACa,SAASoF,IAAT,IAAiBpF,SAASqF,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAAlB,EAA4DjF,WAA5D,CAAwE8E,MAAxE;AACD;AACD,WAAKZ,2BAAL,GAAmC,IAAnC;AACD;;AAED;;;;kCACa;AACX,WAAKgB,aAAL,GAAqBtF,SAASC,aAAT,CAAuB,KAAvB,CAArB;AACA,WAAKqF,aAAL,CAAmBpF,SAAnB,CAA6BC,GAA7B,CAAiC,eAAjC;AACA,WAAKoF,cAAL,GAAsBvF,SAASC,aAAT,CAAuB,KAAvB,CAAtB;AACA,WAAKsF,cAAL,CAAoBrF,SAApB,CAA8BC,GAA9B,CAAkC,wBAAlC;;AAEA;;;;;;AAMA,WAAKmF,aAAL,CAAmBlF,WAAnB,CAA+B,KAAKmF,cAApC;AACA;AACA,WAAKxF,mBAAL,CAAyBK,WAAzB,CAAqC,KAAKkF,aAA1C;AACD;;;gCAEWE,O,EAASC,uB,EAA0B,yBAAyBC,S,EAAW;AACjF,UAAGF,QAAQT,MAAX,EAAkB;AAChB,aAAKU,uBAAL,GAA+BA,uBAA/B;AACA,aAAKF,cAAL,CAAoBpD,SAApB,GAAgCqD,OAAhC;AACA,aAAKF,aAAL,CAAmBI,SAAnB,GAA+B,EAA/B;AACA,aAAKJ,aAAL,CAAmBpF,SAAnB,CAA6BC,GAA7B,CAAiC,eAAjC;AACA,aAAKmF,aAAL,CAAmBpF,SAAnB,CAA6BC,GAA7B,CAAiC,uBAAjC;AACA;AACD;;AAED,UAAIuF,SAAJ,EAAe;AACb,aAAKJ,aAAL,CAAmBpF,SAAnB,CAA6BC,GAA7B,CAAiCuF,SAAjC;AACD,OAFD,MAEM;AACJ,aAAKJ,aAAL,CAAmBpF,SAAnB,CAA6BC,GAA7B,CAAiC,uBAAjC;AACA,aAAKmF,aAAL,CAAmBpF,SAAnB,CAA6BkC,MAA7B,CAAoCsD,SAApC;AACD;;AAEDA,kBAAY,IAAZ;AAED;;;kCAEY;AACX,UAAG,KAAKC,cAAR,EAAwBC,aAAa,KAAKD,cAAlB,EADb,CACgD;AAC3D,WAAKL,aAAL,CAAmBpF,SAAnB,CAA6BkC,MAA7B,CAAoC,uBAApC;AACD;AACD;;;;yCAEoB;AAClB,UAAIyD,qBAAqB7F,SAAS4D,cAAT,CAAwB,cAAxB,CAAzB;AAAA,UACIkC,cAAc9F,SAASC,aAAT,CAAuB,GAAvB,CADlB;AAEA6F,kBAAY1F,WAAZ,CAAwByF,kBAAxB;AACAC,kBAAY5F,SAAZ,CAAsBC,GAAtB,CAA0B,cAA1B;AACA2F,kBAAYjC,MAAZ,GAAqB,QAArB;AACAiC,kBAAYhC,IAAZ,GAAmB,KAAKiC,cAAxB;AACA,WAAKjG,UAAL,CAAgBM,WAAhB,CAA4B0F,WAA5B;;AAEA,UAAIE,OAAOhG,SAASC,aAAT,CAAuB,GAAvB,CAAX;AACA+F,WAAK9F,SAAL,CAAeC,GAAf,CAAmB,YAAnB,EAAgC,eAAhC;AACA6F,WAAKnC,MAAL,GAAc,QAAd;AACAmC,WAAKlC,IAAL,GAAY,KAAKmC,OAAjB;AACAD,WAAK7D,SAAL,GAAiB,aAAjB;;AAEA,UAAI+D,UAAUlG,SAASC,aAAT,CAAuB,KAAvB,CAAd;AACAiG,cAAQhG,SAAR,CAAkBC,GAAlB,CAAsB,gBAAtB;AACA+F,cAAQ9F,WAAR,CAAoB4F,IAApB;AACA,WAAKjG,mBAAL,CAAyBK,WAAzB,CAAqC8F,OAArC;;AAEA,UAAIC,WAAWnG,SAASC,aAAT,CAAuB,MAAvB,CAAf;AAAA,UACEmG,UAAUpG,SAASC,aAAT,CAAuB,KAAvB,CADZ;AAAA,UAEEoG,8EAEU,KAAKC,WAFf,wFAGgC,KAAKC,aAHrC,+BAFF;AAOAJ,eAASjG,SAAT,CAAmBC,GAAnB,CAAuB,gBAAvB;AACAgG,eAASnC,gBAAT,CAA0B,OAA1B,EAAmCwC,cAAnC;AACAJ,cAAQlG,SAAR,CAAkBC,GAAlB,CAAsB,iBAAtB;AACAiG,cAAQlG,SAAR,CAAkBC,GAAlB,CAAsB,MAAtB;AACAiG,cAAQjE,SAAR,GAAoBkE,WAApB;AACA,WAAKtG,mBAAL,CAAyBK,WAAzB,CAAqC+F,QAArC;AACA,WAAKpG,mBAAL,CAAyBK,WAAzB,CAAqCgG,OAArC;;AAEA,eAASI,cAAT,CAAwBvC,CAAxB,EAA2B;AACzBA,UAAEC,cAAF;AACAD,UAAEJ,MAAF,CAAS4C,WAAT,CAAqBvG,SAArB,CAA+BwG,MAA/B,CAAsC,UAAtC;AACD;AACF;;AAED;AACA;;;;;;+BAIWjE,I,EAAM;AACf,UAAIkE,SAAS,EAAb;AACA,UAAG,CAAClE,KAAKmE,GAAT,EAAc,OAAOD,MAAP,CAFC,CAEc;;AAE7B,UAAIE,cAAc,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,EAA+B,KAA/B,EAAqC,KAArC,EAA2C,KAA3C,EAAiD,KAAjD,EAAuD,KAAvD,EAA6D,KAA7D,EAAmE,KAAnE,CAAlB;AAAA,UACIC,YAAY,CAAC,KAAD,EAAO,KAAP,EAAa,KAAb,EAAmB,KAAnB,EAAyB,KAAzB,EAA+B,KAA/B,EAAqC,KAArC,CADhB;AAAA,UAEIC,WAAWtE,KAAKmE,GAAL,CAASI,KAAT,CAAe,GAAf,CAFf;AAAA,UAGIC,IAAIxJ,SAASsJ,SAAS,CAAT,CAAT,CAHR;AAAA,UAIIG,IAAIzJ,SAASsJ,SAAS,CAAT,CAAT,CAJR;;AAMA;AACA,UAAII,IAAI,IAAIpL,IAAJ,CAAS,CAAC0G,KAAKmE,GAAL,CAASI,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAV,EAAkC,CAACvE,KAAKmE,GAAL,CAASI,KAAT,CAAe,GAAf,EAAoB,CAApB,CAAF,GAA0B,CAA3D,EAA6D,CAACvE,KAAKmE,GAAL,CAASI,KAAT,CAAe,GAAf,EAAoB,CAApB,CAA9D,EAAsFI,MAAtF,EAAR;AACAT,eAASG,UAAUK,CAAV,IAAe,IAAf,GAAsBN,YAAYK,IAAI,CAAhB,CAAtB,GAA2C,GAA3C,GAAiDD,CAAjD,GAAqD,IAArD,GAA4DF,SAAS,CAAT,CAArE;;AAEA,UAAG,CAACtE,KAAKtG,IAAT,EAAe,OAAOwK,MAAP;;AAEf,UAAIU,YAAY5E,KAAKtG,IAAL,CAAU6K,KAAV,CAAgB,GAAhB,CAAhB;AAAA,UACEM,IAAI7J,SAAS4J,UAAU,CAAV,CAAT,CADN;AAAA,UAEEE,IAAIF,UAAU,CAAV,CAFN;AAAA,UAGEG,IAAI,IAHN;;AAKA,UAAIF,IAAI,EAAR,EAAYE,IAAI,IAAJ;AACZ,UAAIF,MAAM,CAAV,EAAa;AACXA,YAAI,EAAJ;AACD,OAFD,MAEO,IAAIA,IAAI,EAAR,EAAY;AACjBA,YAAIA,IAAI,EAAR;AACD;;AAED,aAAOX,SAAS,GAAT,GAAe,KAAKrD,sBAAL,CAA4BgE,CAA5B,CAAf,GAAgD,GAAhD,GAAsDC,CAAtD,GAA0D,GAA1D,GAAgEC,CAAvE;AACD;;;kCAEY;AACX,WAAKnH,UAAL,CAAgB8B,SAAhB,GAA4B,EAA5B;AACD;;;4BAEM;AACL,UAAIsF,kBAAkB,KAAK3H,UAAL,CAAgB4H,sBAAhB,CAAuC,aAAvC,CAAtB;AACA,aAAOD,gBAAgB1C,MAAvB,EAA+B;AAC7B,YAAIX,KAAKqD,gBAAgB,CAAhB,CAAT;AAAA,YACIE,SAASvD,GAAGwD,UADhB;AAEAD,eAAOE,WAAP,CAAmBzD,EAAnB;AACD;AACD,WAAK0D,WAAL;AACD;;;2BAEMC,gB,EAAkB;;AAEvB,UAAIC,WAAW,KAAKlM,MAAL,CAAYmM,WAAZ,EAAf;AACA,WAAK,IAAIvJ,IAAT,IAAiB,KAAK5C,MAAtB,EAA8B;AAC5B,YAAI,KAAKA,MAAL,CAAY6C,cAAZ,CAA2BD,IAA3B,CAAJ,EAAsCsJ,SAAStJ,IAAT,IAAiB,KAAK5C,MAAL,CAAY4C,IAAZ,CAAjB;AACvC;;AAED,WAAK5C,MAAL,GAAc,KAAKgE,UAAL,CAAgBQ,UAA9B;AACA,WAAKR,UAAL,CAAgBc,KAAhB,CAAsBC,MAAtB,GAAkC,KAAK/E,MAAL,CAAY+E,MAA9C;AACA,WAAKf,UAAL,CAAgBc,KAAhB,CAAsBE,KAAtB,GAAkC,KAAKhF,MAAL,CAAYgF,KAA9C;AACA,WAAKf,mBAAL,CAAyBa,KAAzB,CAA+BC,MAA/B,GAA2C,KAAK/E,MAAL,CAAY+E,MAAvD;AACA,WAAKd,mBAAL,CAAyBa,KAAzB,CAA+BE,KAA/B,GAA2C,KAAKhF,MAAL,CAAYgF,KAAvD;AACA,WAAKf,mBAAL,CAAyBa,KAAzB,CAA+BG,YAA/B,GAAiD,KAAKjF,MAAL,CAAYkF,YAA7D;AACA,WAAKjB,mBAAL,CAAyBa,KAAzB,CAA+BK,WAA/B,GAAgD,KAAKC,UAArD;;AAIA,UAAG,KAAKgH,YAAL,CAAkB,KAAKpM,MAAvB,EAA+BkM,QAA/B,EAAyC,KAAKG,gBAA9C,KAAmEJ,gBAAtE,EAAuF;AACrF,aAAKK,KAAL;;AAEA,YAAG,KAAKtM,MAAL,CAAYyE,KAAZ,KAAsB,IAAzB,EAA8B;AAC5B;AACA,eAAKE,WAAL,CAAkB,KAAKC,mBAAvB,EAA4C,KAAKC,QAAL,GAAgB,KAAK7E,MAAL,CAAYyE,KAA5B,GAAoC,MAAhF;AACD;;AAED,YAAG,KAAK1B,YAAL,CAAkB0B,KAAlB,KAA4B,kBAA/B,EAAmD;AACjD,cAAI8H,eAAe,OAAnB;AACA;AACA;AACA,eAAKtI,mBAAL,CAAyBa,KAAzB,CAA+BG,YAA/B,GAAiD,KAAKjF,MAAL,CAAYkF,YAA7D;AACA,eAAKjB,mBAAL,CAAyBa,KAAzB,CAA+BK,WAA/B,GAAgD,KAAKC,UAArD;;AAEA;AACA,eAAKpB,UAAL,CAAgBc,KAAhB,CAAsBE,KAAtB;AACA,eAAKhB,UAAL,CAAgBc,KAAhB,CAAsBC,MAAtB,GAA+BwH,YAA/B;AACA,eAAKvI,UAAL,CAAgBc,KAAhB,CAAsB0H,OAAtB;AACA,eAAKvI,mBAAL,CAAyBa,KAAzB,CAA+BE,KAA/B;AACA,eAAKf,mBAAL,CAAyBa,KAAzB,CAA+BC,MAA/B,GAAwCwH,YAAxC;AACA,eAAKxJ,YAAL,CAAkBiC,KAAlB;AACD;;AAED;;;;AAIA,YAAG,KAAKS,MAAL,IAAe,KAAKnC,OAAvB,EAA+B;AAC7B,eAAKqB,WAAL,CAAkB,KAAKe,oBAAvB,EAA6C,KAAKD,MAAlD,EAA0D,KAAKE,aAA/D;AACD,SAFD,MAEK;AACH;AACA,eAAKC,WAAL,CAAiB,sBAAjB,EAAyC,IAAzC,EAA+C,QAA/C;AACA,eAAKI,cAAL,CAAoByG,MAApB,CAA2B,IAA3B;AACD;AACF,OAnCD,MAmCK;AACH,YAAIC,SAAS,KAAK1I,UAAL,CAAgB4H,sBAAhB,CAAuC,eAAvC,CAAb;AACA,aAAI,IAAIhI,CAAR,IAAa8I,MAAb,EAAoB;AAClB,cAAGA,OAAO7J,cAAP,CAAsBe,CAAtB,KAA4B8I,OAAO9I,CAAP,EAAUkB,KAAV,KAAoB6H,SAAnD,EAA6D;AAC3DD,mBAAO9I,CAAP,EAAUkB,KAAV,CAAgBE,KAAhB,GAA2B,KAAKhF,MAAL,CAAYgF,KAAZ,GAAoB,KAAKI,UAAL,GAAkB,CAAjE;AACAsH,mBAAO9I,CAAP,EAAUkB,KAAV,CAAgBC,MAAhB,GAA4B,KAAK/E,MAAL,CAAY+E,MAAZ,GAAqB,KAAKK,UAAL,GAAkB,CAAnE;AACD;AACF;AACF;AACD;AACD;;;iCAEYwH,Q,EAAUV,Q,EAAwB;AAAA,UAAdW,QAAc,uEAAH,EAAG;;AAC7C,aAAOC,OAAOC,IAAP,CAAYH,QAAZ,EAAsBI,GAAtB,CAA0B,UAASC,GAAT,EAAa;AAC5C,YAAGJ,SAAS1D,OAAT,CAAiB8D,GAAjB,IAAwB,CAAC,CAA5B,EAA+B,OAAO,IAAP;AAC/B;AACA,eAAOL,SAASK,GAAT,MAAkBf,SAASe,GAAT,CAAzB;AACD,OAJM,EAIJ9D,OAJI,CAII,KAJJ,IAIa,CAAC,CAJrB;AAKD;;;+BAEU+D,Y,EAAa;AACpB,UAAIlN,SAAS,EAAb;AACA8M,aAAOC,IAAP,CAAYG,YAAZ,EAA0BF,GAA1B,CAA8B,UAASG,KAAT,EAAe;AAC3C,YAAI,OAAOD,aAAaC,KAAb,EAAoBC,IAA3B,KAAqC,WAArC,IAAoDF,aAAaC,KAAb,EAAoBC,IAApB,CAAyBjE,OAAzB,CAAiC,IAAjC,MAA2C,CAAC,CAApG,EAAsG;AACpGnJ,iBAAQkN,aAAaC,KAAb,EAAoBC,IAApB,CAAyBC,OAAzB,CAAiC,KAAjC,EAAwC,EAAxC,EAA4CA,OAA5C,CAAoD,IAApD,EAA0D,EAA1D,CAAR,IAA0EH,aAAaC,KAAb,EAAoBA,KAA9F;AACD;AACF,OAJD;AAKA,aAAOnN,MAAP;AACH;;;0CAEoB;AACnB,UAAI,QAAQ,KAAKsN,UAAL,IAAmBC,eAAeC,IAA9C,EAAqD;AACnD,YAAG,KAAKC,MAAL,IAAe,GAAlB,EAAsB;AACpB,cAAI3I,QAAQZ,SAASC,aAAT,CAAuB,OAAvB,CAAZ;AACAW,gBAAMmD,YAAN,CAAmB,MAAnB,EAA0B,UAA1B;AACAnD,gBAAMmD,YAAN,CAAmB,IAAnB,oBAAwC,KAAKyF,MAAL,CAAY1N,MAAZ,CAAmByE,KAA3D;AACAK,gBAAM6I,WAAN,GAAoB,KAAKC,YAAzB;AACA1J,mBAASqF,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,EAAyCjF,WAAzC,CAAqDQ,KAArD;AACD,SAND,MAOK;AACH+I,kBAAQC,IAAR,CAAa,qBAAb;AACD;AACF;AACF;;;qCAEgBL,M,EAAOM,Q,EAAS;AAC/B,WAAKrH,KAAL,GAAa,KAAb;AACA,WAAKd,WAAL,CAAiB,wBAAjB,EAA2C,IAA3C,EAAiD,IAAjD;AACAiI,cAAQG,GAAR,kCAA2CP,MAA3C;AACA,UAAG,CAACM,QAAJ,EAAc;AACZ,aAAKE,eAAL;AACD;AACF;;;2CAEqB;AACpB,UAAIP,SAAS,KAAKA,MAAlB;AACAA,aAAO1B,WAAP,GAFoB,CAEE;AACtB,UAAI,QAAQ,KAAKsB,UAAL,IAAmBC,eAAeC,IAA9C,EAAqD;AACnD,YAAG,KAAKC,MAAL,IAAe,GAAlB,EAAsB;AACpBC,iBAAOhH,KAAP,GAAewH,KAAKnN,KAAL,CAAW,KAAK6M,YAAhB,CAAf;AACA,cAAGF,OAAOhH,KAAV,EAAgB;AACdgH,mBAAOS,YAAP,CAAoBT,OAAOhH,KAA3B;AACAgH,mBAAOU,WAAP;AACD;AACF,SAND,MAOK,IAAG,KAAKX,MAAL,IAAe,GAAlB,EAAuB;AAC1BC,iBAAOW,gBAAP,CAAwBC,IAAxB,CAA6BZ,MAA7B,EAAqC,KAAKD,MAA1C;AACD,SAFI,MAGA;AACHC,iBAAOW,gBAAP,CAAwBC,IAAxB,CAA6BZ,MAA7B,EAAqC,KAAKD,MAA1C;AACD;AACD;AACA,YAAIc,aAAJ;AAAA,YAAUC,cAAV;AACAd,eAAO1H,cAAP,CAAsByG,MAAtB,CAA6B,CAAC8B,OAAOb,OAAOhH,KAAf,KAAyB,IAAzB,GAAgC,CAAC8H,QAAQD,KAAK5H,IAAd,KAAuB,IAAvB,GAA8B6H,MAAM5H,QAAN,IAAkB4H,MAAM1D,GAAtD,GAA4D,KAAK,CAAjG,GAAqG,KAAK,CAAvI;AACD;AACD4C,aAAOe,YAAP;AACD;;;iCAEY/H,K,EAAOoF,U,EAAW;AAC7BA,mBAAaA,cAAc,KAAKvH,UAAhC;AACA,UAAImK,aAAa,KAAKC,aAAL,CAAmBjI,KAAnB,CAAjB;AACAoF,iBAAWxH,WAAX,CAAuBoK,UAAvB;AACD;;;qCAEgBE,M,EAAO;AACtB,UAAI5J,QAAQ,KAAKhF,MAAL,CAAYgF,KAAxB;AAAA,UACED,SAAS,KAAK/E,MAAL,CAAY+E,MADvB;;AAGA6J,aAAOC,IAAP,CAAY,UAASnD,CAAT,EAAWoD,CAAX,EAAc;AACxB,YAAIpD,EAAE1G,KAAF,GAAU8J,EAAE9J,KAAhB,EACE,OAAO,CAAC,CAAR,CADF,KAEK,IAAI0G,EAAE1G,KAAF,GAAU8J,EAAE9J,KAAhB,EACH,OAAO,CAAP,CADG,KAGH,OAAO,CAAP;AACH,OAPD;;AASA,UAAI+J,QAAQ,EAAZ;AACAH,aAAOI,OAAP,CAAe,UAASC,OAAT,EAAiB;AAC9B,YAAGA,QAAQjK,KAAR,IAAiBA,KAAjB,IAA0BiK,QAAQlK,MAAR,IAAkBA,MAA5C,IAAsD,CAACgK,KAA1D,EAAgE;AAC9DA,kBAAQE,QAAQ5G,GAAhB;AACD;AACF,OAJD;AAKA,UAAG0G,UAAU,EAAb,EAAiB;AACfA,gBAAQH,OAAOA,OAAO3F,MAAP,GAAc,CAArB,EAAwBZ,GAAhC;AACD;AACD,aAAO0G,KAAP;AACD;;;+BAEUG,Q,EAAS;AAClB,UAAG,CAACA,SAAS7L,EAAb,EAAgB;AACd,eAAO,KAAP;AACD;;AAED,UAAI8L,eAAe,EAAnB;;AAEAA,mBAAa9L,EAAb,GAAkB6L,SAAS7L,EAA3B;AACA8L,mBAAa9G,GAAb,GAAmB6G,SAAS7G,GAA5B;AACA8G,mBAAa/B,IAAb,GAAoB8B,SAAS9B,IAA7B;;AAEA+B,mBAAaxI,IAAb,GAAoB;AAClBmE,aAAKoE,SAASE,KAAT,CAAeC,KAAf,CAAqBC,SADR;AAElBjP,cAAM6O,SAASE,KAAT,CAAeC,KAAf,CAAqBE,SAFT;AAGlB3I,kBAAUsI,SAASE,KAAT,CAAeC,KAAf,CAAqBzI;AAHb,OAApB;;AAMA,UAAGsI,SAASE,KAAT,CAAeI,GAAlB,EAAsB;AACnBN,iBAASE,KAAT,CAAeI,GAAf,CAAmBF,SAApB,GAAiCH,aAAaxI,IAAb,CAAkB8I,MAAlB,GAA2BP,SAASE,KAAT,CAAeI,GAAf,CAAmBF,SAA/E,GAA2F,EAA3F;AACCJ,iBAASE,KAAT,CAAeI,GAAf,CAAmBD,SAApB,GAAiCJ,aAAaxI,IAAb,CAAkB+I,OAAlB,GAA4BR,SAASE,KAAT,CAAeI,GAAf,CAAmBD,SAAhF,GAA4F,EAA5F;AACCL,iBAASE,KAAT,CAAeI,GAAf,CAAmB5I,QAApB,GAAgCuI,aAAaxI,IAAb,CAAkBS,WAAlB,GAAgC8H,SAASE,KAAT,CAAeI,GAAf,CAAmB5I,QAAnF,GAA8F,EAA9F;AACD;;AAED,UAAGsI,SAASrM,cAAT,CAAwB,WAAxB,KAAwCqM,SAASS,SAAT,CAAmB9M,cAAnB,CAAkC,QAAlC,CAA3C,EAAuF;AACrF,YAAI+M,QAAQV,SAASS,SAAT,CAAmBE,MAAnB,CAA0B,CAA1B,CAAZ;AACA,YAAGD,KAAH,EAAS;AACP,cAAGA,MAAME,OAAT,EACEX,aAAaW,OAAb,GAAuBF,MAAME,OAA7B;;AAEF,cAAGF,MAAMxC,IAAT,EAAc;AACZ,gBAAG,CAAC+B,aAAaW,OAAjB,EAA0BX,aAAaW,OAAb,GAAuB,EAAvB;AAC1BX,yBAAaW,OAAb,CAAqB1C,IAArB,GAA4BwC,MAAMxC,IAAlC;AACD;AACF;AACF;;AAED+B,mBAAaY,GAAb,GAAmB,KAAKC,gBAAL,CAAsBd,SAASN,MAA/B,CAAnB;AACA,aAAOO,YAAP;AACD;;;sCAEgB;AACflP,WAAKgQ,SAAL,CAAeC,OAAf,GAAyB,UAAS7O,IAAT,EAAe;AACtC,aAAK8O,OAAL,CAAa,KAAKC,OAAL,KAAiBzO,SAASN,IAAT,CAA9B;AACA,eAAO,IAAP;AACD,OAHD;AAIA,UAAIgP,WAAS,OAAb;AAAA,UACEhI,6DADF;AAAA,UAEEiI,UAAUxD,OAAOyD,MAAP,CAAc,EAAd,EAAiB,KAAK5K,aAAtB,CAFZ;AAAA,UAGEwF,IAAI,IAAIlL,IAAJ,CAAS,CAAT,CAHN;AAAA,UAIEuQ,8BAJF;;AAMArF,QAAEsF,aAAF,CAAgBxP,KAAKyP,KAAL,CAAW,IAAIzQ,IAAJ,GAAWiQ,OAAX,CAAmB,EAAnB,EAAuBS,OAAvB,EAAX,IAA6C,IAA7D;AACAH,8BAAwBrF,EAAEyF,MAAF,GAAWC,KAAX,CAAiB,CAAjB,EAAmB,EAAnB,IAAuB,KAA/C;AACA,UAAG1F,EAAEyF,MAAF,GAAW3H,MAAX,IAAqB,EAAxB,EAA4BuH,wBAAwBrF,EAAEyF,MAAF,EAAxB;AAC5BN,cAAQQ,aAAR,GAAwBN,qBAAxB;AACAF,cAAQS,OAAR,GAAkBV,QAAlB;;AAEA,WAAK1L,WAAL,CAAiB,KAAKqM,sBAAtB,EAA8C3I,GAA9C,EAAmDiI,OAAnD;AACD;;;6CAEuB;AACtB,eAASW,UAAT,CAAoBvE,MAApB,EAA2B;AACzB,YAAIrJ,KAAK,EAAT;AAAA,YACI6N,eAAe,IAAIjR,IAAJ,GAAWiQ,OAAX,CAAmB,EAAnB,CADnB;;AAGA,aAAI,IAAIiB,KAAG,CAAX,EAAaA,KAAGzE,OAAOzD,MAAvB,EAA8BkI,IAA9B,EAAmC;AACjC,cAAKlQ,KAAKyP,KAAL,CAAW,IAAIzQ,IAAJ,CAASyM,OAAOyE,EAAP,EAAW/B,KAAX,CAAiBC,KAAjB,CAAuBzI,QAAhC,EAA0C+J,OAA1C,KAAoD,IAA/D,KAAwE1P,KAAKyP,KAAL,CAAW,IAAIzQ,IAAJ,CAASiR,YAAT,EAAuBP,OAAvB,KAAiC,IAA5C,CAA7E,EAAgI;AAC9HtN,iBAAKqJ,OAAOyE,EAAP,EAAW9N,EAAhB;AACA;AACD;AACF;AACD,eAAOA,EAAP;AACD;AACD,eAAS+N,UAAT,GAAqB;AAAA;;AAClB,eAAO;AAAA,iBAAK,MAAKzM,WAAL,CAAkB,MAAKe,oBAAvB,EAA6C,MAAKD,MAAlD,EAA0D,MAAKE,aAA/D,CAAL;AAAA,SAAP;AACF;AACD,UAAI+H,SAAS,KAAKA,MAAlB;AACA,UAAIK,WAAW,KAAf;AACAL,aAAO1B,WAAP,GAlBsB,CAkBA;;AAEtB,UAAI,QAAQ,KAAKsB,UAAL,IAAmBC,eAAeC,IAA9C,EAAqD;AACnD,YAAG,KAAKC,MAAL,IAAe,GAAlB,EAAsB;AACpB,cAAI4D,aAAanD,KAAKnN,KAAL,CAAW,KAAK6M,YAAhB,CAAjB;AACA,cAAGyD,UAAH,EAAc;AACZ,gBAAI3E,SAAS2E,WAAW,WAAX,EAAwB,QAAxB,CAAb;AAAA,gBACIC,QAAQL,WAAWvE,MAAX,CADZ;AAEAgB,mBAAOpK,OAAP,GAAiBgO,KAAjB;AACA,gBAAGpN,SAASQ,cAAT,CAAwB,MAAxB,CAAH,EAAmC;AACjCR,uBAASQ,cAAT,CAAwB,MAAxB,EAAgCyI,KAAhC,GAAwCO,OAAOpK,OAA/C;AACD;AACD8N,uBAAW9C,IAAX,CAAgBZ,MAAhB,EAAuB4D,KAAvB;AACD;AACF,SAXD,MAYK,IAAG,KAAK7D,MAAL,IAAe,GAAlB,EAAuB;AAC1BM,qBAAW,IAAX;AACAL,iBAAOW,gBAAP,CAAwBC,IAAxB,CAA6BZ,MAA7B,EAAqC,KAAKD,MAA1C,EAAiDM,QAAjD;AACD,SAHI,MAIA;AACHF,kBAAQG,GAAR,CAAY,YAAZ,EAAyB,IAAzB;AACAD,qBAAW,IAAX;AACAL,iBAAOW,gBAAP,CAAwBC,IAAxB,CAA6BZ,MAA7B,EAAqC,KAAKD,MAA1C,EAAiDM,QAAjD;AACD;AACD;AACA,YAAIQ,aAAJ;AAAA,YAAUC,cAAV;AACAd,eAAO1H,cAAP,CAAsByG,MAAtB,CAA6B,CAAC8B,OAAOb,OAAOhH,KAAf,KAAyB,IAAzB,GAAgC,CAAC8H,QAAQD,KAAK5H,IAAd,KAAuB,IAAvB,GAA8B6H,MAAM5H,QAAN,IAAkB4H,MAAM1D,GAAtD,GAA4D,KAAK,CAAjG,GAAqG,KAAK,CAAvI;AACD;AACD4C,aAAOe,YAAP;AAED;;;gCAEW8C,O,EAAiD;AAAA,UAAxClJ,GAAwC,uEAApC,KAAK5C,MAA+B;AAAA,UAAvB3C,KAAuB,uEAAjB,EAAiB;AAAA,UAAb0O,MAAa,uEAAN,KAAM;;AAC3D1O,cAAQgK,OAAOC,IAAP,CAAYjK,KAAZ,EAAmBkK,GAAnB,CAAuB,UAASC,GAAT,EAAa;AAC1C,eAAUA,GAAV,SAAiBnK,MAAMmK,GAAN,CAAjB;AACD,OAFO,EAELwE,IAFK,CAEA,GAFA,CAAR;;AAIApJ,YAAM,CAACA,GAAD,EAAKvF,KAAL,EAAY2O,IAAZ,CAAiB,GAAjB,CAAN;;AAEA,WAAKC,OAAL,GAAenO,OAAOgK,cAAP,GAAwB,IAAIA,cAAJ,EAAxB,GAA+C,IAAIoE,aAAJ,CAAkB,mBAAlB,CAA9D;AACA,UAAGH,UAAU,MAAb,EAAqB;AACnB,aAAKE,OAAL,CAAaE,gBAAb,CAA8B,cAA9B,EAA6C,mCAA7C;AACD;AACD,WAAKF,OAAL,CAAahE,MAAb,GAAsB,IAAtB;AACA,WAAKgE,OAAL,CAAaG,kBAAb,GAAkCN,OAAlC;AACA,WAAKG,OAAL,CAAaI,IAAb,CAAkBN,MAAlB,EAA0BnJ,GAA1B,EAA+B,IAA/B;AACA,WAAKqJ,OAAL,CAAaK,IAAb;AACD;;;sCAGiBzJ,E,EAAID,G,EAAK2J,O,EAAQ;AACjC,UAAG1J,MAAMD,GAAT,EAAa;AACXC,WAAGL,YAAH,CAAgB,UAAhB,EAA4BI,GAA5B;AACAC,WAAGlE,SAAH,CAAaC,GAAb,CAAiB,sBAAjB;AACAiE,WAAGJ,gBAAH,CAAoB,OAApB,EAA6B,YAAU;AACrC,cAAIG,MAAM,KAAK4J,YAAL,CAAkB,UAAlB,CAAV;AACA,cAAG5J,GAAH,EAAO;AACL,gBAAI6J,MAAM3O,OAAOuO,IAAP,CAAYzJ,GAAZ,EAAkB2J,UAAU,QAAV,GAAqB,OAAvC,CAAV;AACAE,gBAAIC,KAAJ;AACD;AACF,SAND;AAOD;AACD,aAAO7J,EAAP;AACD;;;kCAGa8J,U,EAAW;AACvB,UAAIC,aAAanO,SAASC,aAAT,CAAuB,KAAvB,CAAjB;AACAkO,iBAAWjO,SAAX,CAAqBC,GAArB,CAAyB,sBAAzB;;AAEA,UAAIqC,QAAQxC,SAASC,aAAT,CAAuB,IAAvB,CAAZ;AACAuC,YAAMtC,SAAN,CAAgBC,GAAhB,CAAoB,eAApB;AACAqC,YAAM5B,KAAN,CAAYC,MAAZ,GAAwB,KAAK/E,MAAL,CAAY+E,MAAZ,GAAqB,KAAKK,UAAL,GAAkB,CAA/D;AACAsB,YAAM5B,KAAN,CAAYE,KAAZ,GAAwB,KAAKhF,MAAL,CAAYgF,KAAZ,GAAoB,KAAKI,UAAL,GAAkB,CAA9D;;AAEA,UAAIkN,QAAQpO,SAASC,aAAT,CAAuB,MAAvB,CAAZ;AACAmO,YAAMlO,SAAN,CAAgBC,GAAhB,CAAoB,UAApB;AACAiO,YAAMxN,KAAN,CAAYyN,eAAZ,cAAsCH,WAAWrC,GAAjD;AACArJ,YAAMpC,WAAN,CAAkBgO,KAAlB;;AAEA,UAAIE,cAActO,SAAS4D,cAAT,CAAwBsK,WAAWhF,IAAnC,CAAlB;AAAA,UACAA,OAAOlJ,SAASC,aAAT,CAAuB,MAAvB,CADP;AAEAiJ,WAAKhJ,SAAL,CAAeC,GAAf,CAAmB,YAAnB;AACA+I,WAAK9I,WAAL,CAAiBkO,WAAjB;AACA,WAAKC,iBAAL,CAAuBrF,IAAvB,EAA6BgF,WAAW/J,GAAxC,EAA6C,IAA7C;AACA+E,WAAKnF,YAAL,CAAkB,SAAlB,+DAAmF,KAAKjI,MAAL,CAAYyE,KAA/F,eAA8G,KAAKzE,MAAL,CAAYgF,KAA1H,gBAA0I,KAAKhF,MAAL,CAAY+E,MAAtJ,4CAA+LqN,WAAW/J,GAA1M;AACAgK,iBAAW/N,WAAX,CAAuB8I,IAAvB;;AAGA,UAAIsF,kBAAkBxO,SAAS4D,cAAT,CAAwB,KAAK6K,UAAL,CAAgBP,WAAWzL,IAA3B,CAAxB,CAAtB;AAAA,UACAC,WAAW1C,SAASC,aAAT,CAAuB,MAAvB,CADX;AAEAyC,eAASxC,SAAT,CAAmBC,GAAnB,CAAuB,YAAvB;AACAuC,eAAStC,WAAT,CAAqBoO,eAArB;;AAEA,UAAIE,aAAa1O,SAASC,aAAT,CAAuB,MAAvB,CAAjB;AACAyO,iBAAWxO,SAAX,CAAqBC,GAArB,CAAyB,mBAAzB;AACAuO,iBAAWtO,WAAX,CAAuBsC,QAAvB;AACAyL,iBAAW/N,WAAX,CAAuBsO,UAAvB;;AAEA,UAAGR,WAAWvP,cAAX,CAA0B,SAA1B,CAAH,EAAwC;AACtC,YAAIgQ,iBAAiB3O,SAASC,aAAT,CAAuB,MAAvB,CAArB;AACA0O,uBAAezO,SAAf,CAAyBC,GAAzB,CAA6B,iBAA7B;;AAEA,YAAI+N,WAAWtC,OAAX,CAAmBjN,cAAnB,CAAkC,MAAlC,CAAJ,EAA+C;AAC7C,cAAIiQ,kBAAkB5O,SAAS4D,cAAT,CAAwBsK,WAAWtC,OAAX,CAAmB1C,IAA3C,CAAtB;AAAA,cACI2F,cAAe7O,SAASC,aAAT,CAAuB,MAAvB,CADnB;AAEA4O,sBAAY3O,SAAZ,CAAsBC,GAAtB,CAA0B,eAA1B;AACA0O,sBAAY3O,SAAZ,CAAsBC,GAAtB,CAA0B,oBAA1B;AACA0O,sBAAYzO,WAAZ,CAAwBwO,eAAxB;AACAD,yBAAevO,WAAf,CAA2ByO,WAA3B;AACD;;AAED,YAAIX,WAAWtC,OAAX,CAAmBjN,cAAnB,CAAkC,OAAlC,CAAJ,EAAgD;AAC9C,cAAImQ,iBAAiB9O,SAAS4D,cAAT,CAAwBsK,WAAWtC,OAAX,CAAmBmD,KAA3C,CAArB;AAAA,cACAC,aAAchP,SAASC,aAAT,CAAuB,MAAvB,CADd;AAEA+O,qBAAW9O,SAAX,CAAqBC,GAArB,CAAyB,eAAzB;AACA6O,qBAAW5O,WAAX,CAAuB0O,cAAvB;AACAH,yBAAevO,WAAf,CAA2B4O,UAA3B;AACD;;AAED,YAAId,WAAWtC,OAAX,CAAmBjN,cAAnB,CAAkC,OAAlC,CAAJ,EAAgD;AAC9C,cAAIsQ,iBAAiBjP,SAAS4D,cAAT,CAAwBsK,WAAWtC,OAAX,CAAmBsD,KAA3C,CAArB;AAAA,cACAC,aAAcnP,SAASC,aAAT,CAAuB,MAAvB,CADd;AAEAkP,qBAAWjP,SAAX,CAAqBC,GAArB,CAAyB,eAAzB;AACAgP,qBAAW/O,WAAX,CAAuB6O,cAAvB;AACAN,yBAAevO,WAAf,CAA2B+O,UAA3B;AACD;;AAEDhB,mBAAW/N,WAAX,CAAuBuO,cAAvB;AACD;;AAED,UAAGT,WAAWvP,cAAX,CAA0B,YAA1B,CAAH,EAA4C;AAC1C,YAAIyQ,oBAAoBpP,SAASC,aAAT,CAAuB,MAAvB,CAAxB;AACAmP,0BAAkBlP,SAAlB,CAA4BC,GAA5B,CAAgC,kBAAhC;;AAEA+N,mBAAWmB,UAAX,CAAsBvE,OAAtB,CAA8B,UAAUC,OAAV,EAAmB;AAC/C,cAAIuE,eAAetP,SAAS4D,cAAT,CAAwBmH,OAAxB,CAAnB;AAAA,cACEwE,WAAWvP,SAASC,aAAT,CAAuB,MAAvB,CADb;AAEAsP,mBAASrP,SAAT,CAAmBC,GAAnB,CAAuB,gBAAvB;AACAoP,mBAASnP,WAAT,CAAqBkP,YAArB;AACAF,4BAAkBhP,WAAlB,CAA8BmP,QAA9B;AACD,SAND;AAOApB,mBAAW/N,WAAX,CAAuBgP,iBAAvB;AACD;;AAED5M,YAAMpC,WAAN,CAAkB+N,UAAlB;;AAEA,aAAO3L,KAAP;AACD;;AAED;;;;;;8BAIU1G,M,EAAO;AACf,aAAOkO,KAAKnN,KAAL,CAAWwC,OAAOmQ,IAAP,CAAY1T,MAAZ,CAAX,CAAP;AACD;;;8BAESA,M,EAAO;AACf,aAAOuD,OAAOoQ,IAAP,CAAY3T,MAAZ,CAAP;AACD;;;;;;AAIH,IAAI4T,mBAAmB,EAAvB;AACA,CAAC,YAAY;AACX,MAAIC,mBAAmB3P,SAAS4P,gBAAT,CAA0B,yBAA1B,CAAvB;AACA,OAAK,IAAIlQ,IAAI,CAAb,EAAgBA,IAAIiQ,iBAAiB5K,MAArC,EAA6C,EAAErF,CAA/C,EAAkD;AAChDgQ,qBAAiBG,IAAjB,CAAsB,IAAIpR,2BAAJ,CAAgCkR,iBAAiBjQ,CAAjB,CAAhC,CAAtB;AACD;AAEF,CAND;;AAQA,CAAC,UAASA,CAAT,EAAWoQ,CAAX,EAAaC,CAAb,EAAeC,CAAf,EAAiBlL,CAAjB,EAAmB0C,CAAnB,EAAqBD,CAArB,EAAuB;AAAC7H,IAAE,uBAAF,IAA2BoF,CAA3B,CAA6BpF,EAAEoF,CAAF,IAAKpF,EAAEoF,CAAF,KAAM,YAAU;AACrE,KAACpF,EAAEoF,CAAF,EAAKmL,CAAL,GAAOvQ,EAAEoF,CAAF,EAAKmL,CAAL,IAAQ,EAAhB,EAAoBJ,IAApB,CAAyBK,SAAzB;AAAoC,GADY,EACXxQ,EAAEoF,CAAF,EAAKqL,CAAL,GAAO,IAAE,IAAIpU,IAAJ,EADE,CACSyL,IAAEsI,EAAE7P,aAAF,CAAgB8P,CAAhB,CAAF,EAC3DxI,IAAEuI,EAAEzK,oBAAF,CAAuB0K,CAAvB,EAA0B,CAA1B,CADyD,CAC5BvI,EAAE4I,KAAF,GAAQ,CAAR,CAAU5I,EAAE6I,GAAF,GAAML,CAAN,CAAQzI,EAAEK,UAAF,CAAa0I,YAAb,CAA0B9I,CAA1B,EAA4BD,CAA5B;AACpD,CAHD,EAGGlI,MAHH,EAGUW,QAHV,EAGmB,QAHnB,EAG4B,+CAH5B,EAG4E,IAH5E;;AAKAuQ,GAAG,QAAH,EAAa,eAAb,EAA8B,MAA9B;AACAA,GAAG,MAAH,EAAW,UAAX;;AAGA,IAAG,OAAOC,MAAP,KAAkB,WAArB,EAAkC;AAC9BA,SAAOC,OAAP,GAAiB,EAAE7U,8BAAF,EAAmB6C,wDAAnB,EAAjB;AACH","file":"main-widget.js","sourcesContent":["class CountdownClock {\r\n  set endTime(endTime) { this.config.endTime = endTime; }\r\n  get endTime(){ return this.config.endTime || new Date();}\r\n\r\n  set interval(interval) { return this.config.interval = interval; }\r\n  get interval(){ return this.config.interval || 1000;}\r\n\r\n  set onChange(fn) { return this.config.onChange = fn; }\r\n  get onChange(){ return this.config.onChange || ((time) => {})}\r\n\r\n  constructor(config = {}) {\r\n    this.config = config;\r\n    this.updateClock();\r\n    if(this.config.endTime) this.initInterval();\r\n  }\r\n\r\n  initInterval(){\r\n    this.timeinterval = setInterval(this.updateClock.bind(this), this.interval);\r\n  }\r\n\r\n  update(endTime){\r\n    clearInterval(this.timeinterval);\r\n    this.endTime = endTime;\r\n    this.updateClock();\r\n    if(endTime) this.initInterval();\r\n  }\r\n\r\n  updateClock() {\r\n    let timeRemaining = this.getTimeRemaining();\r\n    this.onChange(timeRemaining);\r\n    if (timeRemaining.total <= 0) clearInterval(this.timeinterval);\r\n  }\r\n\r\n  /*\r\n  //Covert datetime by GMT offset\r\n  //If toUTC is true then return UTC time other wise return local time\r\n  convertLocalDateToUTCDate(date, toUTC) {\r\n    date = new Date(date);\r\n    //Local time converted to UTC\r\n    var localOffset = date.getTimezoneOffset() * 60000;\r\n    var localTime = date.getTime();\r\n    (toUTC)\r\n      ? date = localTime + localOffset\r\n      : date = localTime - localOffset;\r\n    date = new Date(date);\r\n    return date;\r\n  }\r\n  */\r\n\r\n  getTimeRemaining() {\r\n    let total = Date.parse(this.endTime) - Date.parse(new Date());\r\n    if(total <= 0) total = 0;\r\n    let seconds = Math.floor((total / 1000) % 60),\r\n      minutes = Math.floor((total / 1000 / 60) % 60),\r\n      hours = Math.floor((total / 3600000 /* (1000 * 60 * 60) */) % 24),\r\n      days = Math.floor(total / 86400000 /* (1000 * 60 * 60 * 24) */),\r\n      monthLeft = 0;\r\n      //years = 0;\r\n\r\n    let daysInMonth = function(year,month){\r\n      var D=new Date(year, month-1, 1, 12);\r\n      return parseInt((-Date.parse(D)+D.setMonth(D.getMonth()+1)+36e5)/864e5);\r\n    };\r\n\r\n    let today = new Date(),\r\n        curr_day = today.getUTCDate(),\r\n        curr_month = today.getUTCMonth(),\r\n        curr_year = today.getUTCFullYear(),\r\n        curr_days_in_month = daysInMonth(curr_year, curr_month);\r\n\r\n    if(days > curr_days_in_month){\r\n      let servYear = new Date(this.endTime).getUTCFullYear(),\r\n          servMonth = new Date(this.endTime).getUTCMonth(),\r\n          servDay = new Date(this.endTime).getUTCDate(),\r\n          serv_days_in_month = daysInMonth(servYear, servMonth);\r\n\r\n      monthLeft = Math.floor( days/daysInMonth(servYear,servMonth) );\r\n\r\n      days = Math.abs(servDay - curr_day);\r\n      \r\n      /*if(monthLeft > 99){\r\n        years = servYear - curr_year;\r\n        monthLeft = monthLeft-1 - years*12;\r\n        //console.log( 'monthLeft ',monthLeft );\r\n      }*/\r\n    }\r\n\r\n    return {\r\n      total,\r\n      //years,\r\n      monthLeft,\r\n      days,\r\n      hours,\r\n      minutes,\r\n      seconds\r\n    };\r\n  }\r\n}\r\n\r\nclass TicketmasterCountdownWidget {\r\n\r\n  set config(attrs) { this.widgetConfig = this.loadConfig(attrs); }\r\n  get config() { return this.widgetConfig; }\r\n\r\n  set event(responce){ this.eventResponce = this.parseEvent(responce);}\r\n  get event(){ return this.eventResponce;}\r\n\r\n  get borderSize(){ return this.config.border || 0;}\r\n\r\n  get eventUrl(){ return \"http://www.ticketmaster.com/event/\"; }\r\n\r\n  set eventId(id){ this.config.id = id;}\r\n  get eventId(){ return this.config.id;}\r\n\r\n  get apiUrl(){ return this.config.id ? `https://app.ticketmaster.com/discovery/v2/events/${this.config.id}.json` : `https://app.ticketmaster.com/discovery/v2/events/${this.eventId}.json`; }\r\n\r\n  get themeUrl() {\r\n    return (window.location.host === 'developer.ticketmaster.com')\r\n      ? `https://developer.ticketmaster.com/products-and-docs/widgets/countdown/1.0.0/theme/`\r\n      : `https://ticketmaster-api-staging.github.io/products-and-docs/widgets/countdown/1.0.0/theme/`;\r\n  }\r\n\r\n  get portalUrl(){\r\n    return (window.location.host === 'developer.ticketmaster.com')\r\n      ? `https://developer.ticketmaster.com/`\r\n      : `https://ticketmaster-api-staging.github.io/`;\r\n  }\r\n\r\n  get logoUrl() { return \"https://www.ticketmaster.com/\"; }\r\n\r\n  get legalNoticeUrl() { return \"http://developer.ticketmaster.com/support/terms-of-use/\"; }\r\n\r\n  get widgetVersion() { return \"1.0.0\"; }\r\n\r\n  get questionUrl() { return \"http://developer.ticketmaster.com/support/faq/\"; }\r\n\r\n  get updateExceptions() { return [\"width\", \"height\", \"border\", \"borderradius\", \"layout\", \"propotion\", \"seconds\"]}\r\n\r\n  get hideMessageDelay(){ return 5000; }\r\n\r\n  get tmWidgetWhiteList(){ return [\"2200504BAD4C848F\", \"00005044BDC83AE6\", \"1B005068DB60687F\", \"1B004F4DBEE45E47\", \"3A004F4ED7829D5E\", \"3A004F4ED1FC9B63\", \"1B004F4FF83289C5\", \"1B004F4FC0276888\", \"0E004F4F3B7DC543\", \"1D004F4F09C61861\", \"1600505AC9A972A1\", \"22004F4FD82795C6\", \"01005057AFF54574\", \"01005056FAD8793A\", \"3A004F4FB2453240\", \"22004F50D2149AC6\", \"01005059AD49507A\", \"01005062B4236D5D\"]; }\r\n\r\n  //get eventIdDefault(){ return '1Ad0ZfdGkMoCQHJ';}\r\n\r\n  isConfigAttrExistAndNotEmpty(attr) {\r\n    if( !this.config.hasOwnProperty(attr) || this.config[attr] === \"undefined\"){\r\n      return false;\r\n    }else if( this.config[attr] === \"\"){\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  \r\n  get eventReqAttrs(){\r\n    let attrs = {},\r\n    params = [\r\n      {\r\n        attr: 'tmapikey',\r\n        verboseName: 'apikey'\r\n      }\r\n    ];\r\n\r\n    for(let i in params){\r\n      let item = params[i];\r\n      if(this.isConfigAttrExistAndNotEmpty(item.attr))\r\n        attrs[item.verboseName] = this.config[item.attr];\r\n    }\r\n\r\n    return attrs;\r\n  }\r\n\r\n  constructor(root) {\r\n    this.widgetRoot = root;\r\n\r\n    this.eventsRootContainer = document.createElement(\"div\");\r\n    this.eventsRootContainer.classList.add(\"events-root-container\");\r\n    this.widgetRoot.appendChild(this.eventsRootContainer);\r\n\r\n    this.eventsRoot = document.createElement(\"ul\");\r\n    this.eventsRoot.classList.add(\"events-root\");\r\n    this.eventsRootContainer.appendChild(this.eventsRoot);\r\n\r\n    // Set theme modificators\r\n    /*this.themeModificators = {\r\n      \"oldschool\" : this.oldSchoolModificator.bind(this)\r\n    };*/\r\n\r\n    this.config = this.widgetRoot.attributes;\r\n    this.eventId = this.config.id;\r\n\r\n    if(this.config.theme !== null && !document.getElementById(`widget-theme-${this.config.theme}`)){\r\n      this.makeRequest( this.styleLoadingHandler, this.themeUrl + this.config.theme + \".css\" );\r\n    }\r\n\r\n    this.widgetRoot.style.height = `${this.config.height}px`;\r\n    this.widgetRoot.style.width  = `${this.config.width}px`;\r\n\r\n    this.eventsRootContainer.style.height = `${this.config.height}px`;\r\n    this.eventsRootContainer.style.width  = `${this.config.width}px`;\r\n    this.eventsRootContainer.style.borderRadius = `${this.config.borderradius}px`;\r\n    this.eventsRootContainer.style.borderWidth = `${this.borderSize}px`;\r\n\r\n    this.initBuyBtn();\r\n\r\n    this.AdditionalElements();\r\n\r\n    this.initMessage();\r\n\r\n    this.buildCountdown();\r\n\r\n    if(this.apiUrl){\r\n      this.makeRequest( this.eventsLoadingHandler, this.apiUrl, this.eventReqAttrs );\r\n    }else{\r\n      this.showMessage(\"Please enter event ID.\", true, null );\r\n    }\r\n\r\n    /*if( this.themeModificators.hasOwnProperty( this.widgetConfig.theme ) ) {\r\n      this.themeModificators[ this.widgetConfig.theme ]();\r\n    }*/\r\n\r\n    this.embedUniversePlugin();\r\n    this.embedTMPlugin();\r\n\r\n    this.countDownWrapper.classList.add(\"events-count-down\");\r\n\r\n    this.countdownClock = new CountdownClock({\r\n      onChange: this.onCountdownChange.bind(this)\r\n    });\r\n\r\n    this.toggleSecondsVisibility();\r\n  }\r\n\r\n  getNormalizedDateValue(val){\r\n    return (val < 0 || val > 9 ? \"\" : \"0\") + val\r\n  }\r\n\r\n  toggleSecondsVisibility(){\r\n    if(this.countDownMonth.innerHTML > 0){\r\n      this.countDownWrapper.classList.add(\"hide-seconds\");\r\n      this.countDownWrapper.classList.remove(\"hide-days\");\r\n      this.countDownWrapper.classList.remove(\"hide-month\");//Removing a class that does not exist, does NOT throw an error\r\n    }else if(this.countDownDays.innerHTML <= 0){\r\n      this.countDownWrapper.classList.add(\"hide-month\");\r\n      this.countDownWrapper.classList.add(\"hide-days\");\r\n      this.countDownWrapper.classList.remove(\"hide-seconds\");\r\n    }else {\r\n      this.countDownWrapper.classList.add(\"hide-month\");\r\n      this.countDownWrapper.classList.remove(\"hide-days\");\r\n      this.countDownWrapper.classList.remove(\"hide-seconds\");\r\n    }\r\n  }\r\n  \r\n  showStatusMessage(data){\r\n    let me = this;\r\n    if(this.event.date && this.event.date.dateTime){\r\n      chenHeaderEvent(this.event.date);\r\n    }\r\n\r\n    function chenHeaderEvent(eventT){\r\n      let now = new Date(),\r\n          msecsNow = Date.parse(now),\r\n          eventDateStart = new Date(eventT.dateTime),\r\n          msecsStart = Date.parse(eventDateStart),\r\n          eventDateEnd = new Date(eventT.dateTimeEnd),\r\n          msecsEnd = Date.parse(eventDateEnd);\r\n\r\n      if (msecsNow > msecsEnd || isNaN(msecsEnd)) {\r\n        me.showMessage(`This event has taken place`, false , \"event-message-started\");\r\n      } else if (msecsStart < msecsNow < msecsEnd) {\r\n        me.showMessage(`Event is in progress`, false , \"event-message-started\");\r\n      }\r\n    }\r\n  }\r\n\r\n  onCountdownChange(data){\r\n    let timeLeft = this.getNormalizedDateValue(data.total),\r\n        now = Date.parse( new Date() );\r\n\r\n    /*toggle CountDown-Box Visibility*/\r\n    if(timeLeft <= 0 || now < timeLeft){\r\n      this.countDownWrapper.classList.add(\"hide-countDownBox\");\r\n      if(this.eventId && this.event){\r\n        this.showStatusMessage(data);\r\n        return false; //exit if event has taken place\r\n      }\r\n    }else this.countDownWrapper.classList.remove(\"hide-countDownBox\");\r\n\r\n    if(data.monthLeft > 99){\r\n      this.showMessage(`This event starts in more than ${data.monthLeft} month, ${data.days} days, ${data.hours} hours`, false , \"event-message-started\");\r\n      this.countDownWrapper.classList.add(\"hide-countDownBox\");\r\n      return false;\r\n    }\r\n\r\n    this.countDownMonth.innerHTML = this.getNormalizedDateValue(data.monthLeft);\r\n    this.countDownDays.innerHTML = this.getNormalizedDateValue(data.days);\r\n    this.countDownHours.innerHTML = this.getNormalizedDateValue(data.hours);\r\n    this.countDownMinute.innerHTML = this.getNormalizedDateValue(data.minutes);\r\n    this.countDownSecond.innerHTML = this.getNormalizedDateValue(data.seconds);\r\n\r\n    this.toggleSecondsVisibility();\r\n\r\n  }\r\n\r\n  buildCountdown(){\r\n    this.countDownWrapper = document.createElement(\"div\");\r\n    this.countDownWrapper.classList.add(\"events-count-down\");\r\n    this.countDownMonth = document.createElement(\"span\");\r\n    this.countDownDays = document.createElement(\"span\");\r\n    this.countDownHours = document.createElement(\"span\");\r\n    this.countDownMinute = document.createElement(\"span\");\r\n    this.countDownSecond = document.createElement(\"span\");\r\n\r\n    this.countDownMonth.innerHTML = '00';\r\n    this.countDownDays.innerHTML = '00';\r\n    this.countDownHours.innerHTML = '00';\r\n    this.countDownMinute.innerHTML = '00';\r\n    this.countDownSecond.innerHTML = '00';\r\n\r\n    this.countDownMonth.classList.add(\"events-count-down__month\");\r\n    this.countDownDays.classList.add(\"events-count-down__day\");\r\n    this.countDownHours.classList.add(\"events-count-down__hour\");\r\n    this.countDownMinute.classList.add(\"events-count-down__minute\");\r\n    this.countDownSecond.classList.add(\"events-count-down__second\");\r\n\r\n    this.countDownWrapper.appendChild(this.countDownMonth);\r\n    this.countDownWrapper.appendChild(this.countDownDays);\r\n    this.countDownWrapper.appendChild(this.countDownHours);\r\n    this.countDownWrapper.appendChild(this.countDownMinute);\r\n    this.countDownWrapper.appendChild(this.countDownSecond);\r\n\r\n    this.eventsRootContainer.appendChild(this.countDownWrapper);\r\n  }\r\n\r\n  initBuyBtn(){\r\n    this.buyBtn = document.createElement(\"a\");\r\n    this.buyBtn.appendChild(document.createTextNode('BUY NOW'));\r\n    this.buyBtn.classList.add(\"event-buy-btn\");\r\n    this.buyBtn.target = '_blank';\r\n    this.buyBtn.href = '';\r\n    this.buyBtn.setAttribute('onclick', \"ga('send', 'event', 'CountdownClickBuyButton', 'click');\");\r\n    this.buyBtn.addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n    });\r\n    this.eventsRootContainer.appendChild(this.buyBtn);\r\n  }\r\n\r\n  updateTransition(url) {\r\n    var el = this.eventsRootContainer.querySelector(\".event-logo.centered-logo\");\r\n    if(url !=='') {\r\n      if(el){\r\n        el.classList.add(\"right-logo\");\r\n        el.classList.remove(\"centered-logo\");\r\n      }else return;\r\n    }\r\n    else{\r\n      el = this.eventsRootContainer.querySelector(\".event-logo.right-logo\");\r\n      if(el){\r\n        el.classList.remove(\"right-logo\");\r\n        el.classList.add(\"centered-logo\");\r\n      }\r\n    }\r\n  }\r\n\r\n  setBuyBtnUrl(){\r\n    if(this.buyBtn){\r\n      let event = this.event,\r\n          url = '';\r\n      if(event){\r\n        if(event.url){\r\n          if((this.isUniversePluginInitialized && this.isUniverseUrl(event.url)) || (this.isTMPluginInitialized && this.isAllowedTMEvent(event.url))){\r\n            url = event.url;\r\n          }\r\n          this.updateTransition(url);\r\n        }\r\n      }\r\n      this.buyBtn.href = url;\r\n    }\r\n  }\r\n\r\n  isUniverseUrl(url){\r\n    return (url.match(/universe.com/g) || url.match(/uniiverse.com/g));\r\n  }\r\n\r\n  isAllowedTMEvent(url){\r\n    for (var t = [/(?:ticketmaster\\.com)\\/(.*\\/)?event\\/([^\\/?#]+)/, /(?:concerts\\.livenation\\.com)\\/(.*\\/)?event\\/([^\\/?#]+)/], n = null, r = 0; r < t.length && (n = url.match(t[r]), null === n); r++);\r\n    let id = (null !== n ? n[2] : void 0);\r\n    return (this.tmWidgetWhiteList.indexOf(id) > -1);\r\n  }\r\n\r\n  embedTMPlugin(){\r\n    let id = 'id_tm_widget';\r\n    if( !document.getElementById(id) ) {\r\n      let script = document.createElement('script');\r\n      script.setAttribute('src', this.portalUrl + 'scripts/vendors/tm.js');\r\n      script.setAttribute('type', 'text/javascript');\r\n      script.setAttribute('charset', 'UTF-8');\r\n      script.setAttribute('id', id);\r\n      (document.head || document.getElementsByTagName('head')[0]).appendChild(script);\r\n    }\r\n    this.isTMPluginInitialized = true;\r\n  }\r\n\r\n  embedUniversePlugin(){\r\n    let id = 'id_universe_widget';\r\n    if( !document.getElementById(id) ){\r\n      let script = document.createElement('script');\r\n      script.setAttribute('src', 'https://www.universe.com/embed.js');\r\n      script.setAttribute('type', 'text/javascript');\r\n      script.setAttribute('charset', 'UTF-8');\r\n      script.setAttribute('id', id);\r\n      (document.head || document.getElementsByTagName('head')[0]).appendChild(script);\r\n    }\r\n    this.isUniversePluginInitialized = true;\r\n  }\r\n\r\n  // Message\r\n  initMessage(){\r\n    this.messageDialog = document.createElement('div');\r\n    this.messageDialog.classList.add(\"event-message\");\r\n    this.messageContent = document.createElement('div');\r\n    this.messageContent.classList.add(\"event-message__content\");\r\n\r\n    /*let messageClose = document.createElement('div');\r\n    messageClose.classList.add(\"event-message__btn\");\r\n    messageClose.addEventListener(\"click\", ()=> {\r\n      this.hideMessage();\r\n    });*/\r\n\r\n    this.messageDialog.appendChild(this.messageContent);\r\n    /*this.messageDialog.appendChild(messageClose);*/\r\n    this.eventsRootContainer.appendChild(this.messageDialog);\r\n  }\r\n\r\n  showMessage(message, hideMessageWithoutDelay , /*string togleClassName*/className ){\r\n    if(message.length){\r\n      this.hideMessageWithoutDelay = hideMessageWithoutDelay;\r\n      this.messageContent.innerHTML = message;\r\n      this.messageDialog.className = \"\";\r\n      this.messageDialog.classList.add(\"event-message\");\r\n      this.messageDialog.classList.add(\"event-message-visible\");\r\n      // this.messageDialog.classList.remove(\"event-message-started\");\r\n    }\r\n\r\n    if( className ){\r\n      this.messageDialog.classList.add(className);\r\n    }else {\r\n      this.messageDialog.classList.add(\"event-message-visible\");\r\n      this.messageDialog.classList.remove(className);\r\n    }\r\n\r\n    className = null;\r\n\r\n  }\r\n\r\n  hideMessage(){\r\n    if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout and hide message immediately.\r\n    this.messageDialog.classList.remove(\"event-message-visible\");\r\n  }\r\n  // End message\r\n\r\n  AdditionalElements(){\r\n    var legalNoticeContent = document.createTextNode('Legal Notice'),\r\n        legalNotice = document.createElement(\"a\");\r\n    legalNotice.appendChild(legalNoticeContent);\r\n    legalNotice.classList.add(\"legal-notice\");\r\n    legalNotice.target = '_blank';\r\n    legalNotice.href = this.legalNoticeUrl;\r\n    this.widgetRoot.appendChild(legalNotice);\r\n\r\n    var logo = document.createElement('a');\r\n    logo.classList.add(\"event-logo\",\"centered-logo\");\r\n    logo.target = '_blank';\r\n    logo.href = this.logoUrl;\r\n    logo.innerHTML = 'Powered by ';\r\n\r\n    var logoBox = document.createElement('div');\r\n    logoBox.classList.add(\"event-logo-box\");\r\n    logoBox.appendChild(logo);\r\n    this.eventsRootContainer.appendChild(logoBox);\r\n\r\n    let question = document.createElement('span'),\r\n      toolTip = document.createElement('div'),\r\n      tooltipHtml = `\r\n\t\t\t\t<div class=\"tooltip-inner\"> \r\n\t\t\t\t\t<a href=\"${this.questionUrl}\" target = \"_blank\" >About widget</a>\r\n\t\t\t\t\t<div class=\"place\">version: <b>${this.widgetVersion}</b></div>\r\n\t\t\t\t</div>`;\r\n    question.classList.add(\"event-question\");\r\n    question.addEventListener('click', toolTipHandler);\r\n    toolTip.classList.add(\"tooltip-version\");\r\n    toolTip.classList.add(\"left\");\r\n    toolTip.innerHTML = tooltipHtml;\r\n    this.eventsRootContainer.appendChild(question);\r\n    this.eventsRootContainer.appendChild(toolTip);\r\n\r\n    function toolTipHandler(e) {\r\n      e.preventDefault();\r\n      e.target.nextSibling.classList.toggle('show-tip');\r\n    }\r\n  }\r\n\r\n  //adds general admission element for OLDSCHOOL theme\r\n  /*oldSchoolModificator(){\r\n    console.log('inside oldSchoolModificator' );\r\n  }*/\r\n\r\n  formatDate(date) {\r\n    var result = '';\r\n    if(!date.day) return result; // Day is required\r\n\r\n    var MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\r\n        DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],\r\n        dayArray = date.day.split('-'),\r\n        d = parseInt(dayArray[2]),\r\n        M = parseInt(dayArray[1]);\r\n\r\n    // var E = new Date(date.day).getDay();\r\n    var E = new Date(+date.day.split('-')[0],(+date.day.split('-')[1])-1,+date.day.split('-')[2]).getDay();\r\n    result = DAY_NAMES[E] + ', ' + MONTH_NAMES[M - 1] + ' ' + d + ', ' + dayArray[0];\r\n\r\n    if(!date.time) return result;\r\n\r\n    var timeArray = date.time.split(':'),\r\n      H = parseInt(timeArray[0]),\r\n      m = timeArray[1],\r\n      a = \"AM\";\r\n\r\n    if (H > 11) a = \"PM\";\r\n    if (H === 0) {\r\n      H = 12;\r\n    } else if (H > 12) {\r\n      H = H - 12;\r\n    }\r\n\r\n    return result + ' ' + this.getNormalizedDateValue(H) + ':' + m + ' ' + a;\r\n  }\r\n\r\n  clearEvents(){\r\n    this.eventsRoot.innerHTML = \"\";\r\n  }\r\n\r\n  clear(){\r\n    var modificatorList = this.widgetRoot.getElementsByClassName('modificator');\r\n    while (modificatorList.length) {\r\n      let el = modificatorList[0],\r\n          parent = el.parentNode;\r\n      parent.removeChild(el);\r\n    }\r\n    this.clearEvents();\r\n  }\r\n\r\n  update(isFullWidthTheme) {\r\n\r\n    let oldTheme = this.config.constructor();\r\n    for (let attr in this.config) {\r\n      if (this.config.hasOwnProperty(attr)) oldTheme[attr] = this.config[attr];\r\n    }\r\n\r\n    this.config = this.widgetRoot.attributes;\r\n    this.widgetRoot.style.height = `${this.config.height}px`;\r\n    this.widgetRoot.style.width  = `${this.config.width}px`;\r\n    this.eventsRootContainer.style.height = `${this.config.height}px`;\r\n    this.eventsRootContainer.style.width  = `${this.config.width}px`;\r\n    this.eventsRootContainer.style.borderRadius = `${this.config.borderradius}px`;\r\n    this.eventsRootContainer.style.borderWidth = `${this.borderSize}px`;\r\n\r\n\r\n\r\n    if(this.needToUpdate(this.config, oldTheme, this.updateExceptions) || isFullWidthTheme){\r\n      this.clear();\r\n\r\n      if(this.config.theme !== null){\r\n        //set new styles\r\n        this.makeRequest( this.styleLoadingHandler, this.themeUrl + this.config.theme + \".css\" );\r\n      }\r\n\r\n      if(this.widgetConfig.theme !== 'simple_countdown') {\r\n        let heightStatic = '700px';\r\n        //draw inline style\r\n        //border\r\n        this.eventsRootContainer.style.borderRadius = `${this.config.borderradius}px`;\r\n        this.eventsRootContainer.style.borderWidth = `${this.borderSize}px`;\r\n\r\n        //set width\r\n        this.widgetRoot.style.width = `100%`;\r\n        this.widgetRoot.style.height = heightStatic;\r\n        this.widgetRoot.style.display = `block`;\r\n        this.eventsRootContainer.style.width  = `100%`;\r\n        this.eventsRootContainer.style.height = heightStatic;\r\n        this.widgetConfig.width = `100%`;\r\n      }\r\n\r\n      /*if( this.themeModificators.hasOwnProperty( this.widgetConfig.theme ) ) {\r\n        this.themeModificators[ this.widgetConfig.theme ]();\r\n      }*/\r\n\r\n      if(this.apiUrl && this.eventId){\r\n        this.makeRequest( this.eventsLoadingHandler, this.apiUrl, this.eventReqAttrs );\r\n      }else{\r\n        // this.showMessage(\"No results were found.\", true);\r\n        this.showMessage(\"No events were found\", true, 'cactus');\r\n        this.countdownClock.update(null);\r\n      }\r\n    }else{\r\n      let events = this.widgetRoot.getElementsByClassName(\"event-wrapper\");\r\n      for(let i in events){\r\n        if(events.hasOwnProperty(i) && events[i].style !== undefined){\r\n          events[i].style.width = `${this.config.width - this.borderSize * 2}px`;\r\n          events[i].style.height = `${this.config.height - this.borderSize * 2}px`;\r\n        }\r\n      }\r\n    }\r\n    //this.toggleSecondsVisibility();\r\n  }\r\n\r\n  needToUpdate(newTheme, oldTheme, forCheck = []){\r\n    return Object.keys(newTheme).map(function(key){\r\n      if(forCheck.indexOf(key) > -1) return true;\r\n      //console.warn([key, newTheme[key], oldTheme[key], newTheme[key] === oldTheme[key]])\r\n      return newTheme[key] === oldTheme[key] ;\r\n    }).indexOf(false) > -1\r\n  }\r\n\r\n  loadConfig(NamedNodeMap){\r\n      var config = {};\r\n      Object.keys(NamedNodeMap).map(function(value){\r\n        if( typeof(NamedNodeMap[value].name) !== \"undefined\" && NamedNodeMap[value].name.indexOf(\"w-\") !== -1){\r\n          config[ NamedNodeMap[value].name.replace(/w-/g, \"\").replace(/-/g, \"\") ] = NamedNodeMap[value].value;\r\n        }\r\n      });\r\n      return config;\r\n  }\r\n\r\n  styleLoadingHandler(){\r\n    if (this && this.readyState == XMLHttpRequest.DONE ) {\r\n      if(this.status == 200){\r\n        var style = document.createElement(\"style\");\r\n        style.setAttribute(\"type\",\"text/css\");\r\n        style.setAttribute(\"id\",`widget-theme-${this.widget.config.theme}`);\r\n        style.textContent = this.responseText;\r\n        document.getElementsByTagName(\"head\")[0].appendChild(style);\r\n      }\r\n      else {\r\n        console.info(\"theme wasn't loaded\");\r\n      }\r\n    }\r\n  }\r\n\r\n  onEventLoadError(status,loadOnce){\r\n    this.event = false;\r\n    this.showMessage(\"No results were found.\", true, null);\r\n    console.log(`There was an error status - ${status}`);\r\n    if(!loadOnce) {\r\n      this.changeDefaultId();\r\n    }\r\n  }  \r\n\r\n  eventsLoadingHandler(){\r\n    let widget = this.widget;\r\n    widget.clearEvents(); // Additional clearing after each loading\r\n    if (this && this.readyState == XMLHttpRequest.DONE ) {\r\n      if(this.status == 200){\r\n        widget.event = JSON.parse(this.responseText);\r\n        if(widget.event){\r\n          widget.publishEvent(widget.event);\r\n          widget.hideMessage();\r\n        }\r\n      }\r\n      else if(this.status == 400) {\r\n        widget.onEventLoadError.call(widget, this.status);\r\n      }\r\n      else {\r\n        widget.onEventLoadError.call(widget, this.status);\r\n      }\r\n      // http://js2coffee.thomaskalka.de/ - widget.event?.date?.dateTime\r\n      let _ref, _ref2;\r\n      widget.countdownClock.update((_ref = widget.event) != null ? (_ref2 = _ref.date) != null ? _ref2.dateTime || _ref2.day : void 0 : void 0);\r\n    }\r\n    widget.setBuyBtnUrl();\r\n  }\r\n\r\n  publishEvent(event, parentNode){\r\n    parentNode = parentNode || this.eventsRoot;\r\n    let DOMElement = this.createDOMItem(event);\r\n    parentNode.appendChild(DOMElement);\r\n  }\r\n\r\n  getImageForEvent(images){\r\n    var width = this.config.width,\r\n      height = this.config.height;\r\n\r\n    images.sort(function(a,b) {\r\n      if (a.width < b.width)\r\n        return -1;\r\n      else if (a.width > b.width)\r\n        return 1;\r\n      else\r\n        return 0;\r\n    });\r\n\r\n    var myImg = \"\";\r\n    images.forEach(function(element){\r\n      if(element.width >= width && element.height >= height && !myImg){\r\n        myImg = element.url;\r\n      }\r\n    });\r\n    if(myImg === \"\") {\r\n      myImg = images[images.length-1].url;\r\n    }\r\n    return myImg;\r\n  }\r\n\r\n  parseEvent(eventSet){\r\n    if(!eventSet.id){\r\n      return false;\r\n    }\r\n\r\n    let currentEvent = {};\r\n\r\n    currentEvent.id = eventSet.id;\r\n    currentEvent.url = eventSet.url;\r\n    currentEvent.name = eventSet.name;\r\n\r\n    currentEvent.date = {\r\n      day: eventSet.dates.start.localDate,\r\n      time: eventSet.dates.start.localTime,\r\n      dateTime: eventSet.dates.start.dateTime\r\n    };\r\n    \r\n    if(eventSet.dates.end){\r\n      (eventSet.dates.end.localDate) ? currentEvent.date.dayEnd = eventSet.dates.end.localDate : '';\r\n      (eventSet.dates.end.localTime) ? currentEvent.date.timeEnd = eventSet.dates.end.localTime : '';\r\n      (eventSet.dates.end.dateTime) ? currentEvent.date.dateTimeEnd = eventSet.dates.end.dateTime : '';\r\n    }\r\n\r\n    if(eventSet.hasOwnProperty('_embedded') && eventSet._embedded.hasOwnProperty('venues')){\r\n      let venue = eventSet._embedded.venues[0];\r\n      if(venue){\r\n        if(venue.address)\r\n          currentEvent.address = venue.address;\r\n\r\n        if(venue.name){\r\n          if(!currentEvent.address) currentEvent.address = {};\r\n          currentEvent.address.name = venue.name;\r\n        }\r\n      }\r\n    }\r\n\r\n    currentEvent.img = this.getImageForEvent(eventSet.images);\r\n    return currentEvent;\r\n  }\r\n\r\n  changeDefaultId(){\r\n    Date.prototype.addDays = function(days) {\r\n      this.setDate(this.getDate() + parseInt(days));\r\n      return this;\r\n    };\r\n    let zipVegas='89109',\r\n      url=`https://app.ticketmaster.com/discovery/v2/events.json`,\r\n      newAttr = Object.assign({},this.eventReqAttrs),\r\n      d = new Date(0),\r\n      convertedNewStartDate;\r\n\r\n    d.setUTCSeconds(Math.round(new Date().addDays(30).getTime())/1000);\r\n    convertedNewStartDate = d.toJSON().slice(0,17)+'00Z';\r\n    if(d.toJSON().length <= 20) convertedNewStartDate = d.toJSON();\r\n    newAttr.startDateTime = convertedNewStartDate;\r\n    newAttr.zipcode = zipVegas;\r\n\r\n    this.makeRequest(this.changeDefaultIdHandler, url, newAttr );\r\n  }\r\n  \r\n  changeDefaultIdHandler(){\r\n    function getValidId(events){\r\n      let id = '',\r\n          newStartDate = new Date().addDays(30);\r\n      \r\n      for(let ii=0;ii<events.length;ii++){\r\n        if ( Math.round(new Date(events[ii].dates.start.dateTime).getTime()/1000) >= Math.round(new Date(newStartDate).getTime()/1000) ){\r\n          id = events[ii].id;\r\n          break;\r\n        }        \r\n      }\r\n      return id;\r\n    }\r\n    function setEventId(){\r\n       return ()=> this.makeRequest( this.eventsLoadingHandler, this.apiUrl, this.eventReqAttrs );\r\n    }\r\n    let widget = this.widget;\r\n    let loadOnce = false;\r\n    widget.clearEvents(); // Additional clearing after each loading\r\n\r\n    if (this && this.readyState == XMLHttpRequest.DONE ) {\r\n      if(this.status == 200){\r\n        let eventsWrap = JSON.parse(this.responseText);\r\n        if(eventsWrap){\r\n          let events = eventsWrap['_embedded']['events'],\r\n              newId = getValidId(events);\r\n          widget.eventId = newId;\r\n          if(document.getElementById('w-id')){\r\n            document.getElementById('w-id').value = widget.eventId;\r\n          }\r\n          setEventId.call(widget,newId)();\r\n        }\r\n      }\r\n      else if(this.status == 400) {\r\n        loadOnce = true;\r\n        widget.onEventLoadError.call(widget, this.status,loadOnce);\r\n      }\r\n      else {\r\n        console.log('this error',this);\r\n        loadOnce = true;\r\n        widget.onEventLoadError.call(widget, this.status,loadOnce);\r\n      }\r\n      // http://js2coffee.thomaskalka.de/ - widget.event?.date?.dateTime\r\n      let _ref, _ref2;\r\n      widget.countdownClock.update((_ref = widget.event) != null ? (_ref2 = _ref.date) != null ? _ref2.dateTime || _ref2.day : void 0 : void 0);\r\n    }\r\n    widget.setBuyBtnUrl();\r\n\r\n  }\r\n\r\n  makeRequest(handler, url=this.apiUrl, attrs={}, method=\"GET\"){\r\n    attrs = Object.keys(attrs).map(function(key){\r\n      return `${key}=${attrs[key]}`;\r\n    }).join(\"&\");\r\n\r\n    url = [url,attrs].join(\"?\");\r\n\r\n    this.xmlHTTP = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    if(method == \"POST\") {\r\n      this.xmlHTTP.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\r\n    }\r\n    this.xmlHTTP.widget = this;\r\n    this.xmlHTTP.onreadystatechange = handler;\r\n    this.xmlHTTP.open(method, url, true);\r\n    this.xmlHTTP.send();\r\n  }\r\n\r\n\r\n  initPretendedLink(el, url, isBlank){\r\n    if(el && url){\r\n      el.setAttribute('data-url', url);\r\n      el.classList.add(\"event-pretended-link\");\r\n      el.addEventListener('click', function(){\r\n        let url = this.getAttribute('data-url');\r\n        if(url){\r\n          let win = window.open(url, (isBlank ? '_blank' : '_self'));\r\n          win.focus();\r\n        }\r\n      });\r\n    }\r\n    return el;\r\n  }\r\n\r\n\r\n  createDOMItem(itemConfig){\r\n    var medWrapper = document.createElement(\"div\");\r\n    medWrapper.classList.add(\"event-content-wraper\");\r\n\r\n    var event = document.createElement(\"li\");\r\n    event.classList.add(\"event-wrapper\");\r\n    event.style.height = `${this.config.height - this.borderSize * 2}px`;\r\n    event.style.width  = `${this.config.width - this.borderSize * 2}px`;\r\n\r\n    var image = document.createElement(\"span\");\r\n    image.classList.add(\"bg-cover\");\r\n    image.style.backgroundImage = `url('${itemConfig.img}')`;\r\n    event.appendChild(image);\r\n\r\n    var nameContent = document.createTextNode(itemConfig.name),\r\n    name = document.createElement(\"span\");\r\n    name.classList.add(\"event-name\");\r\n    name.appendChild(nameContent);\r\n    this.initPretendedLink(name, itemConfig.url, true);\r\n    name.setAttribute('onclick', `ga('send', 'event', 'CountDownClickeventName_theme=${this.config.theme}_width=${this.config.width}_height=${this.config.height}_color_scheme=light', 'click', '${itemConfig.url}');`);\r\n    medWrapper.appendChild(name);\r\n\r\n\r\n    var dateTimeContent = document.createTextNode(this.formatDate(itemConfig.date)),\r\n    dateTime = document.createElement(\"span\");\r\n    dateTime.classList.add(\"event-date\");\r\n    dateTime.appendChild(dateTimeContent);\r\n\r\n    var dateWraper = document.createElement(\"span\");\r\n    dateWraper.classList.add(\"event-date-wraper\");\r\n    dateWraper.appendChild(dateTime);\r\n    medWrapper.appendChild(dateWraper);\r\n\r\n    if(itemConfig.hasOwnProperty(\"address\")){\r\n      var addressWrapper = document.createElement(\"span\");\r\n      addressWrapper.classList.add(\"address-wrapper\");\r\n\r\n      if( itemConfig.address.hasOwnProperty(\"name\") ){\r\n        var addressNameText = document.createTextNode(itemConfig.address.name),\r\n            addressName =  document.createElement(\"span\");\r\n        addressName.classList.add(\"event-address\");\r\n        addressName.classList.add(\"event-address-name\");\r\n        addressName.appendChild(addressNameText);\r\n        addressWrapper.appendChild(addressName);\r\n      }\r\n\r\n      if( itemConfig.address.hasOwnProperty(\"line1\") ){\r\n        var addressOneText = document.createTextNode(itemConfig.address.line1),\r\n        addressOne =  document.createElement(\"span\");\r\n        addressOne.classList.add(\"event-address\");\r\n        addressOne.appendChild(addressOneText);\r\n        addressWrapper.appendChild(addressOne);\r\n      }\r\n\r\n      if( itemConfig.address.hasOwnProperty(\"line2\") ){\r\n        var addressTwoText = document.createTextNode(itemConfig.address.line2),\r\n        addressTwo =  document.createElement(\"span\");\r\n        addressTwo.classList.add(\"event-address\");\r\n        addressTwo.appendChild(addressTwoText);\r\n        addressWrapper.appendChild(addressTwo);\r\n      }\r\n\r\n      medWrapper.appendChild(addressWrapper);\r\n    }\r\n\r\n    if(itemConfig.hasOwnProperty(\"categories\")) {\r\n      var categoriesWrapper = document.createElement(\"span\");\r\n      categoriesWrapper.classList.add(\"category-wrapper\");\r\n\r\n      itemConfig.categories.forEach(function (element) {\r\n        var categoryText = document.createTextNode(element),\r\n          category = document.createElement(\"span\");\r\n        category.classList.add(\"event-category\");\r\n        category.appendChild(categoryText);\r\n        categoriesWrapper.appendChild(category);\r\n      });\r\n      medWrapper.appendChild(categoriesWrapper);\r\n    }\r\n\r\n    event.appendChild(medWrapper);\r\n\r\n    return event;\r\n  }\r\n\r\n  /*\r\n   * Config block\r\n   */\r\n\r\n  decConfig(config){\r\n    return JSON.parse(window.atob(config));\r\n  }\r\n\r\n  encConfig(config){\r\n    return window.btoa(config);\r\n  }\r\n\r\n}\r\n\r\nlet widgetsCountdown = [];\r\n(function () {\r\n  let widgetContainers = document.querySelectorAll(\"div[w-type='countdown']\");\r\n  for (let i = 0; i < widgetContainers.length; ++i) {\r\n    widgetsCountdown.push(new TicketmasterCountdownWidget(widgetContainers[i]));\r\n  }\r\n\r\n})();\r\n\r\n(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\r\n      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\r\n    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r\n})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');\r\n\r\nga('create', 'UA-78317809-1', 'auto');\r\nga('send', 'pageview');\r\n\r\n\r\nif(typeof module !== \"undefined\") {\r\n    module.exports = { CountdownClock , TicketmasterCountdownWidget };\r\n}\r\n"]}