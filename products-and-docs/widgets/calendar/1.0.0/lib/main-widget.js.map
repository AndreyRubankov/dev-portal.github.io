{"version":3,"file":"./products-and-docs/widgets/calendar/1.0.0/lib/main-widget.js","sources":["webpack:///webpack/bootstrap d6a47fd2e180c5c3bbed","webpack:///./products-and-docs/widgets/calendar/1.0.0/src/main-widget.es6"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d6a47fd2e180c5c3bbed","/*var promisePolyfill = function() {\n    console.log('windowActiveXObject' , (window.ActiveXObject || \"ActiveXObject\" in window));\n    if (window.ActiveXObject || \"ActiveXObject\" in window) {\n        !function (t) {\n            if (\"object\" == typeof exports && \"undefined\" != typeof module)module.exports = t(); else if (\"function\" == typeof define && define.amd)define([], t); else {\n                var e;\n                \"undefined\" != typeof window ? e = window : \"undefined\" != typeof global ? e = global : \"undefined\" != typeof self && (e = self), e.Promise = t()\n            }\n        }(function () {\n            var t, e, n;\n            return function r(t, e, n) {\n                function i(s, a) {\n                    if (!e[s]) {\n                        if (!t[s]) {\n                            var c = \"function\" == typeof _dereq_ && _dereq_;\n                            if (!a && c)return c(s, !0);\n                            if (o)return o(s, !0);\n                            var l = new Error(\"Cannot find module '\" + s + \"'\");\n                            throw l.code = \"MODULE_NOT_FOUND\", l\n                        }\n                        var u = e[s] = {exports: {}};\n                        t[s][0].call(u.exports, function (e) {\n                            var n = t[s][1][e];\n                            return i(n ? n : e)\n                        }, u, u.exports, r, t, e, n)\n                    }\n                    return e[s].exports\n                }\n\n                for (var o = \"function\" == typeof _dereq_ && _dereq_, s = 0; s < n.length; s++)i(n[s]);\n                return i\n            }({\n                1: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t) {\n                        function e(t) {\n                            var e = new n(t), r = e.promise();\n                            return e.setHowMany(1), e.setUnwrap(), e.init(), r\n                        }\n\n                        var n = t._SomePromiseArray;\n                        t.any = function (t) {\n                            return e(t)\n                        }, t.prototype.any = function () {\n                            return e(this)\n                        }\n                    }\n                }, {}], 2: [function (t, e, n) {\n                    \"use strict\";\n                    function r() {\n                        this._customScheduler = !1, this._isTickUsed = !1, this._lateQueue = new u(16), this._normalQueue = new u(16), this._haveDrainedQueues = !1, this._trampolineEnabled = !0;\n                        var t = this;\n                        this.drainQueues = function () {\n                            t._drainQueues()\n                        }, this._schedule = l\n                    }\n\n                    function i(t, e, n) {\n                        this._lateQueue.push(t, e, n), this._queueTick()\n                    }\n\n                    function o(t, e, n) {\n                        this._normalQueue.push(t, e, n), this._queueTick()\n                    }\n\n                    function s(t) {\n                        this._normalQueue._pushOne(t), this._queueTick()\n                    }\n\n                    var a;\n                    try {\n                        throw new Error\n                    } catch (c) {\n                        a = c\n                    }\n                    var l = t(\"./schedule\"), u = t(\"./queue\"), p = t(\"./util\");\n                    r.prototype.setScheduler = function (t) {\n                        var e = this._schedule;\n                        return this._schedule = t, this._customScheduler = !0, e\n                    }, r.prototype.hasCustomScheduler = function () {\n                        return this._customScheduler\n                    }, r.prototype.enableTrampoline = function () {\n                        this._trampolineEnabled = !0\n                    }, r.prototype.disableTrampolineIfNecessary = function () {\n                        p.hasDevTools && (this._trampolineEnabled = !1)\n                    }, r.prototype.haveItemsQueued = function () {\n                        return this._isTickUsed || this._haveDrainedQueues\n                    }, r.prototype.fatalError = function (t, e) {\n                        e ? (process.stderr.write(\"Fatal \" + (t instanceof Error ? t.stack : t) + \"\\n\"), process.exit(2)) : this.throwLater(t)\n                    }, r.prototype.throwLater = function (t, e) {\n                        if (1 === arguments.length && (e = t, t = function () {\n                                throw e\n                            }), \"undefined\" != typeof setTimeout)setTimeout(function () {\n                            t(e)\n                        }, 0); else try {\n                            this._schedule(function () {\n                                t(e)\n                            })\n                        } catch (n) {\n                            throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")\n                        }\n                    }, p.hasDevTools ? (r.prototype.invokeLater = function (t, e, n) {\n                        this._trampolineEnabled ? i.call(this, t, e, n) : this._schedule(function () {\n                            setTimeout(function () {\n                                t.call(e, n)\n                            }, 100)\n                        })\n                    }, r.prototype.invoke = function (t, e, n) {\n                        this._trampolineEnabled ? o.call(this, t, e, n) : this._schedule(function () {\n                            t.call(e, n)\n                        })\n                    }, r.prototype.settlePromises = function (t) {\n                        this._trampolineEnabled ? s.call(this, t) : this._schedule(function () {\n                            t._settlePromises()\n                        })\n                    }) : (r.prototype.invokeLater = i, r.prototype.invoke = o, r.prototype.settlePromises = s), r.prototype.invokeFirst = function (t, e, n) {\n                        this._normalQueue.unshift(t, e, n), this._queueTick()\n                    }, r.prototype._drainQueue = function (t) {\n                        for (; t.length() > 0;) {\n                            var e = t.shift();\n                            if (\"function\" == typeof e) {\n                                var n = t.shift(), r = t.shift();\n                                e.call(n, r)\n                            } else e._settlePromises()\n                        }\n                    }, r.prototype._drainQueues = function () {\n                        this._drainQueue(this._normalQueue), this._reset(), this._haveDrainedQueues = !0, this._drainQueue(this._lateQueue)\n                    }, r.prototype._queueTick = function () {\n                        this._isTickUsed || (this._isTickUsed = !0, this._schedule(this.drainQueues))\n                    }, r.prototype._reset = function () {\n                        this._isTickUsed = !1\n                    }, e.exports = r, e.exports.firstLineError = a\n                }, {\"./queue\": 26, \"./schedule\": 29, \"./util\": 36}], 3: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t, e, n, r) {\n                        var i = !1, o = function (t, e) {\n                            this._reject(e)\n                        }, s = function (t, e) {\n                            e.promiseRejectionQueued = !0, e.bindingPromise._then(o, o, null, this, t)\n                        }, a = function (t, e) {\n                            0 === (50397184 & this._bitField) && this._resolveCallback(e.target)\n                        }, c = function (t, e) {\n                            e.promiseRejectionQueued || this._reject(t)\n                        };\n                        t.prototype.bind = function (o) {\n                            i || (i = !0, t.prototype._propagateFrom = r.propagateFromFunction(), t.prototype._boundValue = r.boundValueFunction());\n                            var l = n(o), u = new t(e);\n                            u._propagateFrom(this, 1);\n                            var p = this._target();\n                            if (u._setBoundTo(l), l instanceof t) {\n                                var h = {promiseRejectionQueued: !1, promise: u, target: p, bindingPromise: l};\n                                p._then(e, s, void 0, u, h), l._then(a, c, void 0, u, h), u._setOnCancel(l)\n                            } else u._resolveCallback(p);\n                            return u\n                        }, t.prototype._setBoundTo = function (t) {\n                            void 0 !== t ? (this._bitField = 2097152 | this._bitField, this._boundTo = t) : this._bitField = -2097153 & this._bitField\n                        }, t.prototype._isBound = function () {\n                            return 2097152 === (2097152 & this._bitField)\n                        }, t.bind = function (e, n) {\n                            return t.resolve(n).bind(e)\n                        }\n                    }\n                }, {}], 4: [function (t, e, n) {\n                    \"use strict\";\n                    function r() {\n                        try {\n                            Promise === o && (Promise = i)\n                        } catch (t) {\n                        }\n                        return o\n                    }\n\n                    var i;\n                    \"undefined\" != typeof Promise && (i = Promise);\n                    var o = t(\"./promise\")();\n                    o.noConflict = r, e.exports = o\n                }, {\"./promise\": 22}], 5: [function (t, e, n) {\n                    \"use strict\";\n                    var r = Object.create;\n                    if (r) {\n                        var i = r(null), o = r(null);\n                        i[\" size\"] = o[\" size\"] = 0\n                    }\n                    e.exports = function (e) {\n                        function n(t, n) {\n                            var r;\n                            if (null != t && (r = t[n]), \"function\" != typeof r) {\n                                var i = \"Object \" + a.classString(t) + \" has no method '\" + a.toString(n) + \"'\";\n                                throw new e.TypeError(i)\n                            }\n                            return r\n                        }\n\n                        function r(t) {\n                            var e = this.pop(), r = n(t, e);\n                            return r.apply(t, this)\n                        }\n\n                        function i(t) {\n                            return t[this]\n                        }\n\n                        function o(t) {\n                            var e = +this;\n                            return 0 > e && (e = Math.max(0, e + t.length)), t[e]\n                        }\n\n                        var s, a = t(\"./util\"), c = a.canEvaluate;\n                        a.isIdentifier;\n                        e.prototype.call = function (t) {\n                            var e = [].slice.call(arguments, 1);\n                            return e.push(t), this._then(r, void 0, void 0, e, void 0)\n                        }, e.prototype.get = function (t) {\n                            var e, n = \"number\" == typeof t;\n                            if (n)e = o; else if (c) {\n                                var r = s(t);\n                                e = null !== r ? r : i\n                            } else e = i;\n                            return this._then(e, void 0, void 0, t, void 0)\n                        }\n                    }\n                }, {\"./util\": 36}], 6: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i) {\n                        var o = t(\"./util\"), s = o.tryCatch, a = o.errorObj, c = e._async;\n                        e.prototype[\"break\"] = e.prototype.cancel = function () {\n                            if (!i.cancellation())return this._warn(\"cancellation is disabled\");\n                            for (var t = this, e = t; t._isCancellable();) {\n                                if (!t._cancelBy(e)) {\n                                    e._isFollowing() ? e._followee().cancel() : e._cancelBranched();\n                                    break\n                                }\n                                var n = t._cancellationParent;\n                                if (null == n || !n._isCancellable()) {\n                                    t._isFollowing() ? t._followee().cancel() : t._cancelBranched();\n                                    break\n                                }\n                                t._isFollowing() && t._followee().cancel(), t._setWillBeCancelled(), e = t, t = n\n                            }\n                        }, e.prototype._branchHasCancelled = function () {\n                            this._branchesRemainingToCancel--\n                        }, e.prototype._enoughBranchesHaveCancelled = function () {\n                            return void 0 === this._branchesRemainingToCancel || this._branchesRemainingToCancel <= 0\n                        }, e.prototype._cancelBy = function (t) {\n                            return t === this ? (this._branchesRemainingToCancel = 0, this._invokeOnCancel(), !0) : (this._branchHasCancelled(), this._enoughBranchesHaveCancelled() ? (this._invokeOnCancel(), !0) : !1)\n                        }, e.prototype._cancelBranched = function () {\n                            this._enoughBranchesHaveCancelled() && this._cancel()\n                        }, e.prototype._cancel = function () {\n                            this._isCancellable() && (this._setCancelled(), c.invoke(this._cancelPromises, this, void 0))\n                        }, e.prototype._cancelPromises = function () {\n                            this._length() > 0 && this._settlePromises()\n                        }, e.prototype._unsetOnCancel = function () {\n                            this._onCancelField = void 0\n                        }, e.prototype._isCancellable = function () {\n                            return this.isPending() && !this._isCancelled()\n                        }, e.prototype.isCancellable = function () {\n                            return this.isPending() && !this.isCancelled()\n                        }, e.prototype._doInvokeOnCancel = function (t, e) {\n                            if (o.isArray(t))for (var n = 0; n < t.length; ++n)this._doInvokeOnCancel(t[n], e); else if (void 0 !== t)if (\"function\" == typeof t) {\n                                if (!e) {\n                                    var r = s(t).call(this._boundValue());\n                                    r === a && (this._attachExtraTrace(r.e), c.throwLater(r.e))\n                                }\n                            } else t._resultCancelled(this)\n                        }, e.prototype._invokeOnCancel = function () {\n                            var t = this._onCancel();\n                            this._unsetOnCancel(), c.invoke(this._doInvokeOnCancel, this, t)\n                        }, e.prototype._invokeInternalOnCancel = function () {\n                            this._isCancellable() && (this._doInvokeOnCancel(this._onCancel(), !0), this._unsetOnCancel())\n                        }, e.prototype._resultCancelled = function () {\n                            this.cancel()\n                        }\n                    }\n                }, {\"./util\": 36}], 7: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e) {\n                        function n(t, n, a) {\n                            return function (c) {\n                                var l = a._boundValue();\n                                t:for (var u = 0; u < t.length; ++u) {\n                                    var p = t[u];\n                                    if (p === Error || null != p && p.prototype instanceof Error) {\n                                        if (c instanceof p)return o(n).call(l, c)\n                                    } else if (\"function\" == typeof p) {\n                                        var h = o(p).call(l, c);\n                                        if (h === s)return h;\n                                        if (h)return o(n).call(l, c)\n                                    } else if (r.isObject(c)) {\n                                        for (var f = i(p), _ = 0; _ < f.length; ++_) {\n                                            var d = f[_];\n                                            if (p[d] != c[d])continue t\n                                        }\n                                        return o(n).call(l, c)\n                                    }\n                                }\n                                return e\n                            }\n                        }\n\n                        var r = t(\"./util\"), i = t(\"./es5\").keys, o = r.tryCatch, s = r.errorObj;\n                        return n\n                    }\n                }, {\"./es5\": 13, \"./util\": 36}], 8: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t) {\n                        function e() {\n                            this._trace = new e.CapturedTrace(r())\n                        }\n\n                        function n() {\n                            return i ? new e : void 0\n                        }\n\n                        function r() {\n                            var t = o.length - 1;\n                            return t >= 0 ? o[t] : void 0\n                        }\n\n                        var i = !1, o = [];\n                        return t.prototype._promiseCreated = function () {\n                        }, t.prototype._pushContext = function () {\n                        }, t.prototype._popContext = function () {\n                            return null\n                        }, t._peekContext = t.prototype._peekContext = function () {\n                        }, e.prototype._pushContext = function () {\n                            void 0 !== this._trace && (this._trace._promiseCreated = null, o.push(this._trace))\n                        }, e.prototype._popContext = function () {\n                            if (void 0 !== this._trace) {\n                                var t = o.pop(), e = t._promiseCreated;\n                                return t._promiseCreated = null, e\n                            }\n                            return null\n                        }, e.CapturedTrace = null, e.create = n, e.deactivateLongStackTraces = function () {\n                        }, e.activateLongStackTraces = function () {\n                            var n = t.prototype._pushContext, o = t.prototype._popContext, s = t._peekContext, a = t.prototype._peekContext, c = t.prototype._promiseCreated;\n                            e.deactivateLongStackTraces = function () {\n                                t.prototype._pushContext = n, t.prototype._popContext = o, t._peekContext = s, t.prototype._peekContext = a, t.prototype._promiseCreated = c, i = !1\n                            }, i = !0, t.prototype._pushContext = e.prototype._pushContext, t.prototype._popContext = e.prototype._popContext, t._peekContext = t.prototype._peekContext = r, t.prototype._promiseCreated = function () {\n                                var t = this._peekContext();\n                                t && null == t._promiseCreated && (t._promiseCreated = this)\n                            }\n                        }, e\n                    }\n                }, {}], 9: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n) {\n                        function r(t, e) {\n                            return {promise: e}\n                        }\n\n                        function i() {\n                            return !1\n                        }\n\n                        function o(t, e, n) {\n                            var r = this;\n                            try {\n                                t(e, n, function (t) {\n                                    if (\"function\" != typeof t)throw new TypeError(\"onCancel must be a function, got: \" + H.toString(t));\n                                    r._attachCancellationCallback(t)\n                                })\n                            } catch (i) {\n                                return i\n                            }\n                        }\n\n                        function s(t) {\n                            if (!this._isCancellable())return this;\n                            var e = this._onCancel();\n                            void 0 !== e ? H.isArray(e) ? e.push(t) : this._setOnCancel([e, t]) : this._setOnCancel(t)\n                        }\n\n                        function a() {\n                            return this._onCancelField\n                        }\n\n                        function c(t) {\n                            this._onCancelField = t\n                        }\n\n                        function l() {\n                            this._cancellationParent = void 0, this._onCancelField = void 0\n                        }\n\n                        function u(t, e) {\n                            if (0 !== (1 & e)) {\n                                this._cancellationParent = t;\n                                var n = t._branchesRemainingToCancel;\n                                void 0 === n && (n = 0), t._branchesRemainingToCancel = n + 1\n                            }\n                            0 !== (2 & e) && t._isBound() && this._setBoundTo(t._boundTo)\n                        }\n\n                        function p(t, e) {\n                            0 !== (2 & e) && t._isBound() && this._setBoundTo(t._boundTo)\n                        }\n\n                        function h() {\n                            var t = this._boundTo;\n                            return void 0 !== t && t instanceof e ? t.isFulfilled() ? t.value() : void 0 : t\n                        }\n\n                        function f() {\n                            this._trace = new S(this._peekContext())\n                        }\n\n                        function _(t, e) {\n                            if (N(t)) {\n                                var n = this._trace;\n                                if (void 0 !== n && e && (n = n._parent), void 0 !== n)n.attachExtraTrace(t); else if (!t.__stackCleaned__) {\n                                    var r = j(t);\n                                    H.notEnumerableProp(t, \"stack\", r.message + \"\\n\" + r.stack.join(\"\\n\")), H.notEnumerableProp(t, \"__stackCleaned__\", !0)\n                                }\n                            }\n                        }\n\n                        function d(t, e, n, r, i) {\n                            if (void 0 === t && null !== e && W) {\n                                if (void 0 !== i && i._returnedNonUndefined())return;\n                                if (0 === (65535 & r._bitField))return;\n                                n && (n += \" \");\n                                var o = \"\", s = \"\";\n                                if (e._trace) {\n                                    for (var a = e._trace.stack.split(\"\\n\"), c = w(a), l = c.length - 1; l >= 0; --l) {\n                                        var u = c[l];\n                                        if (!U.test(u)) {\n                                            var p = u.match(M);\n                                            p && (o = \"at \" + p[1] + \":\" + p[2] + \":\" + p[3] + \" \");\n                                            break\n                                        }\n                                    }\n                                    if (c.length > 0)for (var h = c[0], l = 0; l < a.length; ++l)if (a[l] === h) {\n                                        l > 0 && (s = \"\\n\" + a[l - 1]);\n                                        break\n                                    }\n                                }\n                                var f = \"a promise was created in a \" + n + \"handler \" + o + \"but was not returned from it, see http://goo.gl/rRqMUw\" + s;\n                                r._warn(f, !0, e)\n                            }\n                        }\n\n                        function v(t, e) {\n                            var n = t + \" is deprecated and will be removed in a future version.\";\n                            return e && (n += \" Use \" + e + \" instead.\"), y(n)\n                        }\n\n                        function y(t, n, r) {\n                            if (ot.warnings) {\n                                var i, o = new L(t);\n                                if (n)r._attachExtraTrace(o); else if (ot.longStackTraces && (i = e._peekContext()))i.attachExtraTrace(o); else {\n                                    var s = j(o);\n                                    o.stack = s.message + \"\\n\" + s.stack.join(\"\\n\")\n                                }\n                                tt(\"warning\", o) || k(o, \"\", !0)\n                            }\n                        }\n\n                        function m(t, e) {\n                            for (var n = 0; n < e.length - 1; ++n)e[n].push(\"From previous event:\"), e[n] = e[n].join(\"\\n\");\n                            return n < e.length && (e[n] = e[n].join(\"\\n\")), t + \"\\n\" + e.join(\"\\n\")\n                        }\n\n                        function g(t) {\n                            for (var e = 0; e < t.length; ++e)(0 === t[e].length || e + 1 < t.length && t[e][0] === t[e + 1][0]) && (t.splice(e, 1), e--)\n                        }\n\n                        function b(t) {\n                            for (var e = t[0], n = 1; n < t.length; ++n) {\n                                for (var r = t[n], i = e.length - 1, o = e[i], s = -1, a = r.length - 1; a >= 0; --a)if (r[a] === o) {\n                                    s = a;\n                                    break\n                                }\n                                for (var a = s; a >= 0; --a) {\n                                    var c = r[a];\n                                    if (e[i] !== c)break;\n                                    e.pop(), i--\n                                }\n                                e = r\n                            }\n                        }\n\n                        function w(t) {\n                            for (var e = [], n = 0; n < t.length; ++n) {\n                                var r = t[n], i = \"    (No stack trace)\" === r || q.test(r), o = i && nt(r);\n                                i && !o && ($ && \" \" !== r.charAt(0) && (r = \"    \" + r), e.push(r))\n                            }\n                            return e\n                        }\n\n                        function C(t) {\n                            for (var e = t.stack.replace(/\\s+$/g, \"\").split(\"\\n\"), n = 0; n < e.length; ++n) {\n                                var r = e[n];\n                                if (\"    (No stack trace)\" === r || q.test(r))break\n                            }\n                            return n > 0 && (e = e.slice(n)), e\n                        }\n\n                        function j(t) {\n                            var e = t.stack, n = t.toString();\n                            return e = \"string\" == typeof e && e.length > 0 ? C(t) : [\"    (No stack trace)\"], {\n                                message: n,\n                                stack: w(e)\n                            }\n                        }\n\n                        function k(t, e, n) {\n                            if (\"undefined\" != typeof console) {\n                                var r;\n                                if (H.isObject(t)) {\n                                    var i = t.stack;\n                                    r = e + Q(i, t)\n                                } else r = e + String(t);\n                                \"function\" == typeof D ? D(r, n) : (\"function\" == typeof console.log || \"object\" == typeof console.log) && console.log(r)\n                            }\n                        }\n\n                        function E(t, e, n, r) {\n                            var i = !1;\n                            try {\n                                \"function\" == typeof e && (i = !0, \"rejectionHandled\" === t ? e(r) : e(n, r))\n                            } catch (o) {\n                                I.throwLater(o)\n                            }\n                            \"unhandledRejection\" === t ? tt(t, n, r) || i || k(n, \"Unhandled rejection \") : tt(t, r)\n                        }\n\n                        function F(t) {\n                            var e;\n                            if (\"function\" == typeof t)e = \"[function \" + (t.name || \"anonymous\") + \"]\"; else {\n                                e = t && \"function\" == typeof t.toString ? t.toString() : H.toString(t);\n                                var n = /\\[object [a-zA-Z0-9$_]+\\]/;\n                                if (n.test(e))try {\n                                    var r = JSON.stringify(t);\n                                    e = r\n                                } catch (i) {\n                                }\n                                0 === e.length && (e = \"(empty array)\")\n                            }\n                            return \"(<\" + x(e) + \">, no stack trace)\"\n                        }\n\n                        function x(t) {\n                            var e = 41;\n                            return t.length < e ? t : t.substr(0, e - 3) + \"...\"\n                        }\n\n                        function T() {\n                            return \"function\" == typeof it\n                        }\n\n                        function P(t) {\n                            var e = t.match(rt);\n                            return e ? {fileName: e[1], line: parseInt(e[2], 10)} : void 0\n                        }\n\n                        function R(t, e) {\n                            if (T()) {\n                                for (var n, r, i = t.stack.split(\"\\n\"), o = e.stack.split(\"\\n\"), s = -1, a = -1, c = 0; c < i.length; ++c) {\n                                    var l = P(i[c]);\n                                    if (l) {\n                                        n = l.fileName, s = l.line;\n                                        break\n                                    }\n                                }\n                                for (var c = 0; c < o.length; ++c) {\n                                    var l = P(o[c]);\n                                    if (l) {\n                                        r = l.fileName, a = l.line;\n                                        break\n                                    }\n                                }\n                                0 > s || 0 > a || !n || !r || n !== r || s >= a || (nt = function (t) {\n                                    if (B.test(t))return !0;\n                                    var e = P(t);\n                                    return e && e.fileName === n && s <= e.line && e.line <= a ? !0 : !1\n                                })\n                            }\n                        }\n\n                        function S(t) {\n                            this._parent = t, this._promisesCreated = 0;\n                            var e = this._length = 1 + (void 0 === t ? 0 : t._length);\n                            it(this, S), e > 32 && this.uncycle()\n                        }\n\n                        var O, A, D, V = e._getDomain, I = e._async, L = t(\"./errors\").Warning, H = t(\"./util\"), N = H.canAttachTrace, B = /[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/, U = /\\((?:timers\\.js):\\d+:\\d+\\)/, M = /[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/, q = null, Q = null, $ = !1, G = !(0 == H.env(\"BLUEBIRD_DEBUG\") || !H.env(\"BLUEBIRD_DEBUG\") && \"development\" !== H.env(\"NODE_ENV\")), z = !(0 == H.env(\"BLUEBIRD_WARNINGS\") || !G && !H.env(\"BLUEBIRD_WARNINGS\")), X = !(0 == H.env(\"BLUEBIRD_LONG_STACK_TRACES\") || !G && !H.env(\"BLUEBIRD_LONG_STACK_TRACES\")), W = 0 != H.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\") && (z || !!H.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));\n                        e.prototype.suppressUnhandledRejections = function () {\n                            var t = this._target();\n                            t._bitField = -1048577 & t._bitField | 524288\n                        }, e.prototype._ensurePossibleRejectionHandled = function () {\n                            0 === (524288 & this._bitField) && (this._setRejectionIsUnhandled(), I.invokeLater(this._notifyUnhandledRejection, this, void 0))\n                        }, e.prototype._notifyUnhandledRejectionIsHandled = function () {\n                            E(\"rejectionHandled\", O, void 0, this)\n                        }, e.prototype._setReturnedNonUndefined = function () {\n                            this._bitField = 268435456 | this._bitField\n                        }, e.prototype._returnedNonUndefined = function () {\n                            return 0 !== (268435456 & this._bitField)\n                        }, e.prototype._notifyUnhandledRejection = function () {\n                            if (this._isRejectionUnhandled()) {\n                                var t = this._settledValue();\n                                this._setUnhandledRejectionIsNotified(), E(\"unhandledRejection\", A, t, this)\n                            }\n                        }, e.prototype._setUnhandledRejectionIsNotified = function () {\n                            this._bitField = 262144 | this._bitField\n                        }, e.prototype._unsetUnhandledRejectionIsNotified = function () {\n                            this._bitField = -262145 & this._bitField\n                        }, e.prototype._isUnhandledRejectionNotified = function () {\n                            return (262144 & this._bitField) > 0\n                        }, e.prototype._setRejectionIsUnhandled = function () {\n                            this._bitField = 1048576 | this._bitField\n                        }, e.prototype._unsetRejectionIsUnhandled = function () {\n                            this._bitField = -1048577 & this._bitField, this._isUnhandledRejectionNotified() && (this._unsetUnhandledRejectionIsNotified(), this._notifyUnhandledRejectionIsHandled())\n                        }, e.prototype._isRejectionUnhandled = function () {\n                            return (1048576 & this._bitField) > 0\n                        }, e.prototype._warn = function (t, e, n) {\n                            return y(t, e, n || this)\n                        }, e.onPossiblyUnhandledRejection = function (t) {\n                            var e = V();\n                            A = \"function\" == typeof t ? null === e ? t : H.domainBind(e, t) : void 0\n                        }, e.onUnhandledRejectionHandled = function (t) {\n                            var e = V();\n                            O = \"function\" == typeof t ? null === e ? t : H.domainBind(e, t) : void 0\n                        };\n                        var K = function () {\n                        };\n                        e.longStackTraces = function () {\n                            if (I.haveItemsQueued() && !ot.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            if (!ot.longStackTraces && T()) {\n                                var t = e.prototype._captureStackTrace, r = e.prototype._attachExtraTrace;\n                                ot.longStackTraces = !0, K = function () {\n                                    if (I.haveItemsQueued() && !ot.longStackTraces)throw new Error(\"cannot enable long stack traces after promises have been created\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                                    e.prototype._captureStackTrace = t, e.prototype._attachExtraTrace = r, n.deactivateLongStackTraces(), I.enableTrampoline(), ot.longStackTraces = !1\n                                }, e.prototype._captureStackTrace = f, e.prototype._attachExtraTrace = _, n.activateLongStackTraces(), I.disableTrampolineIfNecessary()\n                            }\n                        }, e.hasLongStackTraces = function () {\n                            return ot.longStackTraces && T()\n                        };\n                        var J = function () {\n                            try {\n                                if (\"function\" == typeof CustomEvent) {\n                                    var t = new CustomEvent(\"CustomEvent\");\n                                    return H.global.dispatchEvent(t), function (t, e) {\n                                        var n = new CustomEvent(t.toLowerCase(), {detail: e, cancelable: !0});\n                                        return !H.global.dispatchEvent(n)\n                                    }\n                                }\n                                if (\"function\" == typeof Event) {\n                                    var t = new Event(\"CustomEvent\");\n                                    return H.global.dispatchEvent(t), function (t, e) {\n                                        var n = new Event(t.toLowerCase(), {cancelable: !0});\n                                        return n.detail = e, !H.global.dispatchEvent(n)\n                                    }\n                                }\n                                var t = document.createEvent(\"CustomEvent\");\n                                return t.initCustomEvent(\"testingtheevent\", !1, !0, {}), H.global.dispatchEvent(t), function (t, e) {\n                                    var n = document.createEvent(\"CustomEvent\");\n                                    return n.initCustomEvent(t.toLowerCase(), !1, !0, e), !H.global.dispatchEvent(n)\n                                }\n                            } catch (e) {\n                            }\n                            return function () {\n                                return !1\n                            }\n                        }(), Y = function () {\n                            return H.isNode ? function () {\n                                return process.emit.apply(process, arguments)\n                            } : H.global ? function (t) {\n                                var e = \"on\" + t.toLowerCase(), n = H.global[e];\n                                return n ? (n.apply(H.global, [].slice.call(arguments, 1)), !0) : !1\n                            } : function () {\n                                return !1\n                            }\n                        }(), Z = {\n                            promiseCreated: r,\n                            promiseFulfilled: r,\n                            promiseRejected: r,\n                            promiseResolved: r,\n                            promiseCancelled: r,\n                            promiseChained: function (t, e, n) {\n                                return {promise: e, child: n}\n                            },\n                            warning: function (t, e) {\n                                return {warning: e}\n                            },\n                            unhandledRejection: function (t, e, n) {\n                                return {reason: e, promise: n}\n                            },\n                            rejectionHandled: r\n                        }, tt = function (t) {\n                            var e = !1;\n                            try {\n                                e = Y.apply(null, arguments)\n                            } catch (n) {\n                                I.throwLater(n), e = !0\n                            }\n                            var r = !1;\n                            try {\n                                r = J(t, Z[t].apply(null, arguments))\n                            } catch (n) {\n                                I.throwLater(n), r = !0\n                            }\n                            return r || e\n                        };\n                        e.config = function (t) {\n                            if (t = Object(t), \"longStackTraces\" in t && (t.longStackTraces ? e.longStackTraces() : !t.longStackTraces && e.hasLongStackTraces() && K()), \"warnings\" in t) {\n                                var n = t.warnings;\n                                ot.warnings = !!n, W = ot.warnings, H.isObject(n) && \"wForgottenReturn\" in n && (W = !!n.wForgottenReturn)\n                            }\n                            if (\"cancellation\" in t && t.cancellation && !ot.cancellation) {\n                                if (I.haveItemsQueued())throw new Error(\"cannot enable cancellation after promises are in use\");\n                                e.prototype._clearCancellationData = l, e.prototype._propagateFrom = u, e.prototype._onCancel = a, e.prototype._setOnCancel = c, e.prototype._attachCancellationCallback = s, e.prototype._execute = o, et = u, ot.cancellation = !0\n                            }\n                            \"monitoring\" in t && (t.monitoring && !ot.monitoring ? (ot.monitoring = !0, e.prototype._fireEvent = tt) : !t.monitoring && ot.monitoring && (ot.monitoring = !1, e.prototype._fireEvent = i))\n                        }, e.prototype._fireEvent = i, e.prototype._execute = function (t, e, n) {\n                            try {\n                                t(e, n)\n                            } catch (r) {\n                                return r\n                            }\n                        }, e.prototype._onCancel = function () {\n                        }, e.prototype._setOnCancel = function (t) {\n                        }, e.prototype._attachCancellationCallback = function (t) {\n                        }, e.prototype._captureStackTrace = function () {\n                        }, e.prototype._attachExtraTrace = function () {\n                        }, e.prototype._clearCancellationData = function () {\n                        }, e.prototype._propagateFrom = function (t, e) {\n                        };\n                        var et = p, nt = function () {\n                            return !1\n                        }, rt = /[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;\n                        H.inherits(S, Error), n.CapturedTrace = S, S.prototype.uncycle = function () {\n                            var t = this._length;\n                            if (!(2 > t)) {\n                                for (var e = [], n = {}, r = 0, i = this; void 0 !== i; ++r)e.push(i), i = i._parent;\n                                t = this._length = r;\n                                for (var r = t - 1; r >= 0; --r) {\n                                    var o = e[r].stack;\n                                    void 0 === n[o] && (n[o] = r)\n                                }\n                                for (var r = 0; t > r; ++r) {\n                                    var s = e[r].stack, a = n[s];\n                                    if (void 0 !== a && a !== r) {\n                                        a > 0 && (e[a - 1]._parent = void 0, e[a - 1]._length = 1), e[r]._parent = void 0, e[r]._length = 1;\n                                        var c = r > 0 ? e[r - 1] : this;\n                                        t - 1 > a ? (c._parent = e[a + 1], c._parent.uncycle(), c._length = c._parent._length + 1) : (c._parent = void 0, c._length = 1);\n                                        for (var l = c._length + 1, u = r - 2; u >= 0; --u)e[u]._length = l, l++;\n                                        return\n                                    }\n                                }\n                            }\n                        }, S.prototype.attachExtraTrace = function (t) {\n                            if (!t.__stackCleaned__) {\n                                this.uncycle();\n                                for (var e = j(t), n = e.message, r = [e.stack], i = this; void 0 !== i;)r.push(w(i.stack.split(\"\\n\"))), i = i._parent;\n                                b(r), g(r), H.notEnumerableProp(t, \"stack\", m(n, r)), H.notEnumerableProp(t, \"__stackCleaned__\", !0)\n                            }\n                        };\n                        var it = function () {\n                            var t = /^\\s*at\\s*!/, e = function (t, e) {\n                                return \"string\" == typeof t ? t : void 0 !== e.name && void 0 !== e.message ? e.toString() : F(e)\n                            };\n                            if (\"number\" == typeof Error.stackTraceLimit && \"function\" == typeof Error.captureStackTrace) {\n                                Error.stackTraceLimit += 6, q = t, Q = e;\n                                var n = Error.captureStackTrace;\n                                return nt = function (t) {\n                                    return B.test(t)\n                                }, function (t, e) {\n                                    Error.stackTraceLimit += 6, n(t, e), Error.stackTraceLimit -= 6\n                                }\n                            }\n                            var r = new Error;\n                            if (\"string\" == typeof r.stack && r.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\") >= 0)return q = /@/, Q = e, $ = !0, function (t) {\n                                t.stack = (new Error).stack\n                            };\n                            var i;\n                            try {\n                                throw new Error\n                            } catch (o) {\n                                i = \"stack\" in o\n                            }\n                            return \"stack\" in r || !i || \"number\" != typeof Error.stackTraceLimit ? (Q = function (t, e) {\n                                return \"string\" == typeof t ? t : \"object\" != typeof e && \"function\" != typeof e || void 0 === e.name || void 0 === e.message ? F(e) : e.toString()\n                            }, null) : (q = t, Q = e, function (t) {\n                                Error.stackTraceLimit += 6;\n                                try {\n                                    throw new Error\n                                } catch (e) {\n                                    t.stack = e.stack\n                                }\n                                Error.stackTraceLimit -= 6\n                            })\n                        }([]);\n                        \"undefined\" != typeof console && \"undefined\" != typeof console.warn && (D = function (t) {\n                            console.warn(t)\n                        }, H.isNode && process.stderr.isTTY ? D = function (t, e) {\n                            var n = e ? \"\u001b[33m\" : \"\u001b[31m\";\n                            console.warn(n + t + \"\u001b[0m\\n\")\n                        } : H.isNode || \"string\" != typeof(new Error).stack || (D = function (t, e) {\n                            console.warn(\"%c\" + t, e ? \"color: darkorange\" : \"color: red\")\n                        }));\n                        var ot = {warnings: z, longStackTraces: !1, cancellation: !1, monitoring: !1};\n                        return X && e.longStackTraces(), {\n                            longStackTraces: function () {\n                                return ot.longStackTraces\n                            },\n                            warnings: function () {\n                                return ot.warnings\n                            },\n                            cancellation: function () {\n                                return ot.cancellation\n                            },\n                            monitoring: function () {\n                                return ot.monitoring\n                            },\n                            propagateFromFunction: function () {\n                                return et\n                            },\n                            boundValueFunction: function () {\n                                return h\n                            },\n                            checkForgottenReturns: d,\n                            setBounds: R,\n                            warn: y,\n                            deprecated: v,\n                            CapturedTrace: S,\n                            fireDomEvent: J,\n                            fireGlobalEvent: Y\n                        }\n                    }\n                }, {\"./errors\": 12, \"./util\": 36}], 10: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t) {\n                        function e() {\n                            return this.value\n                        }\n\n                        function n() {\n                            throw this.reason\n                        }\n\n                        t.prototype[\"return\"] = t.prototype.thenReturn = function (n) {\n                            return n instanceof t && n.suppressUnhandledRejections(), this._then(e, void 0, void 0, {value: n}, void 0)\n                        }, t.prototype[\"throw\"] = t.prototype.thenThrow = function (t) {\n                            return this._then(n, void 0, void 0, {reason: t}, void 0)\n                        }, t.prototype.catchThrow = function (t) {\n                            if (arguments.length <= 1)return this._then(void 0, n, void 0, {reason: t}, void 0);\n                            var e = arguments[1], r = function () {\n                                throw e\n                            };\n                            return this.caught(t, r)\n                        }, t.prototype.catchReturn = function (n) {\n                            if (arguments.length <= 1)return n instanceof t && n.suppressUnhandledRejections(), this._then(void 0, e, void 0, {value: n}, void 0);\n                            var r = arguments[1];\n                            r instanceof t && r.suppressUnhandledRejections();\n                            var i = function () {\n                                return r\n                            };\n                            return this.caught(n, i)\n                        }\n                    }\n                }, {}], 11: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t, e) {\n                        function n() {\n                            return o(this)\n                        }\n\n                        function r(t, n) {\n                            return i(t, n, e, e)\n                        }\n\n                        var i = t.reduce, o = t.all;\n                        t.prototype.each = function (t) {\n                            return i(this, t, e, 0)._then(n, void 0, void 0, this, void 0)\n                        }, t.prototype.mapSeries = function (t) {\n                            return i(this, t, e, e)\n                        }, t.each = function (t, r) {\n                            return i(t, r, e, 0)._then(n, void 0, void 0, t, void 0)\n                        }, t.mapSeries = r\n                    }\n                }, {}], 12: [function (t, e, n) {\n                    \"use strict\";\n                    function r(t, e) {\n                        function n(r) {\n                            return this instanceof n ? (p(this, \"message\", \"string\" == typeof r ? r : e), p(this, \"name\", t), void(Error.captureStackTrace ? Error.captureStackTrace(this, this.constructor) : Error.call(this))) : new n(r)\n                        }\n\n                        return u(n, Error), n\n                    }\n\n                    function i(t) {\n                        return this instanceof i ? (p(this, \"name\", \"OperationalError\"), p(this, \"message\", t), this.cause = t, this.isOperational = !0, void(t instanceof Error ? (p(this, \"message\", t.message), p(this, \"stack\", t.stack)) : Error.captureStackTrace && Error.captureStackTrace(this, this.constructor))) : new i(t)\n                    }\n\n                    var o, s, a = t(\"./es5\"), c = a.freeze, l = t(\"./util\"), u = l.inherits, p = l.notEnumerableProp, h = r(\"Warning\", \"warning\"), f = r(\"CancellationError\", \"cancellation error\"), _ = r(\"TimeoutError\", \"timeout error\"), d = r(\"AggregateError\", \"aggregate error\");\n                    try {\n                        o = TypeError, s = RangeError\n                    } catch (v) {\n                        o = r(\"TypeError\", \"type error\"), s = r(\"RangeError\", \"range error\")\n                    }\n                    for (var y = \"join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse\".split(\" \"), m = 0; m < y.length; ++m)\"function\" == typeof Array.prototype[y[m]] && (d.prototype[y[m]] = Array.prototype[y[m]]);\n                    a.defineProperty(d.prototype, \"length\", {\n                        value: 0,\n                        configurable: !1,\n                        writable: !0,\n                        enumerable: !0\n                    }), d.prototype.isOperational = !0;\n                    var g = 0;\n                    d.prototype.toString = function () {\n                        var t = Array(4 * g + 1).join(\" \"), e = \"\\n\" + t + \"AggregateError of:\\n\";\n                        g++, t = Array(4 * g + 1).join(\" \");\n                        for (var n = 0; n < this.length; ++n) {\n                            for (var r = this[n] === this ? \"[Circular AggregateError]\" : this[n] + \"\", i = r.split(\"\\n\"), o = 0; o < i.length; ++o)i[o] = t + i[o];\n                            r = i.join(\"\\n\"), e += r + \"\\n\"\n                        }\n                        return g--, e\n                    }, u(i, Error);\n                    var b = Error.__BluebirdErrorTypes__;\n                    b || (b = c({\n                        CancellationError: f,\n                        TimeoutError: _,\n                        OperationalError: i,\n                        RejectionError: i,\n                        AggregateError: d\n                    }), a.defineProperty(Error, \"__BluebirdErrorTypes__\", {\n                        value: b,\n                        writable: !1,\n                        enumerable: !1,\n                        configurable: !1\n                    })), e.exports = {\n                        Error: Error,\n                        TypeError: o,\n                        RangeError: s,\n                        CancellationError: b.CancellationError,\n                        OperationalError: b.OperationalError,\n                        TimeoutError: b.TimeoutError,\n                        AggregateError: b.AggregateError,\n                        Warning: h\n                    }\n                }, {\"./es5\": 13, \"./util\": 36}], 13: [function (t, e, n) {\n                    var r = function () {\n                        \"use strict\";\n                        return void 0 === this\n                    }();\n                    if (r)e.exports = {\n                        freeze: Object.freeze,\n                        defineProperty: Object.defineProperty,\n                        getDescriptor: Object.getOwnPropertyDescriptor,\n                        keys: Object.keys,\n                        names: Object.getOwnPropertyNames,\n                        getPrototypeOf: Object.getPrototypeOf,\n                        isArray: Array.isArray,\n                        isES5: r,\n                        propertyIsWritable: function (t, e) {\n                            var n = Object.getOwnPropertyDescriptor(t, e);\n                            return !(n && !n.writable && !n.set)\n                        }\n                    }; else {\n                        var i = {}.hasOwnProperty, o = {}.toString, s = {}.constructor.prototype, a = function (t) {\n                            var e = [];\n                            for (var n in t)i.call(t, n) && e.push(n);\n                            return e\n                        }, c = function (t, e) {\n                            return {value: t[e]}\n                        }, l = function (t, e, n) {\n                            return t[e] = n.value, t\n                        }, u = function (t) {\n                            return t\n                        }, p = function (t) {\n                            try {\n                                return Object(t).constructor.prototype\n                            } catch (e) {\n                                return s\n                            }\n                        }, h = function (t) {\n                            try {\n                                return \"[object Array]\" === o.call(t)\n                            } catch (e) {\n                                return !1\n                            }\n                        };\n                        e.exports = {\n                            isArray: h,\n                            keys: a,\n                            names: a,\n                            defineProperty: l,\n                            getDescriptor: c,\n                            freeze: u,\n                            getPrototypeOf: p,\n                            isES5: r,\n                            propertyIsWritable: function () {\n                                return !0\n                            }\n                        }\n                    }\n                }, {}], 14: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t, e) {\n                        var n = t.map;\n                        t.prototype.filter = function (t, r) {\n                            return n(this, t, r, e)\n                        }, t.filter = function (t, r, i) {\n                            return n(t, r, i, e)\n                        }\n                    }\n                }, {}], 15: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n) {\n                        function r(t, e, n) {\n                            this.promise = t, this.type = e, this.handler = n, this.called = !1, this.cancelPromise = null\n                        }\n\n                        function i(t) {\n                            this.finallyHandler = t\n                        }\n\n                        function o(t, e) {\n                            return null != t.cancelPromise ? (arguments.length > 1 ? t.cancelPromise._reject(e) : t.cancelPromise._cancel(), t.cancelPromise = null, !0) : !1\n                        }\n\n                        function s() {\n                            return c.call(this, this.promise._target()._settledValue())\n                        }\n\n                        function a(t) {\n                            return o(this, t) ? void 0 : (p.e = t, p)\n                        }\n\n                        function c(t) {\n                            var r = this.promise, c = this.handler;\n                            if (!this.called) {\n                                this.called = !0;\n                                var l = this.isFinallyHandler() ? c.call(r._boundValue()) : c.call(r._boundValue(), t);\n                                if (void 0 !== l) {\n                                    r._setReturnedNonUndefined();\n                                    var h = n(l, r);\n                                    if (h instanceof e) {\n                                        if (null != this.cancelPromise) {\n                                            if (h._isCancelled()) {\n                                                var f = new u(\"late cancellation observer\");\n                                                return r._attachExtraTrace(f), p.e = f, p\n                                            }\n                                            h.isPending() && h._attachCancellationCallback(new i(this))\n                                        }\n                                        return h._then(s, a, void 0, this, void 0)\n                                    }\n                                }\n                            }\n                            return r.isRejected() ? (o(this), p.e = t, p) : (o(this), t)\n                        }\n\n                        var l = t(\"./util\"), u = e.CancellationError, p = l.errorObj;\n                        return r.prototype.isFinallyHandler = function () {\n                            return 0 === this.type\n                        }, i.prototype._resultCancelled = function () {\n                            o(this.finallyHandler)\n                        }, e.prototype._passThrough = function (t, e, n, i) {\n                            return \"function\" != typeof t ? this.then() : this._then(n, i, void 0, new r(this, e, t), void 0)\n                        }, e.prototype.lastly = e.prototype[\"finally\"] = function (t) {\n                            return this._passThrough(t, 0, c, c)\n                        }, e.prototype.tap = function (t) {\n                            return this._passThrough(t, 1, c)\n                        }, r\n                    }\n                }, {\"./util\": 36}], 16: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o, s) {\n                        function a(t, n, r) {\n                            for (var o = 0; o < n.length; ++o) {\n                                r._pushContext();\n                                var s = f(n[o])(t);\n                                if (r._popContext(), s === h) {\n                                    r._pushContext();\n                                    var a = e.reject(h.e);\n                                    return r._popContext(), a\n                                }\n                                var c = i(s, r);\n                                if (c instanceof e)return c\n                            }\n                            return null\n                        }\n\n                        function c(t, n, i, o) {\n                            if (s.cancellation()) {\n                                var a = new e(r), c = this._finallyPromise = new e(r);\n                                this._promise = a.lastly(function () {\n                                    return c\n                                }), a._captureStackTrace(), a._setOnCancel(this)\n                            } else {\n                                var l = this._promise = new e(r);\n                                l._captureStackTrace()\n                            }\n                            this._stack = o, this._generatorFunction = t, this._receiver = n, this._generator = void 0, this._yieldHandlers = \"function\" == typeof i ? [i].concat(_) : _, this._yieldedPromise = null, this._cancellationPhase = !1\n                        }\n\n                        var l = t(\"./errors\"), u = l.TypeError, p = t(\"./util\"), h = p.errorObj, f = p.tryCatch, _ = [];\n                        p.inherits(c, o), c.prototype._isResolved = function () {\n                            return null === this._promise\n                        }, c.prototype._cleanup = function () {\n                            this._promise = this._generator = null, s.cancellation() && null !== this._finallyPromise && (this._finallyPromise._fulfill(), this._finallyPromise = null)\n                        }, c.prototype._promiseCancelled = function () {\n                            if (!this._isResolved()) {\n                                var t, n = \"undefined\" != typeof this._generator[\"return\"];\n                                if (n)this._promise._pushContext(), t = f(this._generator[\"return\"]).call(this._generator, void 0), this._promise._popContext(); else {\n                                    var r = new e.CancellationError(\"generator .return() sentinel\");\n                                    e.coroutine.returnSentinel = r, this._promise._attachExtraTrace(r), this._promise._pushContext(), t = f(this._generator[\"throw\"]).call(this._generator, r), this._promise._popContext()\n                                }\n                                this._cancellationPhase = !0, this._yieldedPromise = null, this._continue(t)\n                            }\n                        }, c.prototype._promiseFulfilled = function (t) {\n                            this._yieldedPromise = null, this._promise._pushContext();\n                            var e = f(this._generator.next).call(this._generator, t);\n                            this._promise._popContext(), this._continue(e)\n                        }, c.prototype._promiseRejected = function (t) {\n                            this._yieldedPromise = null, this._promise._attachExtraTrace(t), this._promise._pushContext();\n                            var e = f(this._generator[\"throw\"]).call(this._generator, t);\n                            this._promise._popContext(), this._continue(e)\n                        }, c.prototype._resultCancelled = function () {\n                            if (this._yieldedPromise instanceof e) {\n                                var t = this._yieldedPromise;\n                                this._yieldedPromise = null, t.cancel()\n                            }\n                        }, c.prototype.promise = function () {\n                            return this._promise\n                        }, c.prototype._run = function () {\n                            this._generator = this._generatorFunction.call(this._receiver), this._receiver = this._generatorFunction = void 0, this._promiseFulfilled(void 0)\n                        }, c.prototype._continue = function (t) {\n                            var n = this._promise;\n                            if (t === h)return this._cleanup(), this._cancellationPhase ? n.cancel() : n._rejectCallback(t.e, !1);\n                            var r = t.value;\n                            if (t.done === !0)return this._cleanup(), this._cancellationPhase ? n.cancel() : n._resolveCallback(r);\n                            var o = i(r, this._promise);\n                            if (!(o instanceof e) && (o = a(o, this._yieldHandlers, this._promise), null === o))return void this._promiseRejected(new u(\"A value %s was yielded that could not be treated as a promise\\n\\n    See http://goo.gl/MqrFmX\\n\\n\".replace(\"%s\", r) + \"From coroutine:\\n\" + this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")));\n                            o = o._target();\n                            var s = o._bitField;\n                            0 === (50397184 & s) ? (this._yieldedPromise = o, o._proxy(this, null)) : 0 !== (33554432 & s) ? e._async.invoke(this._promiseFulfilled, this, o._value()) : 0 !== (16777216 & s) ? e._async.invoke(this._promiseRejected, this, o._reason()) : this._promiseCancelled()\n                        }, e.coroutine = function (t, e) {\n                            if (\"function\" != typeof t)throw new u(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            var n = Object(e).yieldHandler, r = c, i = (new Error).stack;\n                            return function () {\n                                var e = t.apply(this, arguments), o = new r(void 0, void 0, n, i), s = o.promise();\n                                return o._generator = e,\n                                    o._promiseFulfilled(void 0), s\n                            }\n                        }, e.coroutine.addYieldHandler = function (t) {\n                            if (\"function\" != typeof t)throw new u(\"expecting a function but got \" + p.classString(t));\n                            _.push(t)\n                        }, e.spawn = function (t) {\n                            if (s.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\"), \"function\" != typeof t)return n(\"generatorFunction must be a function\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            var r = new c(t, this), i = r.promise();\n                            return r._run(e.spawn), i\n                        }\n                    }\n                }, {\"./errors\": 12, \"./util\": 36}], 17: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o, s) {\n                        var a = t(\"./util\");\n                        a.canEvaluate, a.tryCatch, a.errorObj;\n                        e.join = function () {\n                            var t, e = arguments.length - 1;\n                            if (e > 0 && \"function\" == typeof arguments[e]) {\n                                t = arguments[e];\n                                var r\n                            }\n                            var i = [].slice.call(arguments);\n                            t && i.pop();\n                            var r = new n(i).promise();\n                            return void 0 !== t ? r.spread(t) : r\n                        }\n                    }\n                }, {\"./util\": 36}], 18: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o, s) {\n                        function a(t, e, n, r) {\n                            this.constructor$(t), this._promise._captureStackTrace();\n                            var i = l();\n                            this._callback = null === i ? e : u.domainBind(i, e), this._preservedValues = r === o ? new Array(this.length()) : null, this._limit = n, this._inFlight = 0, this._queue = [], f.invoke(this._asyncInit, this, void 0)\n                        }\n\n                        function c(t, n, i, o) {\n                            if (\"function\" != typeof n)return r(\"expecting a function but got \" + u.classString(n));\n                            var s = 0;\n                            if (void 0 !== i) {\n                                if (\"object\" != typeof i || null === i)return e.reject(new TypeError(\"options argument must be an object but it is \" + u.classString(i)));\n                                if (\"number\" != typeof i.concurrency)return e.reject(new TypeError(\"'concurrency' must be a number but it is \" + u.classString(i.concurrency)));\n                                s = i.concurrency\n                            }\n                            return s = \"number\" == typeof s && isFinite(s) && s >= 1 ? s : 0, new a(t, n, s, o).promise()\n                        }\n\n                        var l = e._getDomain, u = t(\"./util\"), p = u.tryCatch, h = u.errorObj, f = e._async;\n                        u.inherits(a, n), a.prototype._asyncInit = function () {\n                            this._init$(void 0, -2)\n                        }, a.prototype._init = function () {\n                        }, a.prototype._promiseFulfilled = function (t, n) {\n                            var r = this._values, o = this.length(), a = this._preservedValues, c = this._limit;\n                            if (0 > n) {\n                                if (n = -1 * n - 1, r[n] = t, c >= 1 && (this._inFlight--, this._drainQueue(), this._isResolved()))return !0\n                            } else {\n                                if (c >= 1 && this._inFlight >= c)return r[n] = t, this._queue.push(n), !1;\n                                null !== a && (a[n] = t);\n                                var l = this._promise, u = this._callback, f = l._boundValue();\n                                l._pushContext();\n                                var _ = p(u).call(f, t, n, o), d = l._popContext();\n                                if (s.checkForgottenReturns(_, d, null !== a ? \"Promise.filter\" : \"Promise.map\", l), _ === h)return this._reject(_.e), !0;\n                                var v = i(_, this._promise);\n                                if (v instanceof e) {\n                                    v = v._target();\n                                    var y = v._bitField;\n                                    if (0 === (50397184 & y))return c >= 1 && this._inFlight++, r[n] = v, v._proxy(this, -1 * (n + 1)), !1;\n                                    if (0 === (33554432 & y))return 0 !== (16777216 & y) ? (this._reject(v._reason()), !0) : (this._cancel(), !0);\n                                    _ = v._value()\n                                }\n                                r[n] = _\n                            }\n                            var m = ++this._totalResolved;\n                            return m >= o ? (null !== a ? this._filter(r, a) : this._resolve(r), !0) : !1\n                        }, a.prototype._drainQueue = function () {\n                            for (var t = this._queue, e = this._limit, n = this._values; t.length > 0 && this._inFlight < e;) {\n                                if (this._isResolved())return;\n                                var r = t.pop();\n                                this._promiseFulfilled(n[r], r)\n                            }\n                        }, a.prototype._filter = function (t, e) {\n                            for (var n = e.length, r = new Array(n), i = 0, o = 0; n > o; ++o)t[o] && (r[i++] = e[o]);\n                            r.length = i, this._resolve(r)\n                        }, a.prototype.preservedValues = function () {\n                            return this._preservedValues\n                        }, e.prototype.map = function (t, e) {\n                            return c(this, t, e, null)\n                        }, e.map = function (t, e, n, r) {\n                            return c(t, e, n, r)\n                        }\n                    }\n                }, {\"./util\": 36}], 19: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o) {\n                        var s = t(\"./util\"), a = s.tryCatch;\n                        e.method = function (t) {\n                            if (\"function\" != typeof t)throw new e.TypeError(\"expecting a function but got \" + s.classString(t));\n                            return function () {\n                                var r = new e(n);\n                                r._captureStackTrace(), r._pushContext();\n                                var i = a(t).apply(this, arguments), s = r._popContext();\n                                return o.checkForgottenReturns(i, s, \"Promise.method\", r), r._resolveFromSyncValue(i), r\n                            }\n                        }, e.attempt = e[\"try\"] = function (t) {\n                            if (\"function\" != typeof t)return i(\"expecting a function but got \" + s.classString(t));\n                            var r = new e(n);\n                            r._captureStackTrace(), r._pushContext();\n                            var c;\n                            if (arguments.length > 1) {\n                                o.deprecated(\"calling Promise.try with more than 1 argument\");\n                                var l = arguments[1], u = arguments[2];\n                                c = s.isArray(l) ? a(t).apply(u, l) : a(t).call(u, l)\n                            } else c = a(t)();\n                            var p = r._popContext();\n                            return o.checkForgottenReturns(c, p, \"Promise.try\", r), r._resolveFromSyncValue(c), r\n                        }, e.prototype._resolveFromSyncValue = function (t) {\n                            t === s.errorObj ? this._rejectCallback(t.e, !1) : this._resolveCallback(t, !0)\n                        }\n                    }\n                }, {\"./util\": 36}], 20: [function (t, e, n) {\n                    \"use strict\";\n                    function r(t) {\n                        return t instanceof Error && u.getPrototypeOf(t) === Error.prototype\n                    }\n\n                    function i(t) {\n                        var e;\n                        if (r(t)) {\n                            e = new l(t), e.name = t.name, e.message = t.message, e.stack = t.stack;\n                            for (var n = u.keys(t), i = 0; i < n.length; ++i) {\n                                var o = n[i];\n                                p.test(o) || (e[o] = t[o])\n                            }\n                            return e\n                        }\n                        return s.markAsOriginatingFromRejection(t), t\n                    }\n\n                    function o(t, e) {\n                        return function (n, r) {\n                            if (null !== t) {\n                                if (n) {\n                                    var o = i(a(n));\n                                    t._attachExtraTrace(o), t._reject(o)\n                                } else if (e) {\n                                    var s = [].slice.call(arguments, 1);\n                                    t._fulfill(s)\n                                } else t._fulfill(r);\n                                t = null\n                            }\n                        }\n                    }\n\n                    var s = t(\"./util\"), a = s.maybeWrapAsError, c = t(\"./errors\"), l = c.OperationalError, u = t(\"./es5\"), p = /^(?:name|message|stack|cause)$/;\n                    e.exports = o\n                }, {\"./errors\": 12, \"./es5\": 13, \"./util\": 36}], 21: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e) {\n                        function n(t, e) {\n                            var n = this;\n                            if (!o.isArray(t))return r.call(n, t, e);\n                            var i = a(e).apply(n._boundValue(), [null].concat(t));\n                            i === c && s.throwLater(i.e)\n                        }\n\n                        function r(t, e) {\n                            var n = this, r = n._boundValue(), i = void 0 === t ? a(e).call(r, null) : a(e).call(r, null, t);\n                            i === c && s.throwLater(i.e)\n                        }\n\n                        function i(t, e) {\n                            var n = this;\n                            if (!t) {\n                                var r = new Error(t + \"\");\n                                r.cause = t, t = r\n                            }\n                            var i = a(e).call(n._boundValue(), t);\n                            i === c && s.throwLater(i.e)\n                        }\n\n                        var o = t(\"./util\"), s = e._async, a = o.tryCatch, c = o.errorObj;\n                        e.prototype.asCallback = e.prototype.nodeify = function (t, e) {\n                            if (\"function\" == typeof t) {\n                                var o = r;\n                                void 0 !== e && Object(e).spread && (o = n), this._then(o, i, void 0, this, t)\n                            }\n                            return this\n                        }\n                    }\n                }, {\"./util\": 36}], 22: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function () {\n                        function n() {\n                        }\n\n                        function r(t, e) {\n                            if (\"function\" != typeof e)throw new m(\"expecting a function but got \" + f.classString(e));\n                            if (t.constructor !== i)throw new m(\"the promise constructor cannot be invoked directly\\n\\n    See http://goo.gl/MqrFmX\\n\")\n                        }\n\n                        function i(t) {\n                            this._bitField = 0, this._fulfillmentHandler0 = void 0, this._rejectionHandler0 = void 0, this._promise0 = void 0, this._receiver0 = void 0, t !== b && (r(this, t), this._resolveFromExecutor(t)), this._promiseCreated(), this._fireEvent(\"promiseCreated\", this)\n                        }\n\n                        function o(t) {\n                            this.promise._resolveCallback(t)\n                        }\n\n                        function s(t) {\n                            this.promise._rejectCallback(t, !1)\n                        }\n\n                        function a(t) {\n                            var e = new i(b);\n                            e._fulfillmentHandler0 = t, e._rejectionHandler0 = t, e._promise0 = t, e._receiver0 = t\n                        }\n\n                        var c, l = function () {\n                            return new m(\"circular promise resolution chain\\n\\n    See http://goo.gl/MqrFmX\\n\")\n                        }, u = function () {\n                            return new i.PromiseInspection(this._target())\n                        }, p = function (t) {\n                            return i.reject(new m(t))\n                        }, h = {}, f = t(\"./util\");\n                        c = f.isNode ? function () {\n                            var t = process.domain;\n                            return void 0 === t && (t = null), t\n                        } : function () {\n                            return null\n                        }, f.notEnumerableProp(i, \"_getDomain\", c);\n                        var _ = t(\"./es5\"), d = t(\"./async\"), v = new d;\n                        _.defineProperty(i, \"_async\", {value: v});\n                        var y = t(\"./errors\"), m = i.TypeError = y.TypeError;\n                        i.RangeError = y.RangeError;\n                        var g = i.CancellationError = y.CancellationError;\n                        i.TimeoutError = y.TimeoutError, i.OperationalError = y.OperationalError, i.RejectionError = y.OperationalError, i.AggregateError = y.AggregateError;\n                        var b = function () {\n                        }, w = {}, C = {}, j = t(\"./thenables\")(i, b), k = t(\"./promise_array\")(i, b, j, p, n), E = t(\"./context\")(i), F = E.create, x = t(\"./debuggability\")(i, E), T = (x.CapturedTrace, t(\"./finally\")(i, j)), P = t(\"./catch_filter\")(C), R = t(\"./nodeback\"), S = f.errorObj, O = f.tryCatch;\n                        return i.prototype.toString = function () {\n                            return \"[object Promise]\"\n                        }, i.prototype.caught = i.prototype[\"catch\"] = function (t) {\n                            var e = arguments.length;\n                            if (e > 1) {\n                                var n, r = new Array(e - 1), i = 0;\n                                for (n = 0; e - 1 > n; ++n) {\n                                    var o = arguments[n];\n                                    if (!f.isObject(o))return p(\"expecting an object but got A catch statement predicate \" + f.classString(o));\n                                    r[i++] = o\n                                }\n                                return r.length = i, t = arguments[n], this.then(void 0, P(r, t, this))\n                            }\n                            return this.then(void 0, t)\n                        }, i.prototype.reflect = function () {\n                            return this._then(u, u, void 0, this, void 0)\n                        }, i.prototype.then = function (t, e) {\n                            if (x.warnings() && arguments.length > 0 && \"function\" != typeof t && \"function\" != typeof e) {\n                                var n = \".then() only accepts functions but was passed: \" + f.classString(t);\n                                arguments.length > 1 && (n += \", \" + f.classString(e)), this._warn(n)\n                            }\n                            return this._then(t, e, void 0, void 0, void 0)\n                        }, i.prototype.done = function (t, e) {\n                            var n = this._then(t, e, void 0, void 0, void 0);\n                            n._setIsFinal()\n                        }, i.prototype.spread = function (t) {\n                            return \"function\" != typeof t ? p(\"expecting a function but got \" + f.classString(t)) : this.all()._then(t, void 0, void 0, w, void 0)\n                        }, i.prototype.toJSON = function () {\n                            var t = {\n                                isFulfilled: !1,\n                                isRejected: !1,\n                                fulfillmentValue: void 0,\n                                rejectionReason: void 0\n                            };\n                            return this.isFulfilled() ? (t.fulfillmentValue = this.value(), t.isFulfilled = !0) : this.isRejected() && (t.rejectionReason = this.reason(), t.isRejected = !0), t\n                        }, i.prototype.all = function () {\n                            return arguments.length > 0 && this._warn(\".all() was passed arguments but it does not take any\"), new k(this).promise()\n                        }, i.prototype.error = function (t) {\n                            return this.caught(f.originatesFromRejection, t)\n                        }, i.getNewLibraryCopy = e.exports, i.is = function (t) {\n                            return t instanceof i\n                        }, i.fromNode = i.fromCallback = function (t) {\n                            var e = new i(b);\n                            e._captureStackTrace();\n                            var n = arguments.length > 1 ? !!Object(arguments[1]).multiArgs : !1, r = O(t)(R(e, n));\n                            return r === S && e._rejectCallback(r.e, !0), e._isFateSealed() || e._setAsyncGuaranteed(), e\n                        }, i.all = function (t) {\n                            return new k(t).promise()\n                        }, i.cast = function (t) {\n                            var e = j(t);\n                            return e instanceof i || (e = new i(b), e._captureStackTrace(), e._setFulfilled(), e._rejectionHandler0 = t), e\n                        }, i.resolve = i.fulfilled = i.cast, i.reject = i.rejected = function (t) {\n                            var e = new i(b);\n                            return e._captureStackTrace(), e._rejectCallback(t, !0), e\n                        }, i.setScheduler = function (t) {\n                            if (\"function\" != typeof t)throw new m(\"expecting a function but got \" + f.classString(t));\n                            return v.setScheduler(t)\n                        }, i.prototype._then = function (t, e, n, r, o) {\n                            var s = void 0 !== o, a = s ? o : new i(b), l = this._target(), u = l._bitField;\n                            s || (a._propagateFrom(this, 3), a._captureStackTrace(), void 0 === r && 0 !== (2097152 & this._bitField) && (r = 0 !== (50397184 & u) ? this._boundValue() : l === this ? void 0 : this._boundTo), this._fireEvent(\"promiseChained\", this, a));\n                            var p = c();\n                            if (0 !== (50397184 & u)) {\n                                var h, _, d = l._settlePromiseCtx;\n                                0 !== (33554432 & u) ? (_ = l._rejectionHandler0, h = t) : 0 !== (16777216 & u) ? (_ = l._fulfillmentHandler0, h = e, l._unsetRejectionIsUnhandled()) : (d = l._settlePromiseLateCancellationObserver, _ = new g(\"late cancellation observer\"), l._attachExtraTrace(_), h = e), v.invoke(d, l, {\n                                    handler: null === p ? h : \"function\" == typeof h && f.domainBind(p, h),\n                                    promise: a,\n                                    receiver: r,\n                                    value: _\n                                })\n                            } else l._addCallbacks(t, e, a, r, p);\n                            return a\n                        }, i.prototype._length = function () {\n                            return 65535 & this._bitField\n                        }, i.prototype._isFateSealed = function () {\n                            return 0 !== (117506048 & this._bitField)\n                        }, i.prototype._isFollowing = function () {\n                            return 67108864 === (67108864 & this._bitField)\n                        }, i.prototype._setLength = function (t) {\n                            this._bitField = -65536 & this._bitField | 65535 & t\n                        }, i.prototype._setFulfilled = function () {\n                            this._bitField = 33554432 | this._bitField, this._fireEvent(\"promiseFulfilled\", this)\n                        }, i.prototype._setRejected = function () {\n                            this._bitField = 16777216 | this._bitField, this._fireEvent(\"promiseRejected\", this)\n                        }, i.prototype._setFollowing = function () {\n                            this._bitField = 67108864 | this._bitField, this._fireEvent(\"promiseResolved\", this)\n                        }, i.prototype._setIsFinal = function () {\n                            this._bitField = 4194304 | this._bitField\n                        }, i.prototype._isFinal = function () {\n                            return (4194304 & this._bitField) > 0\n                        }, i.prototype._unsetCancelled = function () {\n                            this._bitField = -65537 & this._bitField\n                        }, i.prototype._setCancelled = function () {\n                            this._bitField = 65536 | this._bitField, this._fireEvent(\"promiseCancelled\", this)\n                        }, i.prototype._setWillBeCancelled = function () {\n                            this._bitField = 8388608 | this._bitField\n                        }, i.prototype._setAsyncGuaranteed = function () {\n                            v.hasCustomScheduler() || (this._bitField = 134217728 | this._bitField)\n                        }, i.prototype._receiverAt = function (t) {\n                            var e = 0 === t ? this._receiver0 : this[4 * t - 4 + 3];\n                            return e === h ? void 0 : void 0 === e && this._isBound() ? this._boundValue() : e\n                        }, i.prototype._promiseAt = function (t) {\n                            return this[4 * t - 4 + 2]\n                        }, i.prototype._fulfillmentHandlerAt = function (t) {\n                            return this[4 * t - 4 + 0]\n                        }, i.prototype._rejectionHandlerAt = function (t) {\n                            return this[4 * t - 4 + 1]\n                        }, i.prototype._boundValue = function () {\n                        }, i.prototype._migrateCallback0 = function (t) {\n                            var e = (t._bitField, t._fulfillmentHandler0), n = t._rejectionHandler0, r = t._promise0, i = t._receiverAt(0);\n                            void 0 === i && (i = h), this._addCallbacks(e, n, r, i, null)\n                        }, i.prototype._migrateCallbackAt = function (t, e) {\n                            var n = t._fulfillmentHandlerAt(e), r = t._rejectionHandlerAt(e), i = t._promiseAt(e), o = t._receiverAt(e);\n                            void 0 === o && (o = h), this._addCallbacks(n, r, i, o, null)\n                        }, i.prototype._addCallbacks = function (t, e, n, r, i) {\n                            var o = this._length();\n                            if (o >= 65531 && (o = 0, this._setLength(0)), 0 === o)this._promise0 = n, this._receiver0 = r, \"function\" == typeof t && (this._fulfillmentHandler0 = null === i ? t : f.domainBind(i, t)), \"function\" == typeof e && (this._rejectionHandler0 = null === i ? e : f.domainBind(i, e)); else {\n                                var s = 4 * o - 4;\n                                this[s + 2] = n, this[s + 3] = r, \"function\" == typeof t && (this[s + 0] = null === i ? t : f.domainBind(i, t)), \"function\" == typeof e && (this[s + 1] = null === i ? e : f.domainBind(i, e))\n                            }\n                            return this._setLength(o + 1), o\n                        }, i.prototype._proxy = function (t, e) {\n                            this._addCallbacks(void 0, void 0, e, t, null)\n                        }, i.prototype._resolveCallback = function (t, e) {\n                            if (0 === (117506048 & this._bitField)) {\n                                if (t === this)return this._rejectCallback(l(), !1);\n                                var n = j(t, this);\n                                if (!(n instanceof i))return this._fulfill(t);\n                                e && this._propagateFrom(n, 2);\n                                var r = n._target();\n                                if (r === this)return void this._reject(l());\n                                var o = r._bitField;\n                                if (0 === (50397184 & o)) {\n                                    var s = this._length();\n                                    s > 0 && r._migrateCallback0(this);\n                                    for (var a = 1; s > a; ++a)r._migrateCallbackAt(this, a);\n                                    this._setFollowing(), this._setLength(0), this._setFollowee(r)\n                                } else if (0 !== (33554432 & o))this._fulfill(r._value()); else if (0 !== (16777216 & o))this._reject(r._reason()); else {\n                                    var c = new g(\"late cancellation observer\");\n                                    r._attachExtraTrace(c), this._reject(c)\n                                }\n                            }\n                        }, i.prototype._rejectCallback = function (t, e, n) {\n                            var r = f.ensureErrorObject(t), i = r === t;\n                            if (!i && !n && x.warnings()) {\n                                var o = \"a promise was rejected with a non-error: \" + f.classString(t);\n                                this._warn(o, !0)\n                            }\n                            this._attachExtraTrace(r, e ? i : !1), this._reject(t)\n                        }, i.prototype._resolveFromExecutor = function (t) {\n                            var e = this;\n                            this._captureStackTrace(), this._pushContext();\n                            var n = !0, r = this._execute(t, function (t) {\n                                e._resolveCallback(t)\n                            }, function (t) {\n                                e._rejectCallback(t, n)\n                            });\n                            n = !1, this._popContext(), void 0 !== r && e._rejectCallback(r, !0)\n                        }, i.prototype._settlePromiseFromHandler = function (t, e, n, r) {\n                            var i = r._bitField;\n                            if (0 === (65536 & i)) {\n                                r._pushContext();\n                                var o;\n                                e === w ? n && \"number\" == typeof n.length ? o = O(t).apply(this._boundValue(), n) : (o = S, o.e = new m(\"cannot .spread() a non-array: \" + f.classString(n))) : o = O(t).call(e, n);\n                                var s = r._popContext();\n                                i = r._bitField, 0 === (65536 & i) && (o === C ? r._reject(n) : o === S ? r._rejectCallback(o.e, !1) : (x.checkForgottenReturns(o, s, \"\", r, this), r._resolveCallback(o)))\n                            }\n                        }, i.prototype._target = function () {\n                            for (var t = this; t._isFollowing();)t = t._followee();\n                            return t\n                        }, i.prototype._followee = function () {\n                            return this._rejectionHandler0\n                        }, i.prototype._setFollowee = function (t) {\n                            this._rejectionHandler0 = t\n                        }, i.prototype._settlePromise = function (t, e, r, o) {\n                            var s = t instanceof i, a = this._bitField, c = 0 !== (134217728 & a);\n                            0 !== (65536 & a) ? (s && t._invokeInternalOnCancel(), r instanceof T && r.isFinallyHandler() ? (r.cancelPromise = t, O(e).call(r, o) === S && t._reject(S.e)) : e === u ? t._fulfill(u.call(r)) : r instanceof n ? r._promiseCancelled(t) : s || t instanceof k ? t._cancel() : r.cancel()) : \"function\" == typeof e ? s ? (c && t._setAsyncGuaranteed(), this._settlePromiseFromHandler(e, r, o, t)) : e.call(r, o, t) : r instanceof n ? r._isResolved() || (0 !== (33554432 & a) ? r._promiseFulfilled(o, t) : r._promiseRejected(o, t)) : s && (c && t._setAsyncGuaranteed(), 0 !== (33554432 & a) ? t._fulfill(o) : t._reject(o))\n                        }, i.prototype._settlePromiseLateCancellationObserver = function (t) {\n                            var e = t.handler, n = t.promise, r = t.receiver, o = t.value;\n                            \"function\" == typeof e ? n instanceof i ? this._settlePromiseFromHandler(e, r, o, n) : e.call(r, o, n) : n instanceof i && n._reject(o)\n                        }, i.prototype._settlePromiseCtx = function (t) {\n                            this._settlePromise(t.promise, t.handler, t.receiver, t.value)\n                        }, i.prototype._settlePromise0 = function (t, e, n) {\n                            var r = this._promise0, i = this._receiverAt(0);\n                            this._promise0 = void 0, this._receiver0 = void 0, this._settlePromise(r, t, i, e)\n                        }, i.prototype._clearCallbackDataAtIndex = function (t) {\n                            var e = 4 * t - 4;\n                            this[e + 2] = this[e + 3] = this[e + 0] = this[e + 1] = void 0\n                        }, i.prototype._fulfill = function (t) {\n                            var e = this._bitField;\n                            if (!((117506048 & e) >>> 16)) {\n                                if (t === this) {\n                                    var n = l();\n                                    return this._attachExtraTrace(n), this._reject(n)\n                                }\n                                this._setFulfilled(), this._rejectionHandler0 = t, (65535 & e) > 0 && (0 !== (134217728 & e) ? this._settlePromises() : v.settlePromises(this))\n                            }\n                        }, i.prototype._reject = function (t) {\n                            var e = this._bitField;\n                            if (!((117506048 & e) >>> 16))return this._setRejected(), this._fulfillmentHandler0 = t, this._isFinal() ? v.fatalError(t, f.isNode) : void((65535 & e) > 0 ? v.settlePromises(this) : this._ensurePossibleRejectionHandled())\n                        }, i.prototype._fulfillPromises = function (t, e) {\n                            for (var n = 1; t > n; n++) {\n                                var r = this._fulfillmentHandlerAt(n), i = this._promiseAt(n), o = this._receiverAt(n);\n                                this._clearCallbackDataAtIndex(n), this._settlePromise(i, r, o, e)\n                            }\n                        }, i.prototype._rejectPromises = function (t, e) {\n                            for (var n = 1; t > n; n++) {\n                                var r = this._rejectionHandlerAt(n), i = this._promiseAt(n), o = this._receiverAt(n);\n                                this._clearCallbackDataAtIndex(n), this._settlePromise(i, r, o, e)\n                            }\n                        }, i.prototype._settlePromises = function () {\n                            var t = this._bitField, e = 65535 & t;\n                            if (e > 0) {\n                                if (0 !== (16842752 & t)) {\n                                    var n = this._fulfillmentHandler0;\n                                    this._settlePromise0(this._rejectionHandler0, n, t), this._rejectPromises(e, n)\n                                } else {\n                                    var r = this._rejectionHandler0;\n                                    this._settlePromise0(this._fulfillmentHandler0, r, t), this._fulfillPromises(e, r)\n                                }\n                                this._setLength(0)\n                            }\n                            this._clearCancellationData()\n                        }, i.prototype._settledValue = function () {\n                            var t = this._bitField;\n                            return 0 !== (33554432 & t) ? this._rejectionHandler0 : 0 !== (16777216 & t) ? this._fulfillmentHandler0 : void 0\n                        }, i.defer = i.pending = function () {\n                            x.deprecated(\"Promise.defer\", \"new Promise\");\n                            var t = new i(b);\n                            return {promise: t, resolve: o, reject: s}\n                        }, f.notEnumerableProp(i, \"_makeSelfResolutionError\", l), t(\"./method\")(i, b, j, p, x), t(\"./bind\")(i, b, j, x), t(\"./cancel\")(i, k, p, x), t(\"./direct_resolve\")(i), t(\"./synchronous_inspection\")(i), t(\"./join\")(i, k, j, b, v, c), i.Promise = i, i.version = \"3.4.6\", t(\"./map.js\")(i, k, p, j, b, x), t(\"./call_get.js\")(i), t(\"./using.js\")(i, p, j, F, b, x), t(\"./timers.js\")(i, b, x), t(\"./generators.js\")(i, p, b, j, n, x), t(\"./nodeify.js\")(i), t(\"./promisify.js\")(i, b), t(\"./props.js\")(i, k, j, p), t(\"./race.js\")(i, b, j, p), t(\"./reduce.js\")(i, k, p, j, b, x), t(\"./settle.js\")(i, k, x), t(\"./some.js\")(i, k, p), t(\"./filter.js\")(i, b), t(\"./each.js\")(i, b), t(\"./any.js\")(i), f.toFastProperties(i), f.toFastProperties(i.prototype), a({a: 1}), a({b: 2}), a({c: 3}), a(1), a(function () {\n                        }), a(void 0), a(!1), a(new i(b)), x.setBounds(d.firstLineError, f.lastLineError), i\n                    }\n                }, {\n                    \"./any.js\": 1,\n                    \"./async\": 2,\n                    \"./bind\": 3,\n                    \"./call_get.js\": 5,\n                    \"./cancel\": 6,\n                    \"./catch_filter\": 7,\n                    \"./context\": 8,\n                    \"./debuggability\": 9,\n                    \"./direct_resolve\": 10,\n                    \"./each.js\": 11,\n                    \"./errors\": 12,\n                    \"./es5\": 13,\n                    \"./filter.js\": 14,\n                    \"./finally\": 15,\n                    \"./generators.js\": 16,\n                    \"./join\": 17,\n                    \"./map.js\": 18,\n                    \"./method\": 19,\n                    \"./nodeback\": 20,\n                    \"./nodeify.js\": 21,\n                    \"./promise_array\": 23,\n                    \"./promisify.js\": 24,\n                    \"./props.js\": 25,\n                    \"./race.js\": 27,\n                    \"./reduce.js\": 28,\n                    \"./settle.js\": 30,\n                    \"./some.js\": 31,\n                    \"./synchronous_inspection\": 32,\n                    \"./thenables\": 33,\n                    \"./timers.js\": 34,\n                    \"./using.js\": 35,\n                    \"./util\": 36\n                }], 23: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o) {\n                        function s(t) {\n                            switch (t) {\n                                case-2:\n                                    return [];\n                                case-3:\n                                    return {}\n                            }\n                        }\n\n                        function a(t) {\n                            var r = this._promise = new e(n);\n                            t instanceof e && r._propagateFrom(t, 3), r._setOnCancel(this), this._values = t, this._length = 0, this._totalResolved = 0, this._init(void 0, -2)\n                        }\n\n                        var c = t(\"./util\");\n                        c.isArray;\n                        return c.inherits(a, o), a.prototype.length = function () {\n                            return this._length\n                        }, a.prototype.promise = function () {\n                            return this._promise\n                        }, a.prototype._init = function l(t, n) {\n                            var o = r(this._values, this._promise);\n                            if (o instanceof e) {\n                                o = o._target();\n                                var a = o._bitField;\n                                if (this._values = o, 0 === (50397184 & a))return this._promise._setAsyncGuaranteed(), o._then(l, this._reject, void 0, this, n);\n                                if (0 === (33554432 & a))return 0 !== (16777216 & a) ? this._reject(o._reason()) : this._cancel();\n                                o = o._value()\n                            }\n                            if (o = c.asArray(o), null === o) {\n                                var u = i(\"expecting an array or an iterable object but got \" + c.classString(o)).reason();\n                                return void this._promise._rejectCallback(u, !1)\n                            }\n                            return 0 === o.length ? void(-5 === n ? this._resolveEmptyArray() : this._resolve(s(n))) : void this._iterate(o)\n                        }, a.prototype._iterate = function (t) {\n                            var n = this.getActualLength(t.length);\n                            this._length = n, this._values = this.shouldCopyValues() ? new Array(n) : this._values;\n                            for (var i = this._promise, o = !1, s = null, a = 0; n > a; ++a) {\n                                var c = r(t[a], i);\n                                c instanceof e ? (c = c._target(), s = c._bitField) : s = null, o ? null !== s && c.suppressUnhandledRejections() : null !== s ? 0 === (50397184 & s) ? (c._proxy(this, a), this._values[a] = c) : o = 0 !== (33554432 & s) ? this._promiseFulfilled(c._value(), a) : 0 !== (16777216 & s) ? this._promiseRejected(c._reason(), a) : this._promiseCancelled(a) : o = this._promiseFulfilled(c, a)\n                            }\n                            o || i._setAsyncGuaranteed()\n                        }, a.prototype._isResolved = function () {\n                            return null === this._values\n                        }, a.prototype._resolve = function (t) {\n                            this._values = null, this._promise._fulfill(t)\n                        }, a.prototype._cancel = function () {\n                            !this._isResolved() && this._promise._isCancellable() && (this._values = null, this._promise._cancel())\n                        }, a.prototype._reject = function (t) {\n                            this._values = null, this._promise._rejectCallback(t, !1)\n                        }, a.prototype._promiseFulfilled = function (t, e) {\n                            this._values[e] = t;\n                            var n = ++this._totalResolved;\n                            return n >= this._length ? (this._resolve(this._values), !0) : !1\n                        }, a.prototype._promiseCancelled = function () {\n                            return this._cancel(), !0\n                        }, a.prototype._promiseRejected = function (t) {\n                            return this._totalResolved++, this._reject(t), !0\n                        }, a.prototype._resultCancelled = function () {\n                            if (!this._isResolved()) {\n                                var t = this._values;\n                                if (this._cancel(), t instanceof e)t.cancel(); else for (var n = 0; n < t.length; ++n)t[n] instanceof e && t[n].cancel()\n                            }\n                        }, a.prototype.shouldCopyValues = function () {\n                            return !0\n                        }, a.prototype.getActualLength = function (t) {\n                            return t\n                        }, a\n                    }\n                }, {\"./util\": 36}], 24: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n) {\n                        function r(t) {\n                            return !C.test(t)\n                        }\n\n                        function i(t) {\n                            try {\n                                return t.__isPromisified__ === !0\n                            } catch (e) {\n                                return !1\n                            }\n                        }\n\n                        function o(t, e, n) {\n                            var r = f.getDataPropertyOrDefault(t, e + n, b);\n                            return r ? i(r) : !1\n                        }\n\n                        function s(t, e, n) {\n                            for (var r = 0; r < t.length; r += 2) {\n                                var i = t[r];\n                                if (n.test(i))for (var o = i.replace(n, \"\"), s = 0; s < t.length; s += 2)if (t[s] === o)throw new m(\"Cannot promisify an API that has normal methods with '%s'-suffix\\n\\n    See http://goo.gl/MqrFmX\\n\".replace(\"%s\", e))\n                            }\n                        }\n\n                        function a(t, e, n, r) {\n                            for (var a = f.inheritedDataKeys(t), c = [], l = 0; l < a.length; ++l) {\n                                var u = a[l], p = t[u], h = r === j ? !0 : j(u, p, t);\n                                \"function\" != typeof p || i(p) || o(t, u, e) || !r(u, p, t, h) || c.push(u, p)\n                            }\n                            return s(c, e, n), c\n                        }\n\n                        function c(t, r, i, o, s, a) {\n                            function c() {\n                                var i = r;\n                                r === h && (i = this);\n                                var o = new e(n);\n                                o._captureStackTrace();\n                                var s = \"string\" == typeof u && this !== l ? this[u] : t, c = _(o, a);\n                                try {\n                                    s.apply(i, d(arguments, c))\n                                } catch (p) {\n                                    o._rejectCallback(v(p), !0, !0)\n                                }\n                                return o._isFateSealed() || o._setAsyncGuaranteed(), o\n                            }\n\n                            var l = function () {\n                                return this\n                            }(), u = t;\n                            return \"string\" == typeof u && (t = o), f.notEnumerableProp(c, \"__isPromisified__\", !0), c\n                        }\n\n                        function l(t, e, n, r, i) {\n                            for (var o = new RegExp(k(e) + \"$\"), s = a(t, e, o, n), c = 0, l = s.length; l > c; c += 2) {\n                                var u = s[c], p = s[c + 1], _ = u + e;\n                                if (r === E)t[_] = E(u, h, u, p, e, i); else {\n                                    var d = r(p, function () {\n                                        return E(u, h, u, p, e, i)\n                                    });\n                                    f.notEnumerableProp(d, \"__isPromisified__\", !0), t[_] = d\n                                }\n                            }\n                            return f.toFastProperties(t), t\n                        }\n\n                        function u(t, e, n) {\n                            return E(t, e, void 0, t, null, n)\n                        }\n\n                        var p, h = {}, f = t(\"./util\"), _ = t(\"./nodeback\"), d = f.withAppended, v = f.maybeWrapAsError, y = f.canEvaluate, m = t(\"./errors\").TypeError, g = \"Async\", b = {__isPromisified__: !0}, w = [\"arity\", \"length\", \"name\", \"arguments\", \"caller\", \"callee\", \"prototype\", \"__isPromisified__\"], C = new RegExp(\"^(?:\" + w.join(\"|\") + \")$\"), j = function (t) {\n                            return f.isIdentifier(t) && \"_\" !== t.charAt(0) && \"constructor\" !== t\n                        }, k = function (t) {\n                            return t.replace(/([$])/, \"\\\\$\")\n                        }, E = y ? p : c;\n                        e.promisify = function (t, e) {\n                            if (\"function\" != typeof t)throw new m(\"expecting a function but got \" + f.classString(t));\n                            if (i(t))return t;\n                            e = Object(e);\n                            var n = void 0 === e.context ? h : e.context, o = !!e.multiArgs, s = u(t, n, o);\n                            return f.copyDescriptors(t, s, r), s\n                        }, e.promisifyAll = function (t, e) {\n                            if (\"function\" != typeof t && \"object\" != typeof t)throw new m(\"the target of promisifyAll must be an object or a function\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            e = Object(e);\n                            var n = !!e.multiArgs, r = e.suffix;\n                            \"string\" != typeof r && (r = g);\n                            var i = e.filter;\n                            \"function\" != typeof i && (i = j);\n                            var o = e.promisifier;\n                            if (\"function\" != typeof o && (o = E), !f.isIdentifier(r))throw new RangeError(\"suffix must be a valid identifier\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            for (var s = f.inheritedDataKeys(t), a = 0; a < s.length; ++a) {\n                                var c = t[s[a]];\n                                \"constructor\" !== s[a] && f.isClass(c) && (l(c.prototype, r, i, o, n), l(c, r, i, o, n))\n                            }\n                            return l(t, r, i, o, n)\n                        }\n                    }\n                }, {\"./errors\": 12, \"./nodeback\": 20, \"./util\": 36}], 25: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i) {\n                        function o(t) {\n                            var e, n = !1;\n                            if (void 0 !== a && t instanceof a)e = p(t), n = !0; else {\n                                var r = u.keys(t), i = r.length;\n                                e = new Array(2 * i);\n                                for (var o = 0; i > o; ++o) {\n                                    var s = r[o];\n                                    e[o] = t[s], e[o + i] = s\n                                }\n                            }\n                            this.constructor$(e), this._isMap = n, this._init$(void 0, -3)\n                        }\n\n                        function s(t) {\n                            var n, s = r(t);\n                            return l(s) ? (n = s instanceof e ? s._then(e.props, void 0, void 0, void 0, void 0) : new o(s).promise(), s instanceof e && n._propagateFrom(s, 2), n) : i(\"cannot await properties of a non-object\\n\\n    See http://goo.gl/MqrFmX\\n\")\n                        }\n\n                        var a, c = t(\"./util\"), l = c.isObject, u = t(\"./es5\");\n                        \"function\" == typeof Map && (a = Map);\n                        var p = function () {\n                            function t(t, r) {\n                                this[e] = t, this[e + n] = r, e++\n                            }\n\n                            var e = 0, n = 0;\n                            return function (r) {\n                                n = r.size, e = 0;\n                                var i = new Array(2 * r.size);\n                                return r.forEach(t, i), i\n                            }\n                        }(), h = function (t) {\n                            for (var e = new a, n = t.length / 2 | 0, r = 0; n > r; ++r) {\n                                var i = t[n + r], o = t[r];\n                                e.set(i, o)\n                            }\n                            return e\n                        };\n                        c.inherits(o, n), o.prototype._init = function () {\n                        }, o.prototype._promiseFulfilled = function (t, e) {\n                            this._values[e] = t;\n                            var n = ++this._totalResolved;\n                            if (n >= this._length) {\n                                var r;\n                                if (this._isMap)r = h(this._values); else {\n                                    r = {};\n                                    for (var i = this.length(), o = 0, s = this.length(); s > o; ++o)r[this._values[o + i]] = this._values[o]\n                                }\n                                return this._resolve(r), !0\n                            }\n                            return !1\n                        }, o.prototype.shouldCopyValues = function () {\n                            return !1\n                        }, o.prototype.getActualLength = function (t) {\n                            return t >> 1\n                        }, e.prototype.props = function () {\n                            return s(this)\n                        }, e.props = function (t) {\n                            return s(t)\n                        }\n                    }\n                }, {\"./es5\": 13, \"./util\": 36}], 26: [function (t, e, n) {\n                    \"use strict\";\n                    function r(t, e, n, r, i) {\n                        for (var o = 0; i > o; ++o)n[o + r] = t[o + e], t[o + e] = void 0\n                    }\n\n                    function i(t) {\n                        this._capacity = t, this._length = 0, this._front = 0\n                    }\n\n                    i.prototype._willBeOverCapacity = function (t) {\n                        return this._capacity < t\n                    }, i.prototype._pushOne = function (t) {\n                        var e = this.length();\n                        this._checkCapacity(e + 1);\n                        var n = this._front + e & this._capacity - 1;\n                        this[n] = t, this._length = e + 1\n                    }, i.prototype._unshiftOne = function (t) {\n                        var e = this._capacity;\n                        this._checkCapacity(this.length() + 1);\n                        var n = this._front, r = (n - 1 & e - 1 ^ e) - e;\n                        this[r] = t, this._front = r, this._length = this.length() + 1\n                    }, i.prototype.unshift = function (t, e, n) {\n                        this._unshiftOne(n), this._unshiftOne(e), this._unshiftOne(t)\n                    }, i.prototype.push = function (t, e, n) {\n                        var r = this.length() + 3;\n                        if (this._willBeOverCapacity(r))return this._pushOne(t), this._pushOne(e), void this._pushOne(n);\n                        var i = this._front + r - 3;\n                        this._checkCapacity(r);\n                        var o = this._capacity - 1;\n                        this[i + 0 & o] = t, this[i + 1 & o] = e, this[i + 2 & o] = n, this._length = r\n                    }, i.prototype.shift = function () {\n                        var t = this._front, e = this[t];\n                        return this[t] = void 0, this._front = t + 1 & this._capacity - 1, this._length--, e\n                    }, i.prototype.length = function () {\n                        return this._length\n                    }, i.prototype._checkCapacity = function (t) {\n                        this._capacity < t && this._resizeTo(this._capacity << 1)\n                    }, i.prototype._resizeTo = function (t) {\n                        var e = this._capacity;\n                        this._capacity = t;\n                        var n = this._front, i = this._length, o = n + i & e - 1;\n                        r(this, 0, this, e, o)\n                    }, e.exports = i\n                }, {}], 27: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i) {\n                        function o(t, o) {\n                            var c = r(t);\n                            if (c instanceof e)return a(c);\n                            if (t = s.asArray(t), null === t)return i(\"expecting an array or an iterable object but got \" + s.classString(t));\n                            var l = new e(n);\n                            void 0 !== o && l._propagateFrom(o, 3);\n                            for (var u = l._fulfill, p = l._reject, h = 0, f = t.length; f > h; ++h) {\n                                var _ = t[h];\n                                (void 0 !== _ || h in t) && e.cast(_)._then(u, p, void 0, l, null)\n                            }\n                            return l\n                        }\n\n                        var s = t(\"./util\"), a = function (t) {\n                            return t.then(function (e) {\n                                return o(e, t)\n                            })\n                        };\n                        e.race = function (t) {\n                            return o(t, void 0)\n                        }, e.prototype.race = function () {\n                            return o(this, void 0)\n                        }\n                    }\n                }, {\"./util\": 36}], 28: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o, s) {\n                        function a(t, n, r, i) {\n                            this.constructor$(t);\n                            var s = h();\n                            this._fn = null === s ? n : f.domainBind(s, n), void 0 !== r && (r = e.resolve(r), r._attachCancellationCallback(this)), this._initialValue = r, this._currentCancellable = null, i === o ? this._eachValues = Array(this._length) : 0 === i ? this._eachValues = null : this._eachValues = void 0, this._promise._captureStackTrace(), this._init$(void 0, -5)\n                        }\n\n                        function c(t, e) {\n                            this.isFulfilled() ? e._resolve(t) : e._reject(t)\n                        }\n\n                        function l(t, e, n, i) {\n                            if (\"function\" != typeof e)return r(\"expecting a function but got \" + f.classString(e));\n                            var o = new a(t, e, n, i);\n                            return o.promise()\n                        }\n\n                        function u(t) {\n                            this.accum = t, this.array._gotAccum(t);\n                            var n = i(this.value, this.array._promise);\n                            return n instanceof e ? (this.array._currentCancellable = n, n._then(p, void 0, void 0, this, void 0)) : p.call(this, n)\n                        }\n\n                        function p(t) {\n                            var n = this.array, r = n._promise, i = _(n._fn);\n                            r._pushContext();\n                            var o;\n                            o = void 0 !== n._eachValues ? i.call(r._boundValue(), t, this.index, this.length) : i.call(r._boundValue(), this.accum, t, this.index, this.length), o instanceof e && (n._currentCancellable = o);\n                            var a = r._popContext();\n                            return s.checkForgottenReturns(o, a, void 0 !== n._eachValues ? \"Promise.each\" : \"Promise.reduce\", r), o\n                        }\n\n                        var h = e._getDomain, f = t(\"./util\"), _ = f.tryCatch;\n                        f.inherits(a, n), a.prototype._gotAccum = function (t) {\n                            void 0 !== this._eachValues && null !== this._eachValues && t !== o && this._eachValues.push(t)\n                        }, a.prototype._eachComplete = function (t) {\n                            return null !== this._eachValues && this._eachValues.push(t), this._eachValues\n                        }, a.prototype._init = function () {\n                        }, a.prototype._resolveEmptyArray = function () {\n                            this._resolve(void 0 !== this._eachValues ? this._eachValues : this._initialValue)\n                        }, a.prototype.shouldCopyValues = function () {\n                            return !1\n                        }, a.prototype._resolve = function (t) {\n                            this._promise._resolveCallback(t), this._values = null\n                        }, a.prototype._resultCancelled = function (t) {\n                            return t === this._initialValue ? this._cancel() : void(this._isResolved() || (this._resultCancelled$(), this._currentCancellable instanceof e && this._currentCancellable.cancel(), this._initialValue instanceof e && this._initialValue.cancel()))\n                        }, a.prototype._iterate = function (t) {\n                            this._values = t;\n                            var n, r, i = t.length;\n                            if (void 0 !== this._initialValue ? (n = this._initialValue, r = 0) : (n = e.resolve(t[0]), r = 1), this._currentCancellable = n, !n.isRejected())for (; i > r; ++r) {\n                                var o = {accum: null, value: t[r], index: r, length: i, array: this};\n                                n = n._then(u, void 0, void 0, o, void 0)\n                            }\n                            void 0 !== this._eachValues && (n = n._then(this._eachComplete, void 0, void 0, this, void 0)), n._then(c, c, void 0, n, this)\n                        }, e.prototype.reduce = function (t, e) {\n                            return l(this, t, e, null)\n                        }, e.reduce = function (t, e, n, r) {\n                            return l(t, e, n, r)\n                        }\n                    }\n                }, {\"./util\": 36}], 29: [function (t, e, n) {\n                    \"use strict\";\n                    var r, i = t(\"./util\"), o = function () {\n                        throw new Error(\"No async scheduler available\\n\\n    See http://goo.gl/MqrFmX\\n\")\n                    }, s = i.getNativePromise();\n                    if (i.isNode && \"undefined\" == typeof MutationObserver) {\n                        var a = global.setImmediate, c = process.nextTick;\n                        r = i.isRecentNode ? function (t) {\n                            a.call(global, t)\n                        } : function (t) {\n                            c.call(process, t)\n                        }\n                    } else if (\"function\" == typeof s && \"function\" == typeof s.resolve) {\n                        var l = s.resolve();\n                        r = function (t) {\n                            l.then(t)\n                        }\n                    } else r = \"undefined\" == typeof MutationObserver || \"undefined\" != typeof window && window.navigator && (window.navigator.standalone || window.cordova) ? \"undefined\" != typeof setImmediate ? function (t) {\n                        setImmediate(t)\n                    } : \"undefined\" != typeof setTimeout ? function (t) {\n                        setTimeout(t, 0)\n                    } : o : function () {\n                        var t = document.createElement(\"div\"), e = {attributes: !0}, n = !1, r = document.createElement(\"div\"), i = new MutationObserver(function () {\n                            t.classList.toggle(\"foo\"), n = !1\n                        });\n                        i.observe(r, e);\n                        var o = function () {\n                            n || (n = !0, r.classList.toggle(\"foo\"))\n                        };\n                        return function (n) {\n                            var r = new MutationObserver(function () {\n                                r.disconnect(), n()\n                            });\n                            r.observe(t, e), o()\n                        }\n                    }();\n                    e.exports = r\n                }, {\"./util\": 36}], 30: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r) {\n                        function i(t) {\n                            this.constructor$(t)\n                        }\n\n                        var o = e.PromiseInspection, s = t(\"./util\");\n                        s.inherits(i, n), i.prototype._promiseResolved = function (t, e) {\n                            this._values[t] = e;\n                            var n = ++this._totalResolved;\n                            return n >= this._length ? (this._resolve(this._values), !0) : !1\n                        }, i.prototype._promiseFulfilled = function (t, e) {\n                            var n = new o;\n                            return n._bitField = 33554432, n._settledValueField = t, this._promiseResolved(e, n)\n                        }, i.prototype._promiseRejected = function (t, e) {\n                            var n = new o;\n                            return n._bitField = 16777216, n._settledValueField = t, this._promiseResolved(e, n)\n                        }, e.settle = function (t) {\n                            return r.deprecated(\".settle()\", \".reflect()\"), new i(t).promise()\n                        }, e.prototype.settle = function () {\n                            return e.settle(this)\n                        }\n                    }\n                }, {\"./util\": 36}], 31: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r) {\n                        function i(t) {\n                            this.constructor$(t), this._howMany = 0, this._unwrap = !1, this._initialized = !1\n                        }\n\n                        function o(t, e) {\n                            if ((0 | e) !== e || 0 > e)return r(\"expecting a positive integer\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            var n = new i(t), o = n.promise();\n                            return n.setHowMany(e), n.init(), o\n                        }\n\n                        var s = t(\"./util\"), a = t(\"./errors\").RangeError, c = t(\"./errors\").AggregateError, l = s.isArray, u = {};\n                        s.inherits(i, n), i.prototype._init = function () {\n                            if (this._initialized) {\n                                if (0 === this._howMany)return void this._resolve([]);\n                                this._init$(void 0, -5);\n                                var t = l(this._values);\n                                !this._isResolved() && t && this._howMany > this._canPossiblyFulfill() && this._reject(this._getRangeError(this.length()))\n                            }\n                        }, i.prototype.init = function () {\n                            this._initialized = !0, this._init()\n                        }, i.prototype.setUnwrap = function () {\n                            this._unwrap = !0\n                        }, i.prototype.howMany = function () {\n                            return this._howMany\n                        }, i.prototype.setHowMany = function (t) {\n                            this._howMany = t\n                        }, i.prototype._promiseFulfilled = function (t) {\n                            return this._addFulfilled(t), this._fulfilled() === this.howMany() ? (this._values.length = this.howMany(), 1 === this.howMany() && this._unwrap ? this._resolve(this._values[0]) : this._resolve(this._values), !0) : !1\n                        }, i.prototype._promiseRejected = function (t) {\n                            return this._addRejected(t), this._checkOutcome()\n                        }, i.prototype._promiseCancelled = function () {\n                            return this._values instanceof e || null == this._values ? this._cancel() : (this._addRejected(u), this._checkOutcome())\n                        }, i.prototype._checkOutcome = function () {\n                            if (this.howMany() > this._canPossiblyFulfill()) {\n                                for (var t = new c, e = this.length(); e < this._values.length; ++e)this._values[e] !== u && t.push(this._values[e]);\n                                return t.length > 0 ? this._reject(t) : this._cancel(), !0\n                            }\n                            return !1\n                        }, i.prototype._fulfilled = function () {\n                            return this._totalResolved\n                        }, i.prototype._rejected = function () {\n                            return this._values.length - this.length()\n                        }, i.prototype._addRejected = function (t) {\n                            this._values.push(t)\n                        }, i.prototype._addFulfilled = function (t) {\n                            this._values[this._totalResolved++] = t\n                        }, i.prototype._canPossiblyFulfill = function () {\n                            return this.length() - this._rejected()\n                        }, i.prototype._getRangeError = function (t) {\n                            var e = \"Input array must contain at least \" + this._howMany + \" items but contains only \" + t + \" items\";\n                            return new a(e)\n                        }, i.prototype._resolveEmptyArray = function () {\n                            this._reject(this._getRangeError(0))\n                        }, e.some = function (t, e) {\n                            return o(t, e)\n                        }, e.prototype.some = function (t) {\n                            return o(this, t)\n                        }, e._SomePromiseArray = i\n                    }\n                }, {\"./errors\": 12, \"./util\": 36}], 32: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (t) {\n                        function e(t) {\n                            void 0 !== t ? (t = t._target(), this._bitField = t._bitField, this._settledValueField = t._isFateSealed() ? t._settledValue() : void 0) : (this._bitField = 0, this._settledValueField = void 0)\n                        }\n\n                        e.prototype._settledValue = function () {\n                            return this._settledValueField\n                        };\n                        var n = e.prototype.value = function () {\n                            if (!this.isFulfilled())throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            return this._settledValue()\n                        }, r = e.prototype.error = e.prototype.reason = function () {\n                            if (!this.isRejected())throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\n\\n    See http://goo.gl/MqrFmX\\n\");\n                            return this._settledValue()\n                        }, i = e.prototype.isFulfilled = function () {\n                            return 0 !== (33554432 & this._bitField)\n                        }, o = e.prototype.isRejected = function () {\n                            return 0 !== (16777216 & this._bitField)\n                        }, s = e.prototype.isPending = function () {\n                            return 0 === (50397184 & this._bitField)\n                        }, a = e.prototype.isResolved = function () {\n                            return 0 !== (50331648 & this._bitField)\n                        };\n                        e.prototype.isCancelled = function () {\n                            return 0 !== (8454144 & this._bitField)\n                        }, t.prototype.__isCancelled = function () {\n                            return 65536 === (65536 & this._bitField)\n                        }, t.prototype._isCancelled = function () {\n                            return this._target().__isCancelled()\n                        }, t.prototype.isCancelled = function () {\n                            return 0 !== (8454144 & this._target()._bitField)\n                        }, t.prototype.isPending = function () {\n                            return s.call(this._target())\n                        }, t.prototype.isRejected = function () {\n                            return o.call(this._target())\n                        }, t.prototype.isFulfilled = function () {\n                            return i.call(this._target())\n                        }, t.prototype.isResolved = function () {\n                            return a.call(this._target())\n                        }, t.prototype.value = function () {\n                            return n.call(this._target())\n                        }, t.prototype.reason = function () {\n                            var t = this._target();\n                            return t._unsetRejectionIsUnhandled(), r.call(t)\n                        }, t.prototype._value = function () {\n                            return this._settledValue()\n                        }, t.prototype._reason = function () {\n                            return this._unsetRejectionIsUnhandled(), this._settledValue()\n                        }, t.PromiseInspection = e\n                    }\n                }, {}], 33: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n) {\n                        function r(t, r) {\n                            if (u(t)) {\n                                if (t instanceof e)return t;\n                                var i = o(t);\n                                if (i === l) {\n                                    r && r._pushContext();\n                                    var c = e.reject(i.e);\n                                    return r && r._popContext(), c\n                                }\n                                if (\"function\" == typeof i) {\n                                    if (s(t)) {\n                                        var c = new e(n);\n                                        return t._then(c._fulfill, c._reject, void 0, c, null), c\n                                    }\n                                    return a(t, i, r)\n                                }\n                            }\n                            return t\n                        }\n\n                        function i(t) {\n                            return t.then\n                        }\n\n                        function o(t) {\n                            try {\n                                return i(t)\n                            } catch (e) {\n                                return l.e = e, l\n                            }\n                        }\n\n                        function s(t) {\n                            try {\n                                return p.call(t, \"_promise0\")\n                            } catch (e) {\n                                return !1\n                            }\n                        }\n\n                        function a(t, r, i) {\n                            function o(t) {\n                                a && (a._resolveCallback(t), a = null)\n                            }\n\n                            function s(t) {\n                                a && (a._rejectCallback(t, p, !0), a = null)\n                            }\n\n                            var a = new e(n), u = a;\n                            i && i._pushContext(), a._captureStackTrace(), i && i._popContext();\n                            var p = !0, h = c.tryCatch(r).call(t, o, s);\n                            return p = !1, a && h === l && (a._rejectCallback(h.e, !0, !0), a = null), u\n                        }\n\n                        var c = t(\"./util\"), l = c.errorObj, u = c.isObject, p = {}.hasOwnProperty;\n                        return r\n                    }\n                }, {\"./util\": 36}], 34: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r) {\n                        function i(t) {\n                            this.handle = t\n                        }\n\n                        function o(t) {\n                            return clearTimeout(this.handle), t\n                        }\n\n                        function s(t) {\n                            throw clearTimeout(this.handle), t\n                        }\n\n                        var a = t(\"./util\"), c = e.TimeoutError;\n                        i.prototype._resultCancelled = function () {\n                            clearTimeout(this.handle)\n                        };\n                        var l = function (t) {\n                            return u(+this).thenReturn(t)\n                        }, u = e.delay = function (t, o) {\n                            var s, a;\n                            return void 0 !== o ? (s = e.resolve(o)._then(l, null, null, t, void 0), r.cancellation() && o instanceof e && s._setOnCancel(o)) : (s = new e(n), a = setTimeout(function () {\n                                s._fulfill()\n                            }, +t), r.cancellation() && s._setOnCancel(new i(a)), s._captureStackTrace()), s._setAsyncGuaranteed(), s\n                        };\n                        e.prototype.delay = function (t) {\n                            return u(t, this)\n                        };\n                        var p = function (t, e, n) {\n                            var r;\n                            r = \"string\" != typeof e ? e instanceof Error ? e : new c(\"operation timed out\") : new c(e), a.markAsOriginatingFromRejection(r), t._attachExtraTrace(r), t._reject(r), null != n && n.cancel()\n                        };\n                        e.prototype.timeout = function (t, e) {\n                            t = +t;\n                            var n, a, c = new i(setTimeout(function () {\n                                n.isPending() && p(n, e, a)\n                            }, t));\n                            return r.cancellation() ? (a = this.then(), n = a._then(o, s, void 0, c, void 0), n._setOnCancel(c)) : n = this._then(o, s, void 0, c, void 0), n\n                        }\n                    }\n                }, {\"./util\": 36}], 35: [function (t, e, n) {\n                    \"use strict\";\n                    e.exports = function (e, n, r, i, o, s) {\n                        function a(t) {\n                            setTimeout(function () {\n                                throw t\n                            }, 0)\n                        }\n\n                        function c(t) {\n                            var e = r(t);\n                            return e !== t && \"function\" == typeof t._isDisposable && \"function\" == typeof t._getDisposer && t._isDisposable() && e._setDisposable(t._getDisposer()), e\n                        }\n\n                        function l(t, n) {\n                            function i() {\n                                if (s >= l)return u._fulfill();\n                                var o = c(t[s++]);\n                                if (o instanceof e && o._isDisposable()) {\n                                    try {\n                                        o = r(o._getDisposer().tryDispose(n), t.promise)\n                                    } catch (p) {\n                                        return a(p)\n                                    }\n                                    if (o instanceof e)return o._then(i, a, null, null, null)\n                                }\n                                i()\n                            }\n\n                            var s = 0, l = t.length, u = new e(o);\n                            return i(), u\n                        }\n\n                        function u(t, e, n) {\n                            this._data = t, this._promise = e, this._context = n\n                        }\n\n                        function p(t, e, n) {\n                            this.constructor$(t, e, n)\n                        }\n\n                        function h(t) {\n                            return u.isDisposer(t) ? (this.resources[this.index]._setDisposable(t), t.promise()) : t\n                        }\n\n                        function f(t) {\n                            this.length = t, this.promise = null, this[t - 1] = null\n                        }\n\n                        var _ = t(\"./util\"), d = t(\"./errors\").TypeError, v = t(\"./util\").inherits, y = _.errorObj, m = _.tryCatch, g = {};\n                        u.prototype.data = function () {\n                            return this._data\n                        }, u.prototype.promise = function () {\n                            return this._promise\n                        }, u.prototype.resource = function () {\n                            return this.promise().isFulfilled() ? this.promise().value() : g\n                        }, u.prototype.tryDispose = function (t) {\n                            var e = this.resource(), n = this._context;\n                            void 0 !== n && n._pushContext();\n                            var r = e !== g ? this.doDispose(e, t) : null;\n                            return void 0 !== n && n._popContext(), this._promise._unsetDisposable(), this._data = null, r\n                        }, u.isDisposer = function (t) {\n                            return null != t && \"function\" == typeof t.resource && \"function\" == typeof t.tryDispose\n                        }, v(p, u), p.prototype.doDispose = function (t, e) {\n                            var n = this.data();\n                            return n.call(t, t, e)\n                        }, f.prototype._resultCancelled = function () {\n                            for (var t = this.length, n = 0; t > n; ++n) {\n                                var r = this[n];\n                                r instanceof e && r.cancel()\n                            }\n                        }, e.using = function () {\n                            var t = arguments.length;\n                            if (2 > t)return n(\"you must pass at least 2 arguments to Promise.using\");\n                            var i = arguments[t - 1];\n                            if (\"function\" != typeof i)return n(\"expecting a function but got \" + _.classString(i));\n                            var o, a = !0;\n                            2 === t && Array.isArray(arguments[0]) ? (o = arguments[0], t = o.length, a = !1) : (o = arguments, t--);\n                            for (var c = new f(t), p = 0; t > p; ++p) {\n                                var d = o[p];\n                                if (u.isDisposer(d)) {\n                                    var v = d;\n                                    d = d.promise(), d._setDisposable(v)\n                                } else {\n                                    var g = r(d);\n                                    g instanceof e && (d = g._then(h, null, null, {resources: c, index: p}, void 0))\n                                }\n                                c[p] = d\n                            }\n                            for (var b = new Array(c.length), p = 0; p < b.length; ++p)b[p] = e.resolve(c[p]).reflect();\n                            var w = e.all(b).then(function (t) {\n                                for (var e = 0; e < t.length; ++e) {\n                                    var n = t[e];\n                                    if (n.isRejected())return y.e = n.error(), y;\n                                    if (!n.isFulfilled())return void w.cancel();\n                                    t[e] = n.value()\n                                }\n                                C._pushContext(), i = m(i);\n                                var r = a ? i.apply(void 0, t) : i(t), o = C._popContext();\n                                return s.checkForgottenReturns(r, o, \"Promise.using\", C), r\n                            }), C = w.lastly(function () {\n                                var t = new e.PromiseInspection(w);\n                                return l(c, t)\n                            });\n                            return c.promise = C, C._setOnCancel(c), C\n                        }, e.prototype._setDisposable = function (t) {\n                            this._bitField = 131072 | this._bitField, this._disposer = t\n                        }, e.prototype._isDisposable = function () {\n                            return (131072 & this._bitField) > 0\n                        }, e.prototype._getDisposer = function () {\n                            return this._disposer\n                        }, e.prototype._unsetDisposable = function () {\n                            this._bitField = -131073 & this._bitField, this._disposer = void 0\n                        }, e.prototype.disposer = function (t) {\n                            if (\"function\" == typeof t)return new p(t, this, i());\n                            throw new d\n                        }\n                    }\n                }, {\"./errors\": 12, \"./util\": 36}], 36: [function (t, e, n) {\n                    \"use strict\";\n                    function r() {\n                        try {\n                            var t = P;\n                            return P = null, t.apply(this, arguments)\n                        } catch (e) {\n                            return T.e = e, T\n                        }\n                    }\n\n                    function i(t) {\n                        return P = t, r\n                    }\n\n                    function o(t) {\n                        return null == t || t === !0 || t === !1 || \"string\" == typeof t || \"number\" == typeof t\n                    }\n\n                    function s(t) {\n                        return \"function\" == typeof t || \"object\" == typeof t && null !== t\n                    }\n\n                    function a(t) {\n                        return o(t) ? new Error(v(t)) : t\n                    }\n\n                    function c(t, e) {\n                        var n, r = t.length, i = new Array(r + 1);\n                        for (n = 0; r > n; ++n)i[n] = t[n];\n                        return i[n] = e, i\n                    }\n\n                    function l(t, e, n) {\n                        if (!F.isES5)return {}.hasOwnProperty.call(t, e) ? t[e] : void 0;\n                        var r = Object.getOwnPropertyDescriptor(t, e);\n                        return null != r ? null == r.get && null == r.set ? r.value : n : void 0\n                    }\n\n                    function u(t, e, n) {\n                        if (o(t))return t;\n                        var r = {value: n, configurable: !0, enumerable: !1, writable: !0};\n                        return F.defineProperty(t, e, r), t\n                    }\n\n                    function p(t) {\n                        throw t\n                    }\n\n                    function h(t) {\n                        try {\n                            if (\"function\" == typeof t) {\n                                var e = F.names(t.prototype), n = F.isES5 && e.length > 1, r = e.length > 0 && !(1 === e.length && \"constructor\" === e[0]), i = A.test(t + \"\") && F.names(t).length > 0;\n                                if (n || r || i)return !0\n                            }\n                            return !1\n                        } catch (o) {\n                            return !1\n                        }\n                    }\n\n                    function f(t) {\n                        function e() {\n                        }\n\n                        e.prototype = t;\n                        for (var n = 8; n--;)new e;\n                        return t\n                    }\n\n                    function _(t) {\n                        return D.test(t)\n                    }\n\n                    function d(t, e, n) {\n                        for (var r = new Array(t), i = 0; t > i; ++i)r[i] = e + i + n;\n                        return r\n                    }\n\n                    function v(t) {\n                        try {\n                            return t + \"\"\n                        } catch (e) {\n                            return \"[no string representation]\"\n                        }\n                    }\n\n                    function y(t) {\n                        return null !== t && \"object\" == typeof t && \"string\" == typeof t.message && \"string\" == typeof t.name\n                    }\n\n                    function m(t) {\n                        try {\n                            u(t, \"isOperational\", !0)\n                        } catch (e) {\n                        }\n                    }\n\n                    function g(t) {\n                        return null == t ? !1 : t instanceof Error.__BluebirdErrorTypes__.OperationalError || t.isOperational === !0\n                    }\n\n                    function b(t) {\n                        return y(t) && F.propertyIsWritable(t, \"stack\")\n                    }\n\n                    function w(t) {\n                        return {}.toString.call(t)\n                    }\n\n                    function C(t, e, n) {\n                        for (var r = F.names(t), i = 0; i < r.length; ++i) {\n                            var o = r[i];\n                            if (n(o))try {\n                                F.defineProperty(e, o, F.getDescriptor(t, o))\n                            } catch (s) {\n                            }\n                        }\n                    }\n\n                    function j(t, e) {\n                        return H ? process.env[t] : e\n                    }\n\n                    function k() {\n                        if (\"function\" == typeof Promise)try {\n                            var t = new Promise(function () {\n                            });\n                            if (\"[object Promise]\" === {}.toString.call(t))return Promise\n                        } catch (e) {\n                        }\n                    }\n\n                    function E(t, e) {\n                        return t.bind(e)\n                    }\n\n                    var F = t(\"./es5\"), x = \"undefined\" == typeof navigator, T = {e: {}}, P, R = \"undefined\" != typeof self ? self : \"undefined\" != typeof window ? window : \"undefined\" != typeof global ? global : void 0 !== this ? this : null, S = function (t, e) {\n                        function n() {\n                            this.constructor = t, this.constructor$ = e;\n                            for (var n in e.prototype)r.call(e.prototype, n) && \"$\" !== n.charAt(n.length - 1) && (this[n + \"$\"] = e.prototype[n])\n                        }\n\n                        var r = {}.hasOwnProperty;\n                        return n.prototype = e.prototype, t.prototype = new n, t.prototype\n                    }, O = function () {\n                        var t = [Array.prototype, Object.prototype, Function.prototype], e = function (e) {\n                            for (var n = 0; n < t.length; ++n)if (t[n] === e)return !0;\n                            return !1\n                        };\n                        if (F.isES5) {\n                            var n = Object.getOwnPropertyNames;\n                            return function (t) {\n                                for (var r = [], i = Object.create(null); null != t && !e(t);) {\n                                    var o;\n                                    try {\n                                        o = n(t)\n                                    } catch (s) {\n                                        return r\n                                    }\n                                    for (var a = 0; a < o.length; ++a) {\n                                        var c = o[a];\n                                        if (!i[c]) {\n                                            i[c] = !0;\n                                            var l = Object.getOwnPropertyDescriptor(t, c);\n                                            null != l && null == l.get && null == l.set && r.push(c)\n                                        }\n                                    }\n                                    t = F.getPrototypeOf(t)\n                                }\n                                return r\n                            }\n                        }\n                        var r = {}.hasOwnProperty;\n                        return function (n) {\n                            if (e(n))return [];\n                            var i = [];\n                            t:for (var o in n)if (r.call(n, o))i.push(o); else {\n                                for (var s = 0; s < t.length; ++s)if (r.call(t[s], o))continue t;\n                                i.push(o)\n                            }\n                            return i\n                        }\n                    }(), A = /this\\s*\\.\\s*\\S+\\s*=/, D = /^[a-z$_][a-z$_0-9]*$/i, V = function () {\n                        return \"stack\" in new Error ? function (t) {\n                            return b(t) ? t : new Error(v(t))\n                        } : function (t) {\n                            if (b(t))return t;\n                            try {\n                                throw new Error(v(t))\n                            } catch (e) {\n                                return e\n                            }\n                        }\n                    }(), I = function (t) {\n                        return F.isArray(t) ? t : null\n                    };\n                    if (\"undefined\" != typeof Symbol && Symbol.iterator) {\n                        var L = \"function\" == typeof Array.from ? function (t) {\n                            return Array.from(t)\n                        } : function (t) {\n                            for (var e, n = [], r = t[Symbol.iterator](); !(e = r.next()).done;)n.push(e.value);\n                            return n\n                        };\n                        I = function (t) {\n                            return F.isArray(t) ? t : null != t && \"function\" == typeof t[Symbol.iterator] ? L(t) : null\n                        }\n                    }\n                    var H = \"undefined\" != typeof process && \"[object process]\" === w(process).toLowerCase(), N = {\n                        isClass: h,\n                        isIdentifier: _,\n                        inheritedDataKeys: O,\n                        getDataPropertyOrDefault: l,\n                        thrower: p,\n                        isArray: F.isArray,\n                        asArray: I,\n                        notEnumerableProp: u,\n                        isPrimitive: o,\n                        isObject: s,\n                        isError: y,\n                        canEvaluate: x,\n                        errorObj: T,\n                        tryCatch: i,\n                        inherits: S,\n                        withAppended: c,\n                        maybeWrapAsError: a,\n                        toFastProperties: f,\n                        filledRange: d,\n                        toString: v,\n                        canAttachTrace: b,\n                        ensureErrorObject: V,\n                        originatesFromRejection: g,\n                        markAsOriginatingFromRejection: m,\n                        classString: w,\n                        copyDescriptors: C,\n                        hasDevTools: \"undefined\" != typeof chrome && chrome && \"function\" == typeof chrome.loadTimes,\n                        isNode: H,\n                        env: j,\n                        global: R,\n                        getNativePromise: k,\n                        domainBind: E\n                    };\n                    N.isRecentNode = N.isNode && function () {\n                            var t = process.versions.node.split(\".\").map(Number);\n                            return 0 === t[0] && t[1] > 10 || t[0] > 0\n                        }(), N.isNode && N.toFastProperties(process);\n                    try {\n                        throw new Error\n                    } catch (B) {\n                        N.lastLineError = B\n                    }\n                    e.exports = N\n                }, {\"./es5\": 13}]\n            }, {}, [4])(4)\n        }), \"undefined\" != typeof window && null !== window ? window.P = window.Promise : \"undefined\" != typeof self && null !== self && (self.P = self.Promise);\n    }\n}();*/\n\nclass TicketmasterCalendarWidget {\n\n    set config(attrs) { this.widgetConfig = this.loadConfig(attrs); }\n\n    get config() { return this.widgetConfig; }\n\n    set events(responce){ this.eventsList = this.parseEvents(responce);}\n\n    get events(){ return this.eventsList;}\n\n    get borderSize(){ return this.config.border || 0;}\n\n    get widgetHeight(){ return this.config.height || 600;}\n\n    get widgetContentHeight() {\n        /* return this.widgetHeight - (this.isListView || this.isSimpleProportionM ? 0 : 39) || 600; */\n        return this.widgetHeight - 70;\n    }\n\n    get eventUrl(){ return \"http://www.ticketmaster.com/event/\"; }\n\n    get apiUrl(){ return \"https://app.ticketmaster.com/discovery/v2/events.json\"; }\n\n    get themeUrl() {\n        return (window.location.host === 'developer.ticketmaster.com')\n          ? `http://developer.ticketmaster.com/products-and-docs/widgets/calendar/1.0.0/theme/`\n          : `https://ticketmaster-api-staging.github.io/products-and-docs/widgets/calendar/1.0.0/theme/`;\n    }\n\n    get portalUrl(){\n        return (window.location.host === 'developer.ticketmaster.com')\n          ? `http://developer.ticketmaster.com/`\n          : `https://ticketmaster-api-staging.github.io/`;\n    }\n\n    get logoUrl() { return \"http://www.ticketmaster.com/\"; }\n\n    get legalNoticeUrl() { return \"http://developer.ticketmaster.com/support/terms-of-use/\"; }\n\n    get questionUrl() { return \"http://developer.ticketmaster.com/support/faq/\"; }\n\n    get widgetVersion() { return `${__VERSION__}`; }\n\n    get geocodeUrl() { return \"https://maps.googleapis.com/maps/api/geocode/json\"; }\n\n    get updateExceptions() { return [\"width\", \"height\", \"border\", \"borderradius\", \"colorscheme\", \"layout\", \"affiliateid\", \"propotion\", \"googleapikey\"]}\n\n    get sliderDelay(){ return 5000; }\n\n    get sliderRestartDelay(){ return 5000; }\n\n    get hideMessageDelay(){ return 5000; }\n\n    get controlHiddenClass(){ return \"events_control-hidden\"; }\n\n    get tmWidgetWhiteList(){ return [\"2200504BAD4C848F\", \"00005044BDC83AE6\", \"1B005068DB60687F\", \"1B004F4DBEE45E47\", \"3A004F4ED7829D5E\", \"3A004F4ED1FC9B63\", \"1B004F4FF83289C5\", \"1B004F4FC0276888\", \"0E004F4F3B7DC543\", \"1D004F4F09C61861\", \"1600505AC9A972A1\", \"22004F4FD82795C6\", \"01005057AFF54574\", \"01005056FAD8793A\", \"3A004F4FB2453240\", \"22004F50D2149AC6\", \"01005059AD49507A\", \"01005062B4236D5D\"]; }\n\n    get countriesWhiteList() {\n        return [\n            'Australia',\n            'Austria',\n            'Belgium',\n            'Canada',\n            'Denmark',\n            'Finland',\n            'France',\n            'Germany',\n            'Ireland',\n            'Mexico',\n            'Netherlands',\n            'New Zealand',\n            'Norway',\n            'Spain',\n            'Sweden',\n            'Turkey',\n            'UAE',\n            'United Kingdom',\n            'United States'\n        ]\n    }\n\n    isConfigAttrExistAndNotEmpty(attr) {\n        if( !this.config.hasOwnProperty(attr) || this.config[attr] === \"undefined\"){\n            return false;\n        }else if( this.config[attr] === \"\"){\n            return false;\n        }\n        return true;\n    }\n\n    get eventReqAttrs(){\n        let attrs = {},\n            params = [\n                {\n                    attr: 'tmapikey',\n                    verboseName: 'apikey'\n                },\n                {\n                    attr: 'keyword',\n                    verboseName: 'keyword'\n                },\n                {\n                    attr: 'size',\n                    verboseName: 'size'\n                },\n                {\n                    attr: 'radius',\n                    verboseName: 'radius'\n                },\n                {\n                    attr: 'classificationid',\n                    verboseName: 'classificationId'\n                },\n                {\n                    attr: 'attractionid',\n                    verboseName: 'attractionId'\n                },\n                {\n                    attr: 'promoterid',\n                    verboseName: 'promoterId'\n                },\n                {\n                    attr: 'venueid',\n                    verboseName: 'venueId'\n                },\n                {\n                    attr: 'city',\n                    verboseName: 'city'\n                },\n                {\n                    attr: 'countrycode',\n                    verboseName: 'countryCode'\n                },\n                {\n                    attr: 'segmentid',\n                    verboseName: 'segmentId'\n                }\n            ];\n\n        for(let i in params){\n            let item = params[i];\n            if(this.isConfigAttrExistAndNotEmpty(item.attr))\n                attrs[item.verboseName] = this.config[item.attr];\n        }\n\n        // Only one allowed at the same time\n        if(this.config.latlong){\n            attrs.latlong = this.config.latlong;\n            if (this.widgetRoot.getAttribute('w-postalcodeapi') != null) {\n                this.config.latlong = '';\n            }\n            if (this.widgetRoot.getAttribute('w-latlong') != null && this.widgetRoot.getAttribute('w-latlong') != '34.0390107,-118.2672801') {\n                attrs.latlong = this.widgetRoot.getAttribute('w-latlong');\n                attrs.postalCode = '';\n                this.config.postalcode = '';\n            }\n        } else {\n            if(this.isConfigAttrExistAndNotEmpty(\"postalcode\"))\n                attrs.postalCode = this.config.postalcode;\n        }\n\n        if (this.config.countrycode != null) {\n            attrs.latlong = '';\n            this.config.latlong = '';\n            this.widgetRoot.setAttribute('w-latlong', '');\n        }\n\n        if(this.isConfigAttrExistAndNotEmpty(\"period\")){\n            let period = this.getDateFromPeriod(this.config.period);\n            attrs.startDateTime = period[0];\n            attrs.endDateTime = period[1];\n        }\n\n        if (this.config.period != 'week') {\n            let period_ = new Date(this.config.period);\n            let firstDay = new Date(period_);\n            let lastDay = new Date(period_);\n            firstDay.setDate(firstDay.getDate() + 1);\n            lastDay.setDate(lastDay.getDate() + 1);\n            firstDay.setHours(0);   lastDay.setHours(23);\n            firstDay.setMinutes(0); lastDay.setMinutes(59);\n            firstDay.setSeconds(0); lastDay.setSeconds(59);\n            attrs.startDateTime = this.toShortISOString(firstDay);\n            attrs.endDateTime = this.toShortISOString(lastDay);\n        }\n\n        return attrs;\n    }\n\n    constructor(root) {\n        if(!root) return;\n        this.widgetRoot = root;\n\n        if (this.widgetRoot.querySelector('.tabs-container') != null) return;\n\n        this.tabsRootContainer = document.createElement(\"div\");\n        this.tabsRootContainer.classList.add(\"tabs\");\n        this.tabsRootContainer.innerHTML = '<span class=\"tb active\">Day</span><span class=\"tb\">Week</span><span class=\"tb\">Month</span><span class=\"tb\">Year</span>';\n        this.widgetRoot.appendChild(this.tabsRootContainer);\n\n        this.tabsRootContainer = document.createElement(\"div\");\n        this.tabsRootContainer.classList.add(\"tabs-container\");\n        this.widgetRoot.appendChild(this.tabsRootContainer);\n\n        this.tab1RootContainer = document.createElement(\"div\");\n        this.tab1RootContainer.classList.add(\"tab\");\n        this.tab1RootContainer.classList.add(\"active\");\n        this.tabsRootContainer.appendChild(this.tab1RootContainer);\n\n        let leftSelector = new SelectorControls(this.tab1RootContainer, 'sliderLeftSelector', this.getCurrentWeek(), 'period', this.update.bind(this));\n        let RightSelector = new SelectorControls(this.tab1RootContainer, 'sliderRightSelector', '<span class=\"selector-title\">All Events</span><span class=\"selector-content\" tabindex=\"-1\"><span class=\"active\" w-classificationId=\"\">All Events</span><span w-classificationId=\"KZFzniwnSyZfZ7v7na\">Arts & Theatre</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nn\">Film</span><span w-classificationId=\"KZFzniwnSyZfZ7v7n1\">Miscellaneous</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nJ\">Music</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nE\">Sports</span></span>', 'classificationId', this.update.bind(this));\n\n\n\n        this.tab2RootContainer = document.createElement(\"div\");\n        this.tab2RootContainer.classList.add(\"tab\");\n        this.tab2RootContainer.innerHTML = '<div class=\"weekSсheduler\"><div class=\"spinner-container\"><div class=\"spinner\"><div class=\"rect1\"></div><div class=\"rect2\"></div><div class=\"rect3\"></div><div class=\"rect4\"></div><div class=\"rect5\"></div></div></div>';\n        this.tabsRootContainer.appendChild(this.tab2RootContainer);\n        this.eventLogoBox = document.createElement(\"div\");\n        this.eventLogoBox.classList.add(\"event-logo-box-c\");\n        this.eventLogoBox.innerHTML = '<a class=\"event-logo-c\" target=\"_blank\" href=\"http://www.ticketmaster.com/\">Powered by:</a>';\n        this.tab2RootContainer.appendChild(this.eventLogoBox);\n\n\n        this.tab3RootContainer = document.createElement(\"div\");\n        this.tab3RootContainer.classList.add(\"tab\");\n        this.tab3RootContainer.innerHTML = '<div class=\"monthScheduler\"><div class=\"spinner-container\"><div class=\"spinner\"><div class=\"rect1\"></div><div class=\"rect2\"></div><div class=\"rect3\"></div><div class=\"rect4\"></div><div class=\"rect5\"></div></div></div>';\n        this.tabsRootContainer.appendChild(this.tab3RootContainer);\n        this.eventLogoBox = document.createElement(\"div\");\n        this.eventLogoBox.classList.add(\"event-logo-box-c\");\n        this.eventLogoBox.innerHTML = '<a class=\"event-logo-c\" target=\"_blank\" href=\"http://www.ticketmaster.com/\">Powered by:</a>';\n        this.tab3RootContainer.appendChild(this.eventLogoBox);\n\n        this.tab4RootContainer = document.createElement(\"div\");\n        this.tab4RootContainer.classList.add(\"tab\");\n        this.tab4RootContainer.innerHTML = '<div class=\"yearScheduler\"><div class=\"spinner-container\"><div class=\"spinner\"><div class=\"rect1\"></div><div class=\"rect2\"></div><div class=\"rect3\"></div><div class=\"rect4\"></div><div class=\"rect5\"></div></div></div>';\n        this.tabsRootContainer.appendChild(this.tab4RootContainer);\n        this.eventLogoBox = document.createElement(\"div\");\n        this.eventLogoBox.classList.add(\"event-logo-box-c\");\n        this.eventLogoBox.innerHTML = '<a class=\"event-logo-c\" target=\"_blank\" href=\"http://www.ticketmaster.com/\">Powered by:</a>';\n        this.tab4RootContainer.appendChild(this.eventLogoBox);\n\n        this.eventsRootContainer = document.createElement(\"div\");\n        this.eventsRootContainer.classList.add(\"events-root-container\");\n        this.eventsRootContainer.innerHTML = '<div class=\"spinner-container\"><div class=\"spinner\"><div class=\"rect1\"></div><div class=\"rect2\"></div><div class=\"rect3\"></div><div class=\"rect4\"></div><div class=\"rect5\"></div></div></div>';\n        this.tab1RootContainer.appendChild(this.eventsRootContainer);\n\n        this.eventsRoot = document.createElement(\"ul\");\n        this.eventsRoot.classList.add(\"events-root\");\n        this.eventsRootContainer.appendChild(this.eventsRoot);\n\n        this.config = this.widgetRoot.attributes;\n\n        if(this.config.theme !== null && !document.getElementById(`widget-theme-${this.config.theme}`)){\n            this.makeRequest( this.styleLoadingHandler, this.themeUrl + this.config.theme + \".css\" );\n        }\n\n        this.eventsRootContainer.classList.remove(\"border\");\n        if(this.config.border){\n            this.eventsRootContainer.classList.add(\"border\");\n        }\n\n        this.widgetRoot.style.height = `${this.widgetHeight}px`;\n        this.widgetRoot.style.width  = `${this.config.width}px`;\n\n        this.eventsRootContainer.style.height = `${this.widgetContentHeight}px`;\n        this.eventsRootContainer.style.width  = `${this.config.width}px`;\n        this.eventsRootContainer.style.borderWidth = `0`;\n        this.widgetRoot.style.borderRadius = `${this.config.borderradius}px`;\n        this.widgetRoot.style.borderWidth = `${this.borderSize}px`;\n\n        //this.clear();\n\n        this.AdditionalElements();\n\n        this.getCoordinates(() => {\n            this.makeRequest( this.eventsLoadingHandler, this.apiUrl, this.eventReqAttrs );\n        });\n\n        /*plugins for 'buy button'*/\n        this.embedUniversePlugin();\n        this.embedTMPlugin();\n\n        this.initBuyBtn();\n\n        this.initMessage();\n\n        this.initSliderControls();\n\n        /* if (!this.isListView) this.initEventCounter(); */\n    }\n\n    getCurrentWeek() {\n        let monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n        let content = '<span class=\"selector-title\">';\n        let today = new Date();\n        let todayTmp = new Date();\n        content += monthNames[today.getMonth()] + ' ' + today.getDate();\n        content += '</span>';\n        content += '<span class=\"selector-content\" tabindex=\"-1\">';\n\n        for (var d=0; d<=6; d++) {\n            todayTmp.setDate(today.getDate() + d);\n            if (d == 0) content += `<span class=\"active\" w-period=\"${todayTmp}\">`;\n            else content += `<span w-period=\"${todayTmp}\">`;\n            content += monthNames[todayTmp.getMonth()] + ' ' + todayTmp.getDate();\n            content += '</span>';\n            todayTmp = new Date();\n        }\n        content += '</span>';\n        return content;\n    }\n\n    getCoordinates(cb){\n        let widget = this;\n\n        function parseGoogleGeocodeResponse(){\n            if (this && this.readyState === XMLHttpRequest.DONE ) {\n                let latlong = '',\n                    results = null,\n                    countryShortName = '';\n                if(this.status === 200) {\n                    let response = JSON.parse(this.responseText);\n                    if (response.status === 'OK' && response.results.length) {\n                        // Filtering only white list countries\n                        results = response.results.filter((item) => {\n                            return widget.countriesWhiteList.filter((elem) => {\n                                    return elem === item.address_components[item.address_components.length - 1].long_name;\n                                }).length > 0;\n                        });\n\n                        if (results.length) {\n                            // sorting results by country name\n                            results.sort((f, g) => {\n                                let a = f.address_components[f.address_components.length - 1].long_name;\n                                let b = g.address_components[g.address_components.length - 1].long_name;\n                                if (a > b) {\n                                    return 1;\n                                }\n                                if (a < b) {\n                                    return -1;\n                                }\n                                return 0;\n                            });\n\n                            // Use first item if multiple results was found in one country or in different\n                            let geometry = results[0].geometry;\n                            countryShortName = results[0].address_components[results[0].address_components.length - 1].short_name;\n\n                            // If multiple results without country try to find USA as prefer value\n                            if (!widget.config.country) {\n                                for (let i in results) {\n                                    let result = results[i];\n                                    if (result.address_components) {\n                                        let country = result.address_components[result.address_components.length - 1];\n                                        if (country) {\n                                            if (country.short_name === 'US') {\n                                                countryShortName = 'US';\n                                                geometry = result.geometry;\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n\n                            if (geometry) {\n                                if (geometry.location) {\n                                    latlong = `${geometry.location.lat},${geometry.location.lng}`;\n                                }\n                            }\n                        } else {\n                            results = null;\n                        }\n                    }\n                }\n                if(widget.onLoadCoordinate) widget.onLoadCoordinate(results, countryShortName);\n                widget.config.latlong = latlong;\n                if (widget.config.latlong == null) widget.config.latlong = \"34.0390107,-118.2672801\";\n                if (document.querySelector('[w-type=\"calendar\"]').getAttribute(\"w-country\") != null) {\n                    widget.config.latlong = '';\n                    latlong = '';\n                };\n                cb(widget.config.latlong);\n                document.querySelector('[w-type=\"calendar\"]').setAttribute(\"w-latlong\", latlong);\n            }\n        }\n\n        if(this.isConfigAttrExistAndNotEmpty('postalcode')){\n            let args = {language: 'en', components: `postal_code:${widget.config.postalcode}`};\n            if(widget.config.googleapikey) args.key = widget.config.googleapikey;\n            if(this.config.country) args.components += `|country:${this.config.country}`;\n            this.makeRequest( parseGoogleGeocodeResponse, this.geocodeUrl, args);\n        }else{\n            // Used in builder\n            if(widget.onLoadCoordinate) widget.onLoadCoordinate(null);\n            widget.config.latlong = '34.0390107,-118.2672801';\n            widget.config.country = 'US';\n            cb(widget.config.latlong);\n            if (document.getElementById('w-keyword').value != '') {\n                document.querySelector('[w-type=\"calendar\"]').setAttribute(\"w-latlong\", '');\n            }\n        }\n    }\n\n    initBuyBtn(){\n        this.buyBtn = document.createElement(\"a\");\n        this.buyBtn.appendChild(document.createTextNode('BUY NOW'));\n        this.buyBtn.classList.add(\"event-buy-btn\");\n        this.buyBtn.classList.add(\"main-btn\");\n        this.buyBtn.target = '_blank';\n        this.buyBtn.href = '';\n        this.buyBtn.setAttribute('onclick', \"ga('send', 'event', 'DiscoveryClickBuyButton', 'click');\");\n        this.buyBtn.addEventListener('click', (e)=> {\n            e.preventDefault(); /*used in plugins for 'buy button'*/\n            this.stopAutoSlideX();\n        });\n        this.eventsRootContainer.appendChild(this.buyBtn);\n    }\n\n    setBuyBtnUrl(){\n        if(this.buyBtn){\n            let event = this.eventsGroups[this.currentSlideX][this.currentSlideY],\n                url = '';\n            if(event){\n                if(event.url){\n\n                    if((this.isUniversePluginInitialized && this.isUniverseUrl(event.url)) || (this.isTMPluginInitialized && this.isAllowedTMEvent(event.url))){\n                        url = event.url;\n                    }\n                }\n            }\n            this.buyBtn.href = url;\n        }\n    }\n\n    isUniverseUrl(url){\n        return (url.match(/universe.com/g) || url.match(/uniiverse.com/g));\n    }\n\n    isAllowedTMEvent(url){\n        for (var t = [/(?:ticketmaster\\.com)\\/(.*\\/)?event\\/([^\\/?#]+)/, /(?:concerts\\.livenation\\.com)\\/(.*\\/)?event\\/([^\\/?#]+)/], n = null, r = 0; r < t.length && (n = url.match(t[r]), null === n); r++);\n        let id = (null !== n ? n[2] : void 0);\n        return (this.tmWidgetWhiteList.indexOf(id) > -1);\n    }\n\n    embedTMPlugin(){\n        let id = 'id_tm_widget';\n        if( !document.getElementById(id) ) {\n            let script = document.createElement('script');\n            script.setAttribute('src', this.portalUrl + 'scripts/vendors/tm.js');\n            script.setAttribute('type', 'text/javascript');\n            script.setAttribute('charset', 'UTF-8');\n            script.setAttribute('id', id);\n            (document.head || document.getElementsByTagName('head')[0]).appendChild(script);\n        }\n        this.isTMPluginInitialized = true;\n    }\n\n    embedUniversePlugin(){\n        let id = 'id_universe_widget';\n        if( !document.getElementById(id) ){\n            let script = document.createElement('script');\n            script.setAttribute('src', 'https://www.universe.com/embed.js');\n            script.setAttribute('type', 'text/javascript');\n            script.setAttribute('charset', 'UTF-8');\n            script.setAttribute('id', id);\n            (document.head || document.getElementsByTagName('head')[0]).appendChild(script);\n        }\n        this.isUniversePluginInitialized = true;\n    }\n\n    initMessage(){\n        this.messageDialog = document.createElement('div');\n        this.messageDialog.classList.add(\"event-message\");\n        this.messageContent = document.createElement('div');\n        this.messageContent.classList.add(\"event-message__content\");\n\n        let messageClose = document.createElement('div');\n        messageClose.classList.add(\"event-message__btn\");\n        messageClose.addEventListener(\"click\", ()=> {\n            this.hideMessage();\n        });\n\n        this.messageDialog.appendChild(this.messageContent);\n        this.messageDialog.appendChild(messageClose);\n        this.eventsRootContainer.appendChild(this.messageDialog);\n    }\n\n    showMessage(message, hideMessageWithoutDelay){\n        if(message.length){\n            this.hideMessageWithoutDelay = hideMessageWithoutDelay;\n            this.messageContent.innerHTML = message;\n            this.messageDialog.classList.add(\"event-message-visible\");\n            if (this.messageTimeout) {\n                clearTimeout(this.messageTimeout); // Clear timeout if before 'hideMessageWithDelay' was called\n            }\n        }\n    }\n\n    hideMessageWithDelay(delay){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout if this method was called before\n        this.messageTimeout = setTimeout(()=>{\n            this.hideMessage();\n        }, delay);\n    }\n\n    hideMessage(){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout and hide message immediately.\n        this.messageDialog.classList.remove(\"event-message-visible\");\n    }\n\n    AdditionalElements(){\n        /*\n        var legalNoticeContent = document.createTextNode('Legal Notice'),\n            legalNotice = document.createElement(\"a\");\n        legalNotice.appendChild(legalNoticeContent);\n        legalNotice.classList.add(\"legal-notice\");\n        legalNotice.target = '_blank';\n        legalNotice.href = this.legalNoticeUrl;\n        this.widgetRoot.appendChild(legalNotice);\n        */\n        var logo = document.createElement('a');\n        logo.classList.add(\"event-logo\");\n        logo.target = '_blank';\n        logo.href = this.logoUrl;\n        logo.innerHTML = 'Powered by:';\n\n        var logoBox = document.createElement('div');\n        logoBox.classList.add(\"event-logo-box\");\n        logoBox.appendChild(logo);\n        this.eventsRootContainer.appendChild(logoBox);\n\n        let question = document.createElement('span');\n        question.classList.add(\"event-question\");\n        question.target = '_blank';\n        question.href = this.questionUrl;\n        question.addEventListener('click', toolTipHandler);\n        this.widgetRoot.appendChild(question);\n\n        let toolTip = document.createElement('div'),\n            tooltipHtml = `\n              <div class=\"tooltip-inner\"> \n                <a href=\"${this.questionUrl}\" target = \"_blank\" >About widget</a>\n                <div class=\"place\">version: <b>${this.widgetVersion}</b></div>\n              </div>`;\n        toolTip.classList.add(\"tooltip-version\");\n        toolTip.classList.add(\"left\");\n        toolTip.innerHTML = tooltipHtml;\n        this.widgetRoot.appendChild(toolTip);\n\n        function toolTipHandler(e) {\n            e.preventDefault();\n            e.target.nextSibling.classList.toggle('show-tip');\n        }\n    }\n\n    hideSliderControls(){\n        this.prevEventX.classList.add(this.controlHiddenClass);\n        this.nextEventX.classList.add(this.controlHiddenClass);\n        this.prevEventY.classList.add(this.controlHiddenClass);\n        this.nextEventY.classList.add(this.controlHiddenClass);\n    }\n\n    toggleControlsVisibility(){\n        // Horizontal\n        if(this.slideCountX > 1){\n            this.prevEventX.classList.remove(this.controlHiddenClass);\n            this.nextEventX.classList.remove(this.controlHiddenClass);\n            if(this.currentSlideX === 0){\n                this.prevEventX.classList.add(this.controlHiddenClass);\n            }else if(this.currentSlideX === this.slideCountX - 1){\n                this.nextEventX.classList.add(this.controlHiddenClass);\n            }\n        }else{\n            this.prevEventX.classList.add(this.controlHiddenClass);\n            this.nextEventX.classList.add(this.controlHiddenClass);\n        }\n\n        // Vertical\n        if(this.eventsGroups.length){\n            if(this.eventsGroups[this.currentSlideX].length > 1){\n                this.prevEventY.classList.remove(this.controlHiddenClass);\n                this.nextEventY.classList.remove(this.controlHiddenClass);\n                if(this.currentSlideY === 0){\n                    this.prevEventY.classList.add(this.controlHiddenClass);\n                }else if(this.currentSlideY === this.eventsGroups[this.currentSlideX].length - 1){\n                    this.nextEventY.classList.add(this.controlHiddenClass);\n                }\n            }else{\n                this.prevEventY.classList.add(this.controlHiddenClass);\n                this.nextEventY.classList.add(this.controlHiddenClass);\n            }\n        }else{\n            this.prevEventY.classList.add(this.controlHiddenClass);\n            this.nextEventY.classList.add(this.controlHiddenClass);\n        }\n    }\n\n    prevSlideX(){\n        if(this.currentSlideX > 0){\n            this.setSlideManually(this.currentSlideX - 1, true);\n        }\n    }\n\n    nextSlideX(){\n        if(this.slideCountX - 1 > this.currentSlideX) {\n            this.setSlideManually(this.currentSlideX + 1, true);\n        }\n    }\n\n    prevSlideY(){\n        if(this.currentSlideY > 0){\n            this.setSlideManually(this.currentSlideY - 1, false);\n        }\n    }\n\n    nextSlideY(){\n        if(this.eventsGroups[this.currentSlideX].length - 1 > this.currentSlideY) {\n            this.setSlideManually(this.currentSlideY + 1, false);\n        }\n    }\n\n    setSlideManually(slideIndex, isDirectionX){\n        this.stopAutoSlideX();\n        this.sliderTimeout = setTimeout(()=>{\n            this.runAutoSlideX();\n        }, this.sliderRestartDelay);\n        if(isDirectionX)\n            this.goToSlideX(slideIndex);\n        else\n            this.goToSlideY(slideIndex);\n    }\n\n    goToSlideX(slideIndex){\n        if(this.currentSlideX === slideIndex) return;\n        this.currentSlideY = 0;\n        this.currentSlideX = slideIndex;\n        this.eventsRoot.style.marginLeft = `-${this.currentSlideX * 100}%`;\n        this.toggleControlsVisibility();\n        this.setEventsCounter();\n        this.setBuyBtnUrl();\n    }\n\n    goToSlideY(slideIndex){\n        if(this.currentSlideY === slideIndex) return;\n        this.currentSlideY = slideIndex;\n        let eventGroup = this.eventsRoot.getElementsByClassName(\"event-group-\" + this.currentSlideX);\n        if(eventGroup.length){\n            eventGroup = eventGroup[0];\n            eventGroup.style.marginTop = `-${this.currentSlideY * (this.widgetContentHeight - this.borderSize * 2)}px`;\n            this.toggleControlsVisibility();\n            this.setBuyBtnUrl();\n        }\n    }\n\n    runAutoSlideX(){\n        if(this.slideCountX > 1) {\n            this.sliderInterval = setInterval(()=> {\n                var slideIndex = 0;\n                if (this.slideCountX - 1 > this.currentSlideX) slideIndex = this.currentSlideX + 1;\n                this.goToSlideX(slideIndex);\n            }, this.sliderDelay);\n        }\n    }\n\n    stopAutoSlideX(){\n        if(this.sliderTimeout) clearTimeout(this.sliderTimeout);\n        if(this.sliderInterval) clearInterval(this.sliderInterval);\n    }\n\n    initSliderControls(){\n        this.currentSlideX = 0;\n        this.currentSlideY = 0;\n        this.slideCountX = 0;\n        let coreCssClass = 'events_control';\n\n        // left btn\n        this.prevEventX = document.createElement(\"div\");\n        let prevEventXClass = [coreCssClass, coreCssClass + '-horizontal', coreCssClass + '-left', this.controlHiddenClass];\n        for(let i in prevEventXClass){\n            this.prevEventX.classList.add(prevEventXClass[i]);\n        }\n        this.eventsRootContainer.appendChild(this.prevEventX);\n\n        // right btn\n        this.nextEventX = document.createElement(\"div\");\n        let nextEventXClass = [coreCssClass, coreCssClass + '-horizontal', coreCssClass + '-right', this.controlHiddenClass];\n        for(let i in nextEventXClass){\n            this.nextEventX.classList.add(nextEventXClass[i]);\n        }\n        this.eventsRootContainer.appendChild(this.nextEventX);\n\n        // top btn\n        this.prevEventY = document.createElement(\"div\");\n        let prevEventYClass = [coreCssClass, coreCssClass + '-vertical', coreCssClass + '-top', this.controlHiddenClass];\n        for(let i in prevEventYClass ){\n            this.prevEventY.classList.add(prevEventYClass[i]);\n        }\n        this.eventsRootContainer.appendChild(this.prevEventY);\n\n        // bottom btn\n        this.nextEventY = document.createElement(\"div\");\n        let nextEventYClass = [coreCssClass, coreCssClass + '-vertical', coreCssClass + '-bottom', this.controlHiddenClass];\n        for(let i in nextEventYClass){\n            this.nextEventY.classList.add(nextEventYClass[i]);\n        }\n        this.eventsRootContainer.appendChild(this.nextEventY);\n\n        // Restore events group position\n        function whichTransitionEvent(){\n            let el = document.createElement('fakeelement'),\n                transitions = {\n                    'transition':'transitionend',\n                    'OTransition':'oTransitionEnd',\n                    'MozTransition':'transitionend',\n                    'WebkitTransition':'webkitTransitionEnd'\n                };\n\n            for(let event in transitions){\n                if( el.style[event] !== undefined ) return transitions[event];\n            }\n        }\n\n        var transitionEvent = whichTransitionEvent();\n        transitionEvent && this.eventsRoot.addEventListener(transitionEvent, (e)=> {\n            if (this.eventsRoot !== e.target) return;\n            let eventGroup = this.eventsRoot.getElementsByClassName(\"event-group\");\n            // Reset all groups. We don't know what event group was visible before.\n            for(let i = 0; eventGroup.length > i; i++){\n                eventGroup[i].style.marginTop = 0;\n            }\n        });\n\n        // Arrows\n        this.prevEventX.addEventListener(\"click\", ()=> {\n            this.prevSlideX();\n        });\n\n        this.nextEventX.addEventListener(\"click\", ()=> {\n            this.nextSlideX();\n        });\n\n        this.prevEventY.addEventListener(\"click\", ()=> {\n            this.prevSlideY();\n        });\n\n        this.nextEventY.addEventListener(\"click\", ()=> {\n            this.nextSlideY();\n        });\n\n        // Tough device swipes\n        let xDown = null,\n            yDown = null;\n\n        function handleTouchStart(evt) {\n            xDown = evt.touches[0].clientX;\n            yDown = evt.touches[0].clientY;\n        }\n\n        function handleTouchMove(evt) {\n            if ( ! xDown || ! yDown ) return;\n\n            let xUp = evt.touches[0].clientX,\n                yUp = evt.touches[0].clientY,\n                xDiff = xDown - xUp,\n                yDiff = yDown - yUp;\n\n            if ( Math.abs( xDiff ) > Math.abs( yDiff ) ) {\n                if ( xDiff > 0 )\n                    this.nextSlideX(); // left swipe\n                else\n                    this.prevSlideX(); // right swipe\n            } else {\n                if ( yDiff > 0 )\n                    this.nextSlideY(); // up swipe\n                else\n                    this.prevSlideY(); // down swipe\n            }\n\n            xDown = null;\n            yDown = null;\n        }\n\n        this.eventsRootContainer.addEventListener('touchstart', (e)=> {\n            if(this.config.theme !== \"listview\") { if (e.target.className != 'event-logo' && e.target.className != 'event-question') e.preventDefault(); } /*used in plugins for 'buy button'*/\n            handleTouchStart.call(this, e);\n        }, false);\n        this.eventsRootContainer.addEventListener('touchmove', (e)=> {\n            if(this.config.theme !== \"listview\") { if (e.target.className != 'event-logo' && e.target.className != 'event-question') e.preventDefault(); }\n            handleTouchMove.call(this, e);\n        }, false);\n    }\n\n    initSlider(){\n        if(this.sliderInterval) clearInterval(this.sliderInterval);\n        if(this.sliderTimeout) clearTimeout(this.sliderTimeout);\n        this.slideCountX = this.eventsGroups.length;\n        this.eventsRoot.style.marginLeft = '0%';\n        this.eventsRoot.style.width = `${this.slideCountX * 100}%`;\n        this.currentSlideX = 0;\n        this.currentSlideY = 0;\n        this.runAutoSlideX();\n        this.toggleControlsVisibility();\n        this.setBuyBtnUrl();\n    }\n\n    formatDate(date) {\n        var result = '';\n        if(!date.day) return result; // Day is required\n\n        function LZ(x) {\n            return (x < 0 || x > 9 ? \"\" : \"0\") + x\n        }\n        var MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\n            DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],\n            dayArray = date.day.split('-'),\n            d = parseInt(dayArray[2]),\n            M = parseInt(dayArray[1]);\n\n        // var E = new Date(date.day).getDay();\n        var E = new Date(+date.day.split('-')[0],(+date.day.split('-')[1])-1,+date.day.split('-')[2]).getDay();\n        result = DAY_NAMES[E] + ', ' + MONTH_NAMES[M - 1] + ' ' + d + ', ' + dayArray[0];\n\n        if(!date.time) return result;\n\n        var timeArray = date.time.split(':'),\n            H = parseInt(timeArray[0]),\n            m = timeArray[1],\n            a = \"AM\";\n\n        if (H > 11) a = \"PM\";\n        if (H == 0) {\n            H = 12;\n        } else if (H > 12) {\n            H = H - 12;\n        }\n\n        return result + ' ' + LZ(H) + ':' + m + ' ' + a;\n    }\n\n    clearEvents(){\n        this.eventsRoot.innerHTML = \"\";\n    }\n\n    clear(){\n        var modificatorList = this.widgetRoot.getElementsByClassName('modificator');\n        while (modificatorList.length) {\n            let el = modificatorList[0],\n                parent = el.parentNode;\n            parent.removeChild(el);\n        }\n\n        this.clearEvents();\n    }\n\n    update() {\n        let widget = this.eventsRootContainer;\n        let spinner = widget.querySelector('.spinner-container');\n        spinner.classList.remove('hide');\n        let oldTheme = this.config.constructor();\n        for (let attr in this.config) {\n            if (this.config.hasOwnProperty(attr)) oldTheme[attr] = this.config[attr];\n        }\n\n        this.config = this.widgetRoot.attributes;\n\n        this.widgetRoot.style.height = `${this.widgetHeight}px`;\n        this.widgetRoot.style.width  = `${this.config.width}px`;\n        this.widgetRoot.style.borderRadius = `${this.config.borderradius}px`;\n        this.widgetRoot.style.borderWidth = `${this.borderSize}px`;\n\n        this.getCurrentWeek();\n\n        this.eventsRootContainer.classList.remove(\"border\");\n\n        widget.querySelector('.events-root-container .spinner-container').classList.add('hide');\n\n        if( this.config.hasOwnProperty(\"border\") ){\n            this.eventsRootContainer.classList.add(\"border\");\n        }\n\n        if(!this.needToUpdate(this.config, oldTheme, this.updateExceptions) || this.needToUpdate(this.config, oldTheme, this.updateExceptions)){\n            this.clear();\n\n            this.getCoordinates(() => {\n                this.makeRequest( this.eventsLoadingHandler, this.apiUrl, this.eventReqAttrs );\n            });\n        }\n        else{\n            let events = this.eventsRoot.getElementsByClassName(\"event-wrapper\");\n            for(let i in events){\n                if(events.hasOwnProperty(i) && events[i].style !== undefined){\n                    events[i].style.width = `${this.config.width}px`;\n                    events[i].style.height = `${this.widgetContentHeight}px`;\n                }\n            }\n                this.goToSlideY(0);\n        }\n    }\n\n    needToUpdate(newTheme, oldTheme, forCheck = []){\n        return Object.keys(newTheme).map(function(key){\n                if(forCheck.indexOf(key) > -1) return true;\n                //console.warn([key, newTheme[key], oldTheme[key], newTheme[key] === oldTheme[key]])\n                return newTheme[key] === oldTheme[key] ;\n            }).indexOf(false) > -1\n    }\n\n    loadConfig(NamedNodeMap){\n        var config = {};\n        Object.keys(NamedNodeMap).map(function(value){\n            if( typeof(NamedNodeMap[value].name) !== \"undefined\" && NamedNodeMap[value].name.indexOf(\"w-\") !== -1){\n                config[ NamedNodeMap[value].name.replace(/w-/g, \"\").replace(/-/g, \"\") ] = NamedNodeMap[value].value;\n            }\n        });\n        return config;\n    }\n\n    styleLoadingHandler(){\n        if (this && this.readyState == XMLHttpRequest.DONE ) {\n            if(this.status == 200){\n                var style = document.createElement(\"style\");\n                style.setAttribute(\"type\",\"text/css\");\n                style.setAttribute(\"id\",`widget-theme-${this.widget.config.theme}`);\n                style.textContent = this.responseText;\n                document.getElementsByTagName(\"head\")[0].appendChild(style);\n            }\n            else {\n                console.log(\"theme wasn't loaded\");\n            }\n        }\n    }\n\n    groupEventsByName(){\n        let groups = {};\n        this.events.map(function(event){\n            if (groups[event.name] === undefined) groups[event.name] = [];\n            groups[event.name].push(event);\n        });\n\n        this.eventsGroups = [];\n        for (let groupName in groups) {\n            this.eventsGroups.push(groups[groupName]);\n        }\n    }\n\n    initEventCounter(){\n        this.eventsCounter = document.createElement(\"div\");\n        this.eventsCounter.classList.add(\"events-counter\");\n        this.widgetRoot.appendChild(this.eventsCounter);\n    }\n\n    setEventsCounter(){\n        if(this.eventsCounter){\n            let text = '';\n            if(this.eventsGroups.length){\n                if(this.eventsGroups.length > 1){\n                    text = `${this.currentSlideX + 1} of ${this.eventsGroups.length} events`;\n                } else {\n                    text = '1 event';\n                }\n            }\n            this.eventsCounter.innerHTML = text;\n        }\n    }\n\n    resetReduceParamsOrder(){\n        this.reduceParamsOrder = 0;\n    }\n\n    reduceParamsAndReloadEvents(){\n        let eventReqAttrs = {},\n            reduceParamsList = [\n                ['startDateTime', 'endDateTime', 'country'],\n                ['city'],\n                ['countryCode'],\n                ['radius'],\n                ['postalCode', 'latlong'],\n                ['classificationId'],\n                ['attractionId'],\n                ['promoterId'],\n                ['segmentId'],\n                ['venueId'],\n                ['keyword'],\n                ['size']\n            ];\n\n        // make copy of params\n        for(let key in this.eventReqAttrs){\n            eventReqAttrs[key] = this.eventReqAttrs[key]\n        }\n\n        if(!this.reduceParamsOrder) this.reduceParamsOrder = 0;\n        if(reduceParamsList.length > this.reduceParamsOrder){\n            for(let item in reduceParamsList){\n                if(this.reduceParamsOrder >= item){\n                    for(let i in reduceParamsList[item]){\n                        delete eventReqAttrs[reduceParamsList[item][i]];\n                    }\n                }\n            }\n\n            // if(this.reduceParamsOrder === 0) this.showMessage(\"No results were found.<br/>Here other options for you.\");\n            this.reduceParamsOrder++;\n            this.makeRequest( this.eventsLoadingHandler, this.apiUrl, eventReqAttrs );\n        }else{\n            // We haven't any results\n            this.showMessage(\"No results were found.\", true);\n            this.reduceParamsOrder = 0;\n            this.hideSliderControls();\n        }\n    }\n\n    eventsLoadingHandler(){\n        let widget = this.widget;\n\n        let spinner = widget.eventsRootContainer.querySelector('.spinner-container');\n\n        widget.clearEvents(); // Additional clearing after each loading\n        if (this && this.readyState == XMLHttpRequest.DONE ) {\n            if(this.status == 200){\n\n                spinner.classList.add('hide');\n\n                widget.events = JSON.parse(this.responseText);\n\n                if(widget.events.length){\n                    widget.groupEventsByName.call(widget);\n\n                    widget.eventsGroups.map(function(group, i){\n                        if(group.length === 1)\n                            widget.publishEvent(group[0]);\n                        else\n                            widget.publishEventsGroup.call(widget, group, i);\n                    });\n\n                    widget.initSlider();\n                    widget.setEventsCounter();\n                    widget.resetReduceParamsOrder();\n                    if(widget.hideMessageWithoutDelay)\n                        widget.hideMessage();\n                    else\n                        widget.hideMessageWithDelay(widget.hideMessageDelay);\n\n                }else{\n                    widget.reduceParamsAndReloadEvents.call(widget);\n                }\n            }\n            else if(this.status == 400) {\n                widget.reduceParamsAndReloadEvents.call(widget);\n                console.log('There was an error 400');\n            }\n            else {\n                widget.reduceParamsAndReloadEvents.call(widget);\n                console.log('something else other than 200 was returned');\n            }\n        }\n    }\n\n    publishEventsGroup(group, index){\n        let groupNodeWrapper = document.createElement(\"li\");\n        groupNodeWrapper.classList.add(\"event-wrapper\");\n        groupNodeWrapper.classList.add(\"event-group-wrapper\");\n        /*\n        groupNodeWrapper.style.width  = `${this.config.width - this.borderSize * 2}px`;\n        groupNodeWrapper.style.height = `${this.widgetContentHeight - this.borderSize * 2}px`;\n        */\n        groupNodeWrapper.style.width  = `${this.config.width}px`;\n        groupNodeWrapper.style.height = `${this.widgetContentHeight}px`;\n\n        let groupNode = document.createElement(\"ul\");\n        groupNode.classList.add(\"event-group\");\n        groupNode.classList.add(\"event-group-\" + index);\n\n        group.map((event)=> {\n            this.publishEvent(event, groupNode)\n        });\n\n        groupNodeWrapper.appendChild(groupNode);\n        this.eventsRoot.appendChild(groupNodeWrapper);\n    }\n\n    publishEvent(event, parentNode){\n        parentNode = parentNode || this.eventsRoot;\n        let DOMElement = this.createDOMItem(event);\n        parentNode.appendChild(DOMElement);\n    }\n\n    getEventByID(id){\n        for(let index in this.events){\n            if(this.events.hasOwnProperty(index) && this.events[index].id === id){\n                return this.events[index]\n            }\n        }\n    }\n\n    getImageForEvent(images){\n        var width = this.config.width,\n            height = this.widgetContentHeight;\n\n        images.sort(function(a,b) {\n            if (a.width < b.width)\n                return -1;\n            else if (a.width > b.width)\n                return 1;\n            else\n                return 0;\n        });\n\n        var myImg = \"\";\n        images.forEach(function(element){\n            if(element.width >= width && element.height >= height && !myImg){\n                myImg = element.url;\n            }\n        });\n        return myImg;\n    }\n\n    parseEvents(eventsSet){\n        if(!eventsSet._embedded){\n            if(typeof($widgetModalNoCode) !== \"undefined\"){\n                $widgetModalNoCode.modal();\n            }\n            return [];\n        }\n        eventsSet = eventsSet._embedded.events;\n\n        var tmpEventSet = [];\n        for(var key in eventsSet){\n            if(eventsSet.hasOwnProperty(key)){\n                let currentEvent = {};\n\n                currentEvent.id = eventsSet[key].id;\n                currentEvent.url = eventsSet[key].url;\n                currentEvent.name = eventsSet[key].name;\n\n                currentEvent.date = {\n                    day: eventsSet[key].dates.start.localDate,\n                    time: eventsSet[key].dates.start.localTime\n                };\n\n                if(eventsSet[key].hasOwnProperty('_embedded') && eventsSet[key]._embedded.hasOwnProperty('venues')){\n                    let venue = eventsSet[key]._embedded.venues[0];\n                    if(venue){\n                        if(venue.address)\n                            currentEvent.address = venue.address;\n\n                        if(venue.name){\n                            if(!currentEvent.address) currentEvent.address = {};\n                            currentEvent.address.name = venue.name;\n                        }\n                    }\n                }\n\n                // Remove this comment to get categories\n                /*if(eventsSet[key]._embedded.hasOwnProperty('categories')){\n                 currentEvent.categories = [];\n                 let eventCategories = eventsSet[key]._embedded.categories;\n                 currentEvent.categories = Object.keys(eventCategories).map(function(category){\n                 return eventCategories[category].name\n                 });\n                 }*/\n\n                currentEvent.img = this.getImageForEvent(eventsSet[key].images);\n\n                tmpEventSet.push(currentEvent);\n\n            }\n        }\n        return tmpEventSet;\n    }\n\n    makeRequest(handler, url=this.apiUrl, attrs={}, method=\"GET\"){\n        attrs = Object.keys(attrs).map(function(key){\n            return `${key}=${attrs[key]}`;\n        }).join(\"&\");\n        url = [url,attrs].join(\"?\");\n        if (this.widgetRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + this.widgetRoot.getAttribute('w-postalcodeapi');\n        url += '&sort=date,asc';\n        this.xmlHTTP = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\");\n        if(method == \"POST\") {\n            this.xmlHTTP.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\n        }\n        this.xmlHTTP.widget = this;\n        this.xmlHTTP.onreadystatechange = handler;\n        this.xmlHTTP.open(method, url, true);\n        this.xmlHTTP.send();\n    }\n\n    initPretendedLink(el, url, isBlank){\n        if(el && url){\n            el.setAttribute('data-url', url);\n            el.classList.add(\"event-pretended-link\");\n            el.addEventListener('click', function(){\n                let url = this.getAttribute('data-url');\n                if(url){\n                    let win = window.open(url, (isBlank ? '_blank' : '_self'));\n                    win.focus();\n                }\n            });\n            el.addEventListener('touchstart', function(){\n                let url = this.getAttribute('data-url');\n                if(url){\n                    let win = window.open(url, (isBlank ? '_blank' : '_self'));\n                    win.focus();\n                }\n            });\n        }\n        return el;\n    }\n\n    createBackgroundImage(event, img) {\n        if (!this.isListView) {\n            var image = document.createElement(\"span\");\n            image.classList.add(\"bg-cover\");\n            image.style.backgroundImage = `url('${img}')`;\n            event.appendChild(image);\n        }\n    }\n\n    addBuyButton(domNode, url) {\n        if (this.isListView) {\n            let _urlValid = ( this.isUniversePluginInitialized && this.isUniverseUrl(url) ) || ( this.isTMPluginInitialized && this.isAllowedTMEvent(url) );\n            if(!_urlValid) url = '';\n            let buyBtn = document.createElement(\"a\");\n            buyBtn.appendChild(document.createTextNode('BUY NOW'));\n            buyBtn.classList.add(\"event-buy-btn\");\n            buyBtn.target = '_blank';\n            buyBtn.href = url;\n            buyBtn.setAttribute('onclick', \"ga('send', 'event', 'DiscoveryClickBuyButton', 'click');\");\n            domNode.appendChild(buyBtn);\n        }\n    }\n\n    createDOMItem(itemConfig){\n        var medWrapper = document.createElement(\"div\");\n        medWrapper.classList.add(\"event-content-wraper\");\n\n        var event = document.createElement(\"li\");\n        event.classList.add(\"event-wrapper\");\n\n        /* event.style.height = `${this.widgetContentHeight - this.borderSize * 2}px`;\n        event.style.width  = `${this.config.width - this.borderSize * 2}px`;\n        */\n\n        event.style.height = `${this.widgetContentHeight}px`;\n        event.style.width  = `${this.config.width}px`;\n\n        this.createBackgroundImage(event, itemConfig.img);\n\n        var nameContent = document.createTextNode(itemConfig.name),\n            name =  document.createElement(\"span\");\n        name.classList.add(\"event-name\");\n        name.appendChild(nameContent);\n        this.initPretendedLink(name, itemConfig.url, true);\n        name.setAttribute('onclick', `ga('send', 'event', 'DiscoveryClickeventName_theme=${this.config.theme}_width=${this.config.width}_height=${this.config.height}_color_scheme=${this.config.colorscheme}', 'click', '${itemConfig.url}');`);\n        /* name.setAttribute('onclick', \"ga('send', 'event', 'DiscoveryClickeventName', 'click', '\" + itemConfig.url + \"');\"); */\n        medWrapper.appendChild(name);\n\n        this.addBuyButton(medWrapper, itemConfig.url);\n\n        var dateTimeContent = document.createTextNode(this.formatDate(itemConfig.date)),\n            dateTime = document.createElement(\"span\");\n        dateTime.classList.add(\"event-date\");\n        dateTime.appendChild(dateTimeContent);\n\n        var dateWraper = document.createElement(\"span\");\n        dateWraper.classList.add(\"event-date-wraper\");\n        dateWraper.appendChild(dateTime);\n        medWrapper.appendChild(dateWraper);\n\n        if(itemConfig.hasOwnProperty(\"address\")){\n            var addressWrapper = document.createElement(\"span\");\n            addressWrapper.classList.add(\"address-wrapper\");\n\n            if( itemConfig.address.hasOwnProperty(\"name\") ){\n                var addressNameText = document.createTextNode(itemConfig.address.name),\n                    addressName =  document.createElement(\"span\");\n                addressName.classList.add(\"event-address\");\n                addressName.classList.add(\"event-address-name\");\n                addressName.appendChild(addressNameText);\n                addressWrapper.appendChild(addressName);\n            }\n\n            if( itemConfig.address.hasOwnProperty(\"line1\") ){\n                var addressOneText = document.createTextNode(itemConfig.address.line1),\n                    addressOne =  document.createElement(\"span\");\n                addressOne.classList.add(\"event-address\");\n                addressOne.appendChild(addressOneText);\n                addressWrapper.appendChild(addressOne);\n            }\n\n            if( itemConfig.address.hasOwnProperty(\"line2\") ){\n                var addressTwoText = document.createTextNode(itemConfig.address.line2),\n                    addressTwo =  document.createElement(\"span\");\n                addressTwo.classList.add(\"event-address\");\n                addressTwo.appendChild(addressTwoText);\n                addressWrapper.appendChild(addressTwo);\n            }\n\n            medWrapper.appendChild(addressWrapper);\n        }\n\n        if(itemConfig.hasOwnProperty(\"categories\")) {\n            var categoriesWrapper = document.createElement(\"span\");\n            categoriesWrapper.classList.add(\"category-wrapper\");\n\n            itemConfig.categories.forEach(function (element) {\n                var categoryText = document.createTextNode(element),\n                    category = document.createElement(\"span\");\n                category.classList.add(\"event-category\");\n                category.appendChild(categoryText);\n                categoriesWrapper.appendChild(category);\n            });\n            medWrapper.appendChild(categoriesWrapper);\n        }\n\n        event.appendChild(medWrapper);\n\n        return event;\n    }\n\n    makeImageUrl(id){\n        return `https://app.ticketmaster.com/discovery/v2/events/${id}/images.json`;\n    }\n\n    /* Config block */\n\n    decConfig(config){\n        return JSON.parse(window.atob(config));\n    }\n\n    encConfig(config){\n        return window.btoa(config);\n    }\n\n    toShortISOString(dateObj){\n        return dateObj.getFullYear() +\n            \"-\" + (dateObj.getMonth() + 1 < 10 ? \"0\"+ (dateObj.getMonth()+ 1): dateObj.getMonth() + 1) +\n            \"-\" + (dateObj.getDate() < 10 ? \"0\"+ dateObj.getDate(): dateObj.getDate()) +\n            \"T\" + (dateObj.getHours() < 10 ? \"0\"+dateObj.getHours(): dateObj.getHours()) +\n            \":\" + (dateObj.getMinutes() < 10 ? \"0\"+dateObj.getMinutes(): dateObj.getMinutes()) +\n            \":\" + (dateObj.getSeconds() < 10 ? \"0\"+dateObj.getSeconds(): dateObj.getSeconds()) +\n            \"Z\";\n    }\n\n    getDateFromPeriod(period){\n        let firstDay = new Date();\n        let lastDay = new Date();\n        lastDay.setDate(lastDay.getDate() + 1);\n\n        if (period != 'week') {\n            period = new Date(document.querySelector('[w-type=\"calendar\"]').getAttribute(\"w-period\"));\n            let firstDay = new Date(period);\n            let lastDay = new Date(period);\n            lastDay.setDate(lastDay.getDate() + 1);\n            firstDay.setHours(0);   lastDay.setHours(23);\n            firstDay.setMinutes(0); lastDay.setMinutes(59);\n            firstDay.setSeconds(0); lastDay.setSeconds(59);\n        }\n\n        firstDay = new Date( new Date(new Date()).toISOString() );\n        lastDay = new Date( new Date(new Date().valueOf()+24*60*60*1000).toISOString() );\n\n        return [this.toShortISOString(firstDay), this.toShortISOString(lastDay)];\n    }\n\n}\n\nclass TabsControls {\n\n    removeActiveTab(this_) {\n        let tabs = this_.querySelectorAll('.tb');\n        var tabsLenght = tabs.length;\n        for (let i=0; i < tabsLenght; i++) {\n            // Array.from(tabs).forEach(tab => {\n            let tab = tabs[i];\n            if (tab.classList.contains(\"active\")) tab.classList.remove(\"active\");\n            // });\n        }\n        let tab = this_.nextSibling.querySelectorAll('.tab');\n        var tabLenght = tab.length;\n        for (let i=0; i < tabLenght; i++) {\n            // Array.from(tab).forEach(tb => {\n            let tb = tab[i];\n            if (tb.classList.contains(\"active\")) tb.classList.remove(\"active\");\n            // });\n        }\n    }\n\n    selActiveTab(activeTab, this_) {\n        let tabs = this_.nextSibling;\n        tabs.children[activeTab].classList.add('active');\n    }\n\n    constructor() {\n        let self = this;\n        var tabs = document.querySelectorAll('.tb');\n        var tabsList = document.getElementsByClassName('tabs');\n        var tabsLenght = tabs.length;\n        for (let i=0; i < tabsLenght; i++) {\n            // Array.from(tabs).forEach(tab => {\n            let tab = tabs[i];\n            tab.addEventListener('click', function (e) {\n                let this_ = e.target.parentNode;\n                self.removeActiveTab(this_);\n                let index = Array.prototype.indexOf.call(this_.children, e.target);\n                this.classList.add(\"active\");\n                self.selActiveTab(index, this_);\n            });\n         }\n         // });\n    }\n}\n\nclass SelectorControls {\n\n    constructor(root, selectorClass, selectorContent, attribute, update) {\n        if (!root) return;\n        this.SelectorRoot = root;\n        this.SelectorClass = selectorClass;\n        this.SelectorContent = selectorContent;\n        this.SelectorContainer = document.createElement(\"div\");\n        this.SelectorContainer.classList.add(this.SelectorClass);\n        this.SelectorContainer.innerHTML = this.SelectorContent;\n        this.SelectorRoot.appendChild(this.SelectorContainer);\n\n        this.selTitle = this.SelectorContainer.getElementsByTagName(\"span\")[0];\n        this.selContent = this.selTitle.nextElementSibling;\n\n        this.selContent.addEventListener(\"click\",function(e){\n            if (e.target.classList.contains('selector-content') === false) {\n                this.parentNode.getElementsByClassName('selector-title')[0].innerHTML = e.target.innerHTML;\n                this.parentNode.getElementsByClassName('selector-title')[0].setAttribute(\"w-classificationid\", e.target.getAttribute('w-classificationId'));\n                this.parentNode.getElementsByClassName('selector-title')[0].classList.remove('open');\n                this.parentNode.getElementsByClassName('selector-content')[0].classList.remove('show');\n                if (attribute == 'period') this.parentNode.parentNode.parentNode.parentNode.setAttribute('w-period', e.target.getAttribute('w-period'));\n                if (attribute == 'w-period') this.parentNode.parentNode.parentNode.parentNode.setAttribute('w-period-week', e.target.getAttribute('w-period-week'));\n                if (attribute == 'classificationId') this.parentNode.parentNode.parentNode.parentNode.setAttribute('w-classificationId', e.target.getAttribute('w-classificationId'));\n\n                /* Month fix by dates changing */\n                if (this.parentNode.classList.contains('sliderLeftSelector') === true) {\n                    if (this.parentNode.nextElementSibling.querySelector('.selector-title').getAttribute('w-classificationid') != undefined) {\n                        if (this.parentNode.nextElementSibling.querySelector('.selector-title').getAttribute('w-classificationid') != this.parentNode.parentNode.parentNode.parentNode.getAttribute(\"w-classificationId\")) {\n                            this.parentNode.parentNode.parentNode.parentNode.setAttribute(\"w-classificationId\", this.parentNode.nextElementSibling.querySelector('.selector-title').getAttribute('w-classificationid'));\n                        }\n                    }\n                }\n\n                update();\n            }\n            else {\n                console.log(this.classList);\n                if (this.classList.contains(\"show\")) {\n                    this.classList.remove(\"show\");\n                    this.prevElementSibling.classList.remove(\"open\");\n                }\n            }\n        });\n\n        this.selTitle.addEventListener(\"click\",function(e){\n            this.nextElementSibling.classList.add(\"show\");\n            if ( this.classList.contains(\"open\") ) {\n                this.classList.remove(\"open\");\n                this.nextElementSibling.classList.remove(\"show\");\n            }\n            else {\n                this.classList.add(\"open\");\n            }\n            this.nextElementSibling.focus();\n        },false);\n\n        this.selContent.addEventListener(\"blur\",function(e){\n            var self = this;\n            if (self.classList.contains(\"show\")) {\n                setTimeout(function () {\n                    self.classList.remove(\"show\");\n                    self.previousElementSibling.classList.remove(\"open\");\n                }, 127);\n            }\n        },false);\n\n    }\n\n}\n\nclass WeekScheduler {\n\n    get apiUrl(){ return \"https://app.ticketmaster.com/discovery/v2/events.json\"; }\n\n    get eventReqAttrs(){\n        let calendarWidgetRoot = this.eventsRootContainer.parentNode.parentNode.parentNode;\n        let tmapikey = '',\n            keyword = '',\n            radius;\n\n        let attrs = {},\n            params = [\n                {\n                    attr: 'tmapikey',\n                    verboseName: 'apikey'\n                },\n                {\n                    attr: 'latlong',\n                    verboseName: 'latlong'\n                },\n                {\n                    attr: 'keyword',\n                    verboseName: 'keyword'\n                },\n                {\n                    attr: 'size',\n                    verboseName: 'size'\n                },\n                {\n                    attr: 'radius',\n                    verboseName: 'radius'\n                },\n                {\n                    attr: 'classificationid',\n                    verboseName: 'classificationId'\n                },\n                {\n                    attr: 'attractionid',\n                    verboseName: 'attractionId'\n                },\n                {\n                    attr: 'promoterid',\n                    verboseName: 'promoterId'\n                },\n                {\n                    attr: 'venueid',\n                    verboseName: 'venueId'\n                },\n                {\n                    attr: 'city',\n                    verboseName: 'city'\n                },\n                {\n                    attr: 'countrycode',\n                    verboseName: 'countryCode'\n                },\n                {\n                    attr: 'segmentid',\n                    verboseName: 'segmentId'\n                }\n            ];\n\n        let startmonth, startdate, endmonth, enddate;\n        let classificationid = '';\n        let countrycode = '';\n        let city = '';\n        let startDateTime = '2016-06-27T00:00:00Z';\n        let endDateTime = '2016-07-02T23:59:59Z';\n        let latlong = '';\n\n        let current = new Date();\n        let start = new Date();\n        let end = new Date();\n\n        let weekstart = current.getDate() - current.getDay();\n        start = new Date(current.setDate(weekstart));\n        end.setDate(start.getDate() + 7);\n        if (start.getMonth()+1 <=9) startmonth = '0' + (start.getMonth()+1); else startmonth = start.getMonth()+1;\n        if (start.getDate() <=9) startdate = '0' + start.getDate(); else startdate = start.getDate();\n        if (end.getMonth()+1 <=9) endmonth = '0' + (end.getMonth()+1); else endmonth = end.getMonth()+1;\n        if (end.getDate() <=9) enddate = '0' + end.getDate(); else enddate = end.getDate();\n        startDateTime = start.getFullYear() + '-' + startmonth + '-' + startdate + 'T00:00:00Z';\n        endDateTime = end.getFullYear() + '-' + endmonth + '-' + enddate + 'T23:59:59Z';\n\n        if (calendarWidgetRoot.getAttribute(\"w-period-week\") != 'week') {\n            start = new Date(calendarWidgetRoot.getAttribute(\"w-period-week\"));\n            end = new Date(calendarWidgetRoot.getAttribute(\"w-period-week\"));\n            end.setDate(end.getDate() + 7);\n            if (start.getMonth()+1 <=9) startmonth = '0' + (start.getMonth()+1); else startmonth = start.getMonth()+1;\n            if (start.getDate() <=9) startdate = '0' + start.getDate(); else startdate = start.getDate();\n            if (end.getMonth()+1 <=9) endmonth = '0' + (end.getMonth()+1); else endmonth = end.getMonth()+1;\n            if (end.getDate() <=9) enddate = '0' + end.getDate(); else enddate = end.getDate();\n            startDateTime = start.getFullYear() + '-' + startmonth + '-' + startdate + 'T00:00:00Z';\n            endDateTime = end.getFullYear() + '-' + endmonth + '-' + enddate + 'T23:59:59Z';\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-tmapikey\") != '') {\n            tmapikey = calendarWidgetRoot.getAttribute(\"w-tmapikey\");\n            /* if (sessionStorage.getItem('tk-api-key')) {\n                tmapikey = sessionStorage.getItem('tk-api-key');\n                document.querySelector('[w-type=\"calendar\"]').setAttribute(\"w-tmapikey\", tmapikey);\n            }\n            */\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-latlong\") != '') {\n            latlong = calendarWidgetRoot.getAttribute(\"w-latlong\");\n        }\n\n        // if (latlong === null) latlong = '34.0390107,-118.2672801';\n\n        if (calendarWidgetRoot.getAttribute(\"w-keyword\") != '') {\n            keyword = calendarWidgetRoot.getAttribute(\"w-keyword\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-radius\") != '') {\n            radius = calendarWidgetRoot.getAttribute(\"w-radius\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-classificationId\") != '') {\n            classificationid = calendarWidgetRoot.getAttribute(\"w-classificationId\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-countrycode\") != null) {\n            countrycode = calendarWidgetRoot.getAttribute(\"w-countrycode\");\n            latlong = '';\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-city\") != null) {\n            city = calendarWidgetRoot.getAttribute(\"w-city\");\n            latlong = '';\n        }\n\n        if (new Date(startDateTime).getFullYear() == '1969' || new Date(startDateTime).getFullYear() == '1970') {\n            current = new Date();\n            start = new Date();\n            end = new Date();\n\n            weekstart = current.getDate() - current.getDay();\n            start = new Date(current.setDate(weekstart));\n            end.setDate(start.getDate() + 7);\n            if (start.getMonth()+1 <=9) startmonth = '0' + (start.getMonth()+1); else startmonth = start.getMonth()+1;\n            if (start.getDate() <=9) startdate = '0' + start.getDate(); else startdate = start.getDate();\n            if (end.getMonth()+1 <=9) endmonth = '0' + (end.getMonth()+1); else endmonth = end.getMonth()+1;\n            if (end.getDate() <=9) enddate = '0' + end.getDate(); else enddate = end.getDate();\n            startDateTime = start.getFullYear() + '-' + startmonth + '-' + startdate + 'T00:00:00Z';\n            endDateTime = end.getFullYear() + '-' + endmonth + '-' + enddate + 'T23:59:59Z';\n        }\n\n        return {\n            \"apikey\": tmapikey,\n            \"latlong\": latlong,\n            \"keyword\": keyword,\n            \"countryCode\": countrycode,\n            \"city\": city,\n            \"startDateTime\": startDateTime,\n            \"endDateTime\": endDateTime,\n            \"classificationId\": classificationid,\n            \"radius\": radius,\n            \"size\": \"500\"\n        }\n\n    }\n\n    get messageRootContainer(){ return 'weekSсheduler'; }\n\n    get hideMessageDelay(){ return 3000; }\n\n    addScroll() {\n        (function(n,t){function u(n){n.hasOwnProperty(\"data-simple-scrollbar\")||Object.defineProperty(n,\"data-simple-scrollbar\",new SimpleScrollbar(n))}function e(n,i){function f(n){var t=n.pageY-u;u=n.pageY;r(function(){i.el.scrollTop+=t/i.scrollRatio})}function e(){n.classList.remove(\"ss-grabbed\");t.body.classList.remove(\"ss-grabbed\");t.removeEventListener(\"mousemove\",f);t.removeEventListener(\"mouseup\",e)}var u;n.addEventListener(\"mousedown\",function(i){return u=i.pageY,n.classList.add(\"ss-grabbed\"),t.body.classList.add(\"ss-grabbed\"),t.addEventListener(\"mousemove\",f),t.addEventListener(\"mouseup\",e),!1})}function i(n){for(this.target=n,this.bar='<div class=\"ss-scroll\">',this.wrapper=t.createElement(\"div\"),this.wrapper.setAttribute(\"class\",\"ss-wrapper\"),this.el=t.createElement(\"div\"),this.el.setAttribute(\"class\",\"ss-content\"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper);this.target.insertAdjacentHTML(\"beforeend\",this.bar);this.bar=this.target.lastChild;e(this.bar,this);this.moveBar();this.el.addEventListener(\"scroll\",this.moveBar.bind(this));this.el.addEventListener(\"mouseenter\",this.moveBar.bind(this));this.target.classList.add(\"ss-container\")}function f(){for(var i=t.querySelectorAll(\"*[ss-container]\"),n=0;n<i.length;n++)u(i[n])}var r=n.requestAnimationFrame||n.setImmediate||function(n){return setTimeout(n,0)};i.prototype={moveBar:function(){var t=this.el.scrollHeight,i=this.el.clientHeight,n=this;this.scrollRatio=i/t;r(function(){n.bar.style.cssText=\"height:\"+i/t*100+\"%; top:\"+n.el.scrollTop/t*100+\"%;right:-\"+(n.target.clientWidth-n.bar.clientWidth)+\"px;\"})}};t.addEventListener(\"DOMContentLoaded\",f);i.initEl=u;i.initAll=f;n.SimpleScrollbar=i})(window,document)\n        var scrollRoot = document.querySelectorAll(\".ss\");\n        var maxL = scrollRoot.length;\n        for (let ml = 0; ml < maxL; ml++) {\n            SimpleScrollbar.initEl(scrollRoot[ml]);\n        }\n    }\n\n    initMessage(schedulerRoot){\n        this.eventsRootContainer = schedulerRoot;\n        this.messageDialogContainer = document.createElement('div');\n        this.messageDialogContainer.classList.add(\"event-message-container\");\n        this.messageDialog = document.createElement('div');\n        this.messageDialog.classList.add(\"event-message_\");\n        this.messageContent = document.createElement('div');\n        this.messageContent.classList.add(\"event-message__content\");\n\n        let messageClose = document.createElement('div');\n        messageClose.classList.add(\"event-message__btn\");\n        messageClose.addEventListener(\"click\", ()=> {\n            this.hideMessage();\n        });\n\n        this.messageDialog.appendChild(this.messageContent);\n        this.messageDialog.appendChild(messageClose);\n        this.messageDialogContainer.appendChild(this.messageDialog);\n        this.eventsRootContainer.appendChild(this.messageDialogContainer);\n    }\n\n    showMessage(message, hideMessageWithoutDelay){\n\n        if(message.length){\n            this.hideMessageWithoutDelay = hideMessageWithoutDelay;\n            this.messageContent.innerHTML = message;\n            this.messageDialog.classList.add(\"event-message_-visible\");\n            if (this.messageTimeout) {\n                clearTimeout(this.messageTimeout); // Clear timeout if before 'hideMessageWithDelay' was called\n            }\n        }\n    }\n\n    hideMessageWithDelay(delay){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout if this method was called before\n        this.messageTimeout = setTimeout(()=>{\n            this.hideMessage();\n        }, delay);\n    }\n\n    hideMessage(){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout and hide message immediately.\n        this.messageDialog.classList.remove(\"event-message_-visible\");\n    }\n\n    getJSON(handler, url=this.apiUrl, attrs={}, method=\"GET\"){\n        attrs = Object.keys(attrs).map(function(key){\n            return `${key}=${attrs[key]}`;\n        }).join(\"&\");\n\n        url = [url,attrs].join(\"?\");\n        let thisSchedulerRoot = this.weekSchedulerRoot.parentNode.parentNode.parentNode;\n        if (thisSchedulerRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + thisSchedulerRoot.getAttribute('w-postalcodeapi');\n        url += '&sort=date,asc';\n\n        this.xmlHTTP = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\");\n        if(method == \"POST\") {\n            this.xmlHTTP.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\n        }\n        this.xmlHTTP.widget = this;\n        this.xmlHTTP.onreadystatechange = handler;\n        this.xmlHTTP.open(method, url, true);\n        this.xmlHTTP.send();\n    }\n\n    getJsonAsync(url) {\n        return new Promise(function (resolve, reject) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', url);\n\n            xhr.onload = () => {\n                if (xhr.status === 200) {\n                    var result = JSON.parse(xhr.response);\n                    resolve(result);\n                } else {\n                    reject(\"Error loading JSON!\");\n                }\n            }\n            xhr.onerror = () => {\n                reject(\"Error loading JSON!\");\n            };\n            xhr.send();\n        });\n    }\n\n    formatDate(date) {\n        var result = '';\n        if(!date.day) return result; // Day is required\n\n        function LZ(x) {\n            return (x < 0 || x > 9 ? \"\" : \"0\") + x\n        }\n        var MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\n            DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],\n            dayArray = date.day.split('-'),\n            d = parseInt(dayArray[2]),\n            M = parseInt(dayArray[1]);\n\n        // var E = new Date(date.day).getDay();\n        var E = new Date(+date.day.split('-')[0],(+date.day.split('-')[1])-1,+date.day.split('-')[2]).getDay();\n        result = DAY_NAMES[E] + ', ' + MONTH_NAMES[M - 1] + ' ' + d + ', ' + dayArray[0];\n\n        if(!date.time) return result;\n\n        var timeArray = date.time.split(':'),\n            H = parseInt(timeArray[0]),\n            m = timeArray[1],\n            a = \"AM\";\n\n        if (H > 11) a = \"PM\";\n        if (H == 0) {\n            H = 12;\n        } else if (H > 12) {\n            H = H - 12;\n        }\n\n        return result + ' ' + LZ(H) + ':' + m + ' ' + a;\n    }\n\n    getWeekEventsHandler() {\n        let events;\n        let place;\n        let address;\n        let weekEvents = [];\n        let widget = this.widget;\n        let schedulerRoot = widget.weekSchedulerRoot;\n        let calendarWidgetRoot = this.widget.eventsRootContainer.parentNode.parentNode.parentNode;\n        let spinner = schedulerRoot.querySelector('.spinner-container');\n        let prm = [];\n        let messageContainer = schedulerRoot.querySelector('.event-message-container');\n\n        if (this && this.readyState == XMLHttpRequest.DONE) {\n\n            if (this.status == 200) {\n\n                events = JSON.parse(this.responseText);\n\n                if (events.page.totalPages <= 1) {\n                    spinner.classList.add('hide');\n                    if (events.page.totalElements != 0) {\n                        events._embedded.events.forEach(function (item) {\n                            if (item.hasOwnProperty('_embedded') && item._embedded.hasOwnProperty('venues')) {\n                                if (item._embedded.venues[0].hasOwnProperty('name')) {\n                                    place = item._embedded.venues[0].name + ', ';\n                                }\n                                else {\n                                    place = '';\n                                }\n                                if (item._embedded.venues[0].hasOwnProperty('address')) {\n                                    address = item._embedded.venues[0].address.line1;\n                                } else {\n                                    address = '';\n                                }\n                            }\n                            else {\n                                place = '';\n                                address = '';\n                            }\n\n                            let imgWidth;\n                            let index;\n                            item.images.forEach(function (img, i) {\n                                if (i == 0) imgWidth = img.width;\n                                if (imgWidth > img.width) {\n                                    imgWidth = img.width;\n                                    index = i;\n                                }\n                            });\n\n                            if (item.hasOwnProperty('dates') && item.dates.hasOwnProperty('start') && item.dates.start.hasOwnProperty('localTime')) {\n                                if (+new Date( +new Date().getFullYear(), +new Date().getMonth(), +new Date().getDate()) <= +new Date(+item.dates.start.localDate.split('-')[0],(+item.dates.start.localDate.split('-')[1])-1,+item.dates.start.localDate.split('-')[2])) {\n                                    weekEvents.push({\n                                        'name': item.name,\n                                        'date': item.dates.start.localDate,\n                                        'time': item.dates.start.localTime,\n                                        'datetime': widget.formatDate({\n                                            day: item.dates.start.localDate,\n                                            time: item.dates.start.localTime\n                                        }),\n                                        'place': place + address,\n                                        'url': item.url,\n                                        'img': (item.hasOwnProperty('images') && item.images[index] != undefined) ? item.images[index].url : '',\n                                        'count': 0\n                                    });\n                                }\n                            }\n                        });\n                    }\n                    else {\n                        weekEvents[0] = ({\n                            date: '',\n                            time: '',\n                        });\n                        messageContainer.classList.remove('hide');\n                        widget.showMessage(\"No results were found.<br/>Here other options for you.\");\n                        widget.hideMessageWithDelay(widget.hideMessageDelay);\n                    }\n\n                    if (weekEvents[0] === undefined) {\n                        weekEvents[0] = ({\n                            date: '',\n                            time: '',\n                        });\n                        messageContainer.classList.remove('hide');\n                        widget.showMessage(\"No results were found.<br/>Here other options for you.\");\n                        widget.hideMessageWithDelay(widget.hideMessageDelay);\n                    }\n\n                    let tDate = weekEvents[0].date;\n                    let tTime = weekEvents[0].time.substr(0,2);\n                    let count = 0;\n                    let startFlag = 0;\n                    let endFlag = 0;\n\n                    for (let e = 0, l = weekEvents.length; e < l; ++e) {\n                        if (tDate == weekEvents[e].date && tTime == weekEvents[e].time.substr(0,2)) {\n                            weekEvents[e].count = count;\n                            endFlag = e;\n                            count++;\n                        }\n                        if (tDate == weekEvents[e].date && tTime != weekEvents[e].time.substr(0,2)) {\n                            for (let i = startFlag; i <= endFlag; i++) {\n                                weekEvents[i].count = count-1;\n                            }\n                            tTime = weekEvents[e].time.substr(0,2);\n                            startFlag = e;\n                            count = 0;\n                        }\n                        if (tDate != weekEvents[e].date || e == l-1) {\n                            for (let i = startFlag; i <= endFlag; i++) {\n                                weekEvents[i].count = count-1;\n                            }\n                            tDate = weekEvents[e].date;\n                            tTime = weekEvents[e].time.substr(0,2);\n                            startFlag = e;\n                            count = 0;\n                        }\n                    }\n\n                    var current = new Date();\n\n                    if (calendarWidgetRoot.getAttribute(\"w-period-week\") != 'week') {\n                        var weekstart = new Date(calendarWidgetRoot.getAttribute(\"w-period-week\"));\n                        weekstart.setDate(weekstart.getDate() - weekstart.getDay());\n                    }\n                    else {\n                        var weekstart = current.getDate() - current.getDay();\n                        weekstart = new Date(current.setDate(weekstart));\n                    }\n\n                    if (weekstart.getFullYear() == '1969') {\n                        current = new Date();\n                        weekstart = current.getDate() - current.getDay();\n                        weekstart = new Date(current.setDate(weekstart));\n                    }\n\n                    let currentSunday = weekstart;\n                    let daysDiv = '';\n                    let currentDayClass = '';\n                    let dayOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n                    let now = new Date();\n                    for (let i = 0; i <= 6; i++) {\n                        let day = new Date(new Date(currentSunday).getTime() + (i * 24 * 60 * 60 * 1000));\n                        if (day.getDay() == now.getDay() && day.getDate() == now.getDate()) currentDayClass = ' active'; else currentDayClass = '';\n                        daysDiv += `<span class=\"d${currentDayClass}\">${dayOfWeek[i]} <span class=\"num\">${day.getDate()}</span></span>`;\n                    }\n                    let zeroLead = '';\n                    let timeTmp = '';\n                    let dateTmp = '';\n                    let monthTmp = '';\n                    let timeDiv = '<div class=\"ss time-wrapper\"><div class=\"ss-container time-holder\">';\n\n                    for (let i = 13; i <= 23; i++) {\n                        if (i <= 9) {\n                            zeroLead = '0';\n                            timeTmp = '0' + i + \":00:00\";\n                        } else {\n                            zeroLead = '';\n                            timeTmp = i + \":00:00\"\n                        }\n                        timeDiv += `<div class=\"t t-${i}\"><span class=\"tl\">${zeroLead}${i} : 00</span>`;\n\n                        var dayTmp = new Date(currentSunday);\n\n                        for (let d = 0; d <= 6; d++) {\n                            let dayCount = 0;\n                            if (d!=0) dayTmp.setDate(dayTmp.getDate() + 1);\n                            if (parseInt(dayTmp.getMonth() + 1) <= 9) monthTmp = '0' + parseInt(dayTmp.getMonth() + 1); else monthTmp = dayTmp.getMonth() + 1;\n                            if (parseInt(dayTmp.getDate()) <= 9) {\n                                dateTmp = dayTmp.getFullYear() + '-' + monthTmp + '-' + '0' + parseInt(dayTmp.getDate());\n                            }\n                            else {\n                                dateTmp = dayTmp.getFullYear() + '-' + monthTmp + '-' + dayTmp.getDate();\n                            }\n                            timeDiv += `<div class=\"d d-${d}\" w-date=\"${dateTmp}\" w-time=\"${zeroLead}${i}:00:00\">`;\n\n                            for (let e = 0, l = weekEvents.length; e < l; ++e) {\n                                if (weekEvents[e].date == dateTmp && weekEvents[e].time.substr(0,2) == timeTmp.substr(0,2)) {\n                                    if (dayCount == 0) {\n                                        timeDiv += '<span class=\"round\"></span>';\n                                        if (weekEvents[e].time.substring(0,2) < 18) {\n                                            timeDiv += '<span class=\"tail\"></span>';\n                                            timeDiv += '<div class=\"popup ';\n                                            if (weekEvents[e].count == 0) timeDiv += 'single ';\n                                            timeDiv += 'ss\" tabindex=\"-1\">';\n                                            timeDiv += '<div class=\"ss-container\">';\n                                        }\n                                        else {\n                                            timeDiv += '<span class=\"tail-up\"></span>';\n                                            timeDiv += '<div class=\"popup-up ';\n                                            if (weekEvents[e].count == 0) timeDiv += 'single ';\n                                            timeDiv +=  'ss\" tabindex=\"-1\">';\n                                            timeDiv += '<div class=\"ss-container\">';\n                                        }\n                                        dayCount = 1;\n                                    }\n                                    timeDiv += '<span class=\"event\">';\n                                    timeDiv += '<span class=\"event-holder\">';\n                                    timeDiv += '<a href=\"' + weekEvents[e].url + '\" target=\"_blank\">';\n                                    if (weekEvents[e].img !=='' && weekEvents[e].img.length !== 0){\n                                        timeDiv += '<span class=\"img bg-cover-default\" style=\"background: url(' + weekEvents[e].img + ') center center no-repeat\"></span>'\n                                    }else{ timeDiv += '<span class=\"img bg-cover-default\" ></span>';}\n                                    timeDiv += '<span class=\"name\">' + weekEvents[e].name + '</span>';\n                                    timeDiv += '</a>';\n                                    timeDiv += '<span class=\"date\">' + weekEvents[e].datetime + '</span>';\n                                    timeDiv += '<span class=\"place\">' + weekEvents[e].place + '</span>';\n                                    timeDiv += '</span>';\n                                    timeDiv += '</span>';\n                                }\n                            }\n                            if (dayCount == 1) timeDiv += '</div></div>';\n                            timeDiv += '</div>';\n                        }\n                        timeDiv += `</div>`;\n                    }\n                    timeDiv += `</div></div>`;\n                    daysDiv += timeDiv;\n                    widget.weekdaysRootContainer.innerHTML = daysDiv;\n                    widget.addScroll();\n                    var rounds = widget.weekdaysRootContainer.querySelectorAll(\"span.round\");\n                    for (var x = 0; x < rounds.length; x++) {\n                        rounds[x].addEventListener(\"click\", function (e) {\n                            widget.weekdaysRootContainer.querySelectorAll(\".ss-wrapper\")[0].style.overflow = \"visible\";\n                            widget.weekdaysRootContainer.querySelectorAll(\".ss-content\")[0].style.overflow = \"visible\";\n                            this.nextElementSibling.classList.add(\"show\");\n                            this.nextElementSibling.nextElementSibling.classList.add(\"show\");\n                            this.nextElementSibling.nextElementSibling.focus();\n                        }, false);\n                    }\n\n                    var popups = widget.weekdaysRootContainer.querySelectorAll(\".popup, .popup-up\");\n                    for (var y = 0; y < popups.length; y++) {\n                        popups[y].addEventListener(\"blur\", function (e) {\n                            let self = this;\n                            widget.weekdaysRootContainer.querySelectorAll(\".ss-wrapper\")[0].style.overflow = \"hidden\";\n                            widget.weekdaysRootContainer.querySelectorAll(\".ss-content\")[0].style.overflow = \"auto\";\n                            setTimeout(function () {\n                                self.previousElementSibling.classList.remove(\"show\");\n                                self.classList.remove(\"show\");\n                            }, 127);\n                        }, false);\n                    }\n                }\n                else {\n                    weekEvents = [];\n                    let weekEventsConcat = [];\n                    let l = events.page.totalPages - 1;\n                    for (let i = 0; i <= l; i++) {\n                        let attrs = widget.eventReqAttrs;\n                        attrs.page = i;\n                        attrs = Object.keys(attrs).map(function (key) {\n                            return `${key}=${attrs[key]}`;\n                        }).join(\"&\");\n                        let url;\n                        url = widget.apiUrl + [url, attrs].join(\"?\");\n                        let thisSchedulerRoot = widget.weekSchedulerRoot.parentNode.parentNode.parentNode;\n                        if (thisSchedulerRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + thisSchedulerRoot.getAttribute('w-postalcodeapi');\n                        url += '&sort=date,asc';\n                        prm.push(widget.getJsonAsync(url));\n                    }\n                    Promise.all(prm).then(value => {\n                        spinner.classList.add('hide');\n                        let le = value.length;\n                        for (var e = 0; e <= le; e++) {\n                            if(value[e] && value[e]._embedded && value[e]._embedded.events){\n                                value[e]._embedded.events.forEach(function (item) {\n                                    if (item.hasOwnProperty('_embedded') && item._embedded.hasOwnProperty('venues')) {\n                                        if (item._embedded.venues[0].hasOwnProperty('name')) {\n                                            place = item._embedded.venues[0].name + ', ';\n                                        }\n                                        else {\n                                            place = '';\n                                        }\n                                        if (item._embedded.venues[0].hasOwnProperty('address')) {\n                                            address = item._embedded.venues[0].address.line1;\n                                        } else {\n                                            address = '';\n                                        }\n                                    }\n                                    else {\n                                        place = '';\n                                        address = '';\n                                    }\n\n                                    let imgWidth;\n                                    let index;\n                                    item.images.forEach(function (img, i) {\n                                        if (i == 0) imgWidth = img.width;\n                                        if (imgWidth > img.width) {\n                                            imgWidth = img.width;\n                                            index = i;\n                                        }\n                                    });\n\n                                    if (item.hasOwnProperty('dates') && item.dates.hasOwnProperty('start') && item.dates.start.hasOwnProperty('localTime')) {\n                                        if (+new Date( +new Date().getFullYear(), +new Date().getMonth(), +new Date().getDate()) <= +new Date(+item.dates.start.localDate.split('-')[0],(+item.dates.start.localDate.split('-')[1])-1,+item.dates.start.localDate.split('-')[2])) {\n                                            weekEvents.push({\n                                                'name': item.name,\n                                                'date': item.dates.start.localDate,\n                                                'time': item.dates.start.localTime,\n                                                'datetime': widget.formatDate({\n                                                    day: item.dates.start.localDate,\n                                                    time: item.dates.start.localTime\n                                                }),\n                                                'place': place + address,\n                                                'url': item.url,\n                                                'img': (item.hasOwnProperty('images') && item.images[index] != undefined) ? item.images[index].url : '',\n                                            });\n                                        }\n                                    }\n                                });\n                            }\n                            else {\n                                weekEvents[0] = ({\n                                    date: '',\n                                    time: '',\n                                });\n                            }\n                        }\n\n                        weekEventsConcat.push(weekEvents);\n                        weekEvents = weekEventsConcat[0];\n\n                        if (weekEvents.length == 0) {\n                            messageContainer.classList.remove('hide');\n                            widget.showMessage(\"No results were found.<br/>Here other options for you.\");\n                            widget.hideMessageWithDelay(widget.hideMessageDelay);\n                        }\n\n                        let tDate = weekEvents[0].date;\n                        let tTime = weekEvents[0].time.substr(0, 2);\n                        let count = 0;\n                        let startFlag = 0;\n                        let endFlag = 0;\n\n                        for (let e = 0, l = weekEvents.length; e < l; ++e) {\n                            if (tDate == weekEvents[e].date && tTime == weekEvents[e].time.substr(0, 2)) {\n                                weekEvents[e].count = count;\n                                endFlag = e;\n                                count++;\n                            }\n                            if (tDate == weekEvents[e].date && tTime != weekEvents[e].time.substr(0, 2)) {\n                                for (let i = startFlag; i <= endFlag; i++) {\n                                    weekEvents[i].count = count - 1;\n                                }\n                                tTime = weekEvents[e].time.substr(0, 2);\n                                startFlag = e;\n                                count = 0;\n                            }\n                            if (tDate != weekEvents[e].date || e == l - 1) {\n                                for (let i = startFlag; i <= endFlag; i++) {\n                                    weekEvents[i].count = count - 1;\n                                }\n                                tDate = weekEvents[e].date;\n                                tTime = weekEvents[e].time.substr(0, 2);\n                                startFlag = e;\n                                count = 0;\n                            }\n                        }\n\n                        var current = new Date();\n\n                        if (calendarWidgetRoot.getAttribute(\"w-period-week\") != 'week') {\n                            var weekstart = new Date(calendarWidgetRoot.getAttribute(\"w-period-week\"));\n                            weekstart.setDate(weekstart.getDate() - weekstart.getDay());\n                        }\n                        else {\n                            var weekstart = current.getDate() - current.getDay();\n                            weekstart = new Date(current.setDate(weekstart));\n                        }\n\n                        if (weekstart.getFullYear() == '1969') {\n                            current = new Date();\n                            weekstart = current.getDate() - current.getDay();\n                            weekstart = new Date(current.setDate(weekstart));\n                        }\n\n                        let currentSunday = weekstart;\n                        let daysDiv = '';\n                        let currentDayClass = '';\n                        let dayOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\n                        let now = new Date();\n                        for (let i = 0; i <= 6; i++) {\n                            let day = new Date(new Date(currentSunday).getTime() + (i * 24 * 60 * 60 * 1000));\n                            if (day.getDay() == now.getDay() && day.getDate() == now.getDate()) currentDayClass = ' active'; else currentDayClass = '';\n                            daysDiv += `<span class=\"d${currentDayClass}\">${dayOfWeek[i]} <span class=\"num\">${day.getDate()}</span></span>`;\n                        }\n                        let zeroLead = '';\n                        let timeTmp = '';\n                        let dateTmp = '';\n                        let monthTmp = '';\n                        let timeDiv = '<div class=\"ss time-wrapper\"><div class=\"ss-container time-holder\">';\n\n                        for (let i = 13; i <= 23; i++) {\n                            if (i <= 9) {\n                                zeroLead = '0';\n                                timeTmp = '0' + i + \":00:00\";\n                            } else {\n                                zeroLead = '';\n                                timeTmp = i + \":00:00\"\n                            }\n                            timeDiv += `<div class=\"t t-${i}\"><span class=\"tl\">${zeroLead}${i} : 00</span>`;\n\n                            var dayTmp = new Date(currentSunday);\n\n                            for (let d = 0; d <= 6; d++) {\n                                let dayCount = 0;\n                                if (d != 0) dayTmp.setDate(dayTmp.getDate() + 1);\n                                if (parseInt(dayTmp.getMonth() + 1) <= 9) monthTmp = '0' + parseInt(dayTmp.getMonth() + 1); else monthTmp = dayTmp.getMonth() + 1;\n                                if (parseInt(dayTmp.getDate()) <= 9) {\n                                    dateTmp = dayTmp.getFullYear() + '-' + monthTmp + '-' + '0' + parseInt(dayTmp.getDate());\n                                }\n                                else {\n                                    dateTmp = dayTmp.getFullYear() + '-' + monthTmp + '-' + dayTmp.getDate();\n                                }\n                                timeDiv += `<div class=\"d d-${d}\" w-date=\"${dateTmp}\" w-time=\"${zeroLead}${i}:00:00\">`;\n\n                                for (let e = 0, l = weekEvents.length; e < l; ++e) {\n                                    if (weekEvents[e].date == dateTmp && weekEvents[e].time.substr(0, 2) == timeTmp.substr(0, 2)) {\n                                        if (dayCount == 0) {\n                                            timeDiv += '<span class=\"round\"></span>';\n                                            if (weekEvents[e].time.substring(0, 2) < 18) {\n                                                timeDiv += '<span class=\"tail\"></span>';\n                                                timeDiv += '<div class=\"popup ';\n                                                if (weekEvents[e].count == 0) timeDiv += 'single ';\n                                                timeDiv += 'ss\" tabindex=\"-1\">';\n                                                timeDiv += '<div class=\"ss-container\">';\n                                            }\n                                            else {\n                                                timeDiv += '<span class=\"tail-up\"></span>';\n                                                timeDiv += '<div class=\"popup-up ';\n                                                if (weekEvents[e].count == 0) timeDiv += 'single ';\n                                                timeDiv += 'ss\" tabindex=\"-1\">';\n                                                timeDiv += '<div class=\"ss-container\">';\n                                            }\n                                            dayCount = 1;\n                                        }\n                                        timeDiv += '<span class=\"event\">';\n                                        timeDiv += '<span class=\"event-holder\">';\n                                        timeDiv += '<a href=\"' + weekEvents[e].url + '\" target=\"_blank\">';\n                                        if (weekEvents[e].img !=='' && weekEvents[e].img.length !== 0){\n                                            timeDiv += '<span class=\"img bg-cover-default\" style=\"background: url(' + weekEvents[e].img + ') center center no-repeat\"></span>'\n                                        }else{ timeDiv += '<span class=\"img bg-cover-default\" ></span>';}\n                                        timeDiv += '<span class=\"name\">' + weekEvents[e].name + '</span>';\n                                        timeDiv += '</a>';\n                                        timeDiv += '<span class=\"date\">' + weekEvents[e].datetime + '</span>';\n                                        timeDiv += '<span class=\"place\">' + weekEvents[e].place + '</span>';\n                                        timeDiv += '</span>';\n                                        timeDiv += '</span>';\n                                    }\n                                }\n                                if (dayCount == 1) timeDiv += '</div></div>';\n                                timeDiv += '</div>';\n                            }\n                            timeDiv += `</div>`;\n                        }\n                        timeDiv += `</div></div>`;\n                        daysDiv += timeDiv;\n                        widget.weekdaysRootContainer.innerHTML = daysDiv;\n                        widget.addScroll();\n\n                        var rounds = widget.weekdaysRootContainer.querySelectorAll(\"span.round\");\n                        for (var x = 0; x < rounds.length; x++) {\n                            rounds[x].addEventListener(\"click\", function (e) {\n                                widget.weekdaysRootContainer.querySelectorAll(\".ss-wrapper\")[0].style.overflow = \"visible\";\n                                widget.weekdaysRootContainer.querySelectorAll(\".ss-content\")[0].style.overflow = \"visible\";\n                                this.nextElementSibling.classList.add(\"show\");\n                                this.nextElementSibling.nextElementSibling.classList.add(\"show\");\n                                this.nextElementSibling.nextElementSibling.focus();\n                            }, false);\n                        }\n\n                        var popups = widget.weekdaysRootContainer.querySelectorAll(\".popup, .popup-up\");\n                        for (var y = 0; y < popups.length; y++) {\n                            popups[y].addEventListener(\"blur\", function (e) {\n                                let self = this;\n                                widget.weekdaysRootContainer.querySelectorAll(\".ss-wrapper\")[0].style.overflow = \"hidden\";\n                                widget.weekdaysRootContainer.querySelectorAll(\".ss-content\")[0].style.overflow = \"auto\";\n                                setTimeout(function () {\n                                    self.previousElementSibling.classList.remove(\"show\");\n                                    self.classList.remove(\"show\");\n                                }, 127);\n                            }, false);\n                        }\n                    }, reason => {\n                        console.log(reason)\n                    });\n                }\n\n            }\n            else if (this.status == 400) {\n                console.log('There was an error 400');\n            }\n            else {\n                console.log('something else other than 200 was returned');\n            }\n        }\n\n    }\n\n    update() {\n        let schedulerRoot = this.eventsRootContainer;\n        let days = schedulerRoot.querySelector('.days');\n        schedulerRoot.removeChild(days);\n        this.weekdaysRootContainer = document.createElement(\"div\");\n        this.weekdaysRootContainer.classList.add(\"days\");\n        this.startMonth();\n        this.weekSchedulerRoot.appendChild(this.weekdaysRootContainer);\n    }\n\n    getCurrentMonth() {\n        let monthNames = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n        let content = '<span class=\"selector-title\">';\n        let current = new Date();\n        let weekstart = current.getDate() - current.getDay();\n        let sunday = new Date(current.setDate(weekstart));\n        let sundayGetMonth;\n        let sundayGetDate;\n\n        content += monthNames[current.getMonth()] + ' ' + current.getDate();\n        current.setDate(current.getDate() + 6);\n        content += ' - ' + monthNames[current.getMonth()] + ' ' + current.getDate();\n        content += '</span>';\n        content += '<span class=\"selector-content\" tabindex=\"-1\">';\n\n        for (var m=0; m<=5; m++) {\n            if (m==0) content += `<span class=\"active\" w-period-week=\"${sunday}\">`;\n            content += `<span w-period-week=\"${sunday}\">`;\n            content += monthNames[sunday.getMonth()] + ' ' + sunday.getDate();\n            sunday.setDate(sunday.getDate() + 6);\n            content += ' - ' + monthNames[sunday.getMonth()] + ' ' + sunday.getDate();\n            content += '</span>';\n            sunday.setDate(sunday.getDate() + 1);\n        }\n        content += '</span>';\n        return content;\n    }\n\n    startMonth() {\n        let spinner = this.eventsRootContainer.querySelector('.spinner-container');\n        spinner.classList.remove('hide');\n        this.getJSON( this.getWeekEventsHandler, this.apiUrl, this.eventReqAttrs );\n    }\n\n    constructor(root) {\n        if (!root) return;\n        this.weekSchedulerRoot = root;\n        this.getCurrentMonth();\n        if (this.weekSchedulerRoot.parentNode.querySelector('.sliderLeftSelector') == null) {\n            let leftSelector1 = new SelectorControls(this.weekSchedulerRoot.parentNode, 'sliderLeftSelector', this.getCurrentMonth(), 'w-period', this.update.bind(this));\n            let RightSelector1 = new SelectorControls(this.weekSchedulerRoot.parentNode, 'sliderRightSelector', '<span class=\"selector-title\">All Events</span><span class=\"selector-content\" tabindex=\"-1\"><span class=\"active\" w-classificationId=\"\">All Events</span><span w-classificationId=\"KZFzniwnSyZfZ7v7na\">Arts & Theatre</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nn\">Film</span><span w-classificationId=\"KZFzniwnSyZfZ7v7n1\">Miscellaneous</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nJ\">Music</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nE\">Sports</span></span>', 'classificationId', this.update.bind(this));\n        }\n        if (this.weekSchedulerRoot.querySelector('.days') == null) {\n            this.weekdaysRootContainer = document.createElement(\"div\");\n            this.weekdaysRootContainer.classList.add(\"days\");\n            this.initMessage(this.weekSchedulerRoot);\n            this.startMonth();\n            this.weekSchedulerRoot.appendChild(this.weekdaysRootContainer);\n        }\n    }\n}\n\nclass MonthScheduler {\n\n    get apiUrl(){ return \"https://app.ticketmaster.com/discovery/v2/events.json\"; }\n\n    get eventReqAttrs(){\n        let calendarWidgetRoot = this.monthSchedulerRoot.parentNode.parentNode.parentNode;\n        let tmapikey = '',\n            latlong = '',\n            keyword = '',\n            radius;\n        let attrs = {},\n            params = [\n                {\n                    attr: 'tmapikey',\n                    verboseName: 'apikey'\n                },\n                {\n                    attr: 'keyword',\n                    verboseName: 'keyword'\n                },\n                {\n                    attr: 'size',\n                    verboseName: 'size'\n                },\n                {\n                    attr: 'city',\n                    verboseName: 'city'\n                },\n                {\n                    attr: 'countrycode',\n                    verboseName: 'countryCode'\n                },\n                {\n                    attr: 'radius',\n                    verboseName: 'radius'\n                },\n                {\n                    attr: 'classificationid',\n                    verboseName: 'classificationId'\n                },\n                {\n                    attr: 'attractionid',\n                    verboseName: 'attractionId'\n                },\n                {\n                    attr: 'promoterid',\n                    verboseName: 'promoterId'\n                },\n                {\n                    attr: 'venueid',\n                    verboseName: 'venueId'\n                },\n                {\n                    attr: 'segmentid',\n                    verboseName: 'segmentId'\n                },\n                {\n                    attr: 'page',\n                    verboseName: 'page'\n                }\n            ];\n\n        let date = new Date();\n        let startmonth, startdate, endmonth, enddate, startDateTime, endDateTime;\n        let classificationid = '';\n        let countrycode = '';\n        let city = '';\n        let firstDay = new Date(date.getFullYear(), date.getMonth(), 1);\n        let lastDay = new Date(date.getFullYear(), date.getMonth() + 2, 0);\n\n        if (firstDay.getMonth()+1 <=9) startmonth = '0' + (firstDay.getMonth()+1); else startmonth = firstDay.getMonth()+1;\n        startdate = '0' + firstDay.getDate();\n        if (lastDay.getMonth()+1 <=9) endmonth = '0' + (lastDay.getMonth()+1); else endmonth = lastDay.getMonth()+1;\n        enddate = lastDay.getDate();\n        startDateTime = firstDay.getFullYear() + '-' + startmonth + '-' + startdate + 'T00:00:00Z';\n        endDateTime = lastDay.getFullYear() + '-' + endmonth + '-' + enddate + 'T23:59:59Z';\n\n        if (calendarWidgetRoot.getAttribute(\"w-period\") != 'week') {\n            if (calendarWidgetRoot.getAttribute(\"w-period\").length != 7) {\n                firstDay =  new Date(date.getFullYear(), date.getMonth(), 1);\n                lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 1);\n            }\n            else {\n                firstDay = new Date(calendarWidgetRoot.getAttribute(\"w-period\").substr(0, 4), calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 7), 0);\n                lastDay = new Date(calendarWidgetRoot.getAttribute(\"w-period\").substr(0, 4), calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 7), 0);\n                firstDay.setDate(new Date(firstDay).getDate() - 1);\n                lastDay.setDate(new Date(lastDay).getDate() + 1);\n            }\n            if (parseInt(firstDay.getMonth()+1) <= 9) startmonth = '0' + parseInt(firstDay.getMonth() + 1); else startmonth = parseInt(firstDay.getMonth() + 1);\n            startdate = '0' + firstDay.getDate();\n            if (lastDay.getMonth()+1 <= 9) endmonth = '0' + parseInt(lastDay.getMonth() + 1); else endmonth = parseInt(lastDay.getMonth()) + 1;\n            if (lastDay.getDate()+1 <= 9) enddate = '0' + parseInt(lastDay.getDate() + 1); else enddate = parseInt(lastDay.getDate()) + 1;\n\n            startDateTime = firstDay.getFullYear() + '-' + startmonth + '-01T00:00:00Z';\n            endDateTime = lastDay.getFullYear() + '-' + endmonth + '-' + enddate + 'T23:59:59Z';\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-tmapikey\") != '') {\n            tmapikey = calendarWidgetRoot.getAttribute(\"w-tmapikey\");\n            /*\n            if (sessionStorage.getItem('tk-api-key')) {\n                tmapikey = sessionStorage.getItem('tk-api-key');\n                document.querySelector('[w-type=\"calendar\"]').setAttribute(\"w-tmapikey\", tmapikey);\n            }\n            */\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-latlong\") != '') {\n            latlong = calendarWidgetRoot.getAttribute(\"w-latlong\");\n        }\n\n        // if (latlong === null) latlong = '34.0390107,-118.2672801';\n\n        if (calendarWidgetRoot.getAttribute(\"w-keyword\") != '') {\n            keyword = calendarWidgetRoot.getAttribute(\"w-keyword\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-radius\") != '') {\n            radius = calendarWidgetRoot.getAttribute(\"w-radius\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-classificationId\") != '') {\n            classificationid = calendarWidgetRoot.getAttribute(\"w-classificationId\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-countrycode\") != null) {\n            countrycode = calendarWidgetRoot.getAttribute(\"w-countrycode\");\n            latlong = '';\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-city\") != null) {\n            city = calendarWidgetRoot.getAttribute(\"w-city\");\n            latlong = '';\n        }\n\n        return {\n            \"apikey\": tmapikey,\n            \"latlong\": latlong,\n            \"countryCode\": countrycode,\n            \"city\": city,\n            \"keyword\": keyword,\n            \"startDateTime\": startDateTime,\n            \"endDateTime\": endDateTime,\n            \"classificationId\": classificationid,\n            \"radius\": radius,\n            \"size\": \"500\",\n            \"page\": 0\n        }\n    }\n\n    get messageRootContainer(){ return 'monthScheduler'; }\n\n    get hideMessageDelay(){ return 3000; }\n\n    getJSON(handler, url=this.apiUrl, attrs={}, method=\"GET\"){\n        attrs = Object.keys(attrs).map(function(key){\n            return `${key}=${attrs[key]}`;\n        }).join(\"&\");\n\n        url = [url,attrs].join(\"?\");\n        let thisSchedulerRoot = this.monthSchedulerRoot.parentNode.parentNode.parentNode;\n        if (thisSchedulerRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + thisSchedulerRoot.getAttribute('w-postalcodeapi');\n        url += '&sort=date,asc';\n\n        this.xmlHTTP = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject(\"Microsoft.XMLHTTP\");\n        if(method == \"POST\") {\n            this.xmlHTTP.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\n        }\n        this.xmlHTTP.widget = this;\n        this.xmlHTTP.onreadystatechange = handler;\n        this.xmlHTTP.open(method, url, true);\n        this.xmlHTTP.send();\n    }\n\n    getJsonAsync(url) {\n        return new Promise(function (resolve, reject) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', url);\n\n            xhr.onload = () => {\n                if (xhr.status === 200) {\n                    var result = JSON.parse(xhr.response);\n                    resolve(result);\n                } else {\n                    reject(\"Error loading JSON!\");\n                }\n            }\n            xhr.onerror = () => {\n                reject(\"Error loading JSON!\");\n            };\n            xhr.send();\n        });\n    }\n\n    formatDate(date) {\n        var result = '';\n        if(!date.day) return result; // Day is required\n\n        function LZ(x) {\n            return (x < 0 || x > 9 ? \"\" : \"0\") + x\n        }\n        var MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\n            DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],\n            dayArray = date.day.split('-'),\n            d = parseInt(dayArray[2]),\n            M = parseInt(dayArray[1]);\n\n        // var E = new Date(date.day).getDay();\n        var E = new Date(+date.day.split('-')[0],(+date.day.split('-')[1])-1,+date.day.split('-')[2]).getDay();\n        result = DAY_NAMES[E] + ', ' + MONTH_NAMES[M - 1] + ' ' + d + ', ' + dayArray[0];\n\n        if(!date.time) return result;\n\n        var timeArray = date.time.split(':'),\n            H = parseInt(timeArray[0]),\n            m = timeArray[1],\n            a = \"AM\";\n\n        if (H > 11) a = \"PM\";\n        if (H == 0) {\n            H = 12;\n        } else if (H > 12) {\n            H = H - 12;\n        }\n\n        return result + ' ' + LZ(H) + ':' + m + ' ' + a;\n    }\n\n    addScroll() {\n        (function(n,t){function u(n){n.hasOwnProperty(\"data-simple-scrollbar\")||Object.defineProperty(n,\"data-simple-scrollbar\",new SimpleScrollbar(n))}function e(n,i){function f(n){var t=n.pageY-u;u=n.pageY;r(function(){i.el.scrollTop+=t/i.scrollRatio})}function e(){n.classList.remove(\"ss-grabbed\");t.body.classList.remove(\"ss-grabbed\");t.removeEventListener(\"mousemove\",f);t.removeEventListener(\"mouseup\",e)}var u;n.addEventListener(\"mousedown\",function(i){return u=i.pageY,n.classList.add(\"ss-grabbed\"),t.body.classList.add(\"ss-grabbed\"),t.addEventListener(\"mousemove\",f),t.addEventListener(\"mouseup\",e),!1})}function i(n){for(this.target=n,this.bar='<div class=\"ss-scroll\">',this.wrapper=t.createElement(\"div\"),this.wrapper.setAttribute(\"class\",\"ss-wrapper\"),this.el=t.createElement(\"div\"),this.el.setAttribute(\"class\",\"ss-content\"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper);this.target.insertAdjacentHTML(\"beforeend\",this.bar);this.bar=this.target.lastChild;e(this.bar,this);this.moveBar();this.el.addEventListener(\"scroll\",this.moveBar.bind(this));this.el.addEventListener(\"mouseenter\",this.moveBar.bind(this));this.target.classList.add(\"ss-container\")}function f(){for(var i=t.querySelectorAll(\"*[ss-container]\"),n=0;n<i.length;n++)u(i[n])}var r=n.requestAnimationFrame||n.setImmediate||function(n){return setTimeout(n,0)};i.prototype={moveBar:function(){var t=this.el.scrollHeight,i=this.el.clientHeight,n=this;this.scrollRatio=i/t;r(function(){n.bar.style.cssText=\"height:\"+i/t*100+\"%; top:\"+n.el.scrollTop/t*100+\"%;right:-\"+(n.target.clientWidth-n.bar.clientWidth)+\"px;\"})}};t.addEventListener(\"DOMContentLoaded\",f);i.initEl=u;i.initAll=f;n.SimpleScrollbar=i})(window,document)\n        var scrollRoot = document.querySelectorAll(\".ss\");\n        var maxL = scrollRoot.length;\n        for (let ml = 0; ml < maxL; ml++) {\n            SimpleScrollbar.initEl(scrollRoot[ml]);\n        }\n    }\n\n    initMessage(schedulerRoot) {\n        this.eventsRootContainer = schedulerRoot;\n        this.messageDialogContainer = document.createElement('div');\n        this.messageDialogContainer.classList.add(\"event-message-container\");\n        this.messageDialog = document.createElement('div');\n        this.messageDialog.classList.add(\"event-message_\");\n        this.messageContent = document.createElement('div');\n        this.messageContent.classList.add(\"event-message__content\");\n\n        let messageClose = document.createElement('div');\n        messageClose.classList.add(\"event-message__btn\");\n        messageClose.addEventListener(\"click\", ()=> {\n            this.hideMessage();\n        });\n\n        this.messageDialog.appendChild(this.messageContent);\n        this.messageDialog.appendChild(messageClose);\n        this.messageDialogContainer.appendChild(this.messageDialog);\n        this.eventsRootContainer.appendChild(this.messageDialogContainer);\n    }\n\n    showMessage(message, hideMessageWithoutDelay){\n\n        if(message.length){\n            this.hideMessageWithoutDelay = hideMessageWithoutDelay;\n            this.messageContent.innerHTML = message;\n            this.messageDialog.classList.add(\"event-message_-visible\");\n            if (this.messageTimeout) {\n                clearTimeout(this.messageTimeout); // Clear timeout if before 'hideMessageWithDelay' was called\n            }\n        }\n    }\n\n    hideMessageWithDelay(delay){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout if this method was called before\n        this.messageTimeout = setTimeout(()=>{\n            this.hideMessage();\n        }, delay);\n    }\n\n    hideMessage(){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout and hide message immediately.\n        this.messageDialog.classList.remove(\"event-message_-visible\");\n    }\n\n    startMonth() {\n        let spinner = this.monthSchedulerRoot.querySelector('.spinner-container');\n        spinner.classList.remove('hide');\n        this.getJSON( this.getMonthEventsHandler, this.apiUrl, this.eventReqAttrs );\n    }\n\n    getMonthEventsHandler() {\n        let events;\n        let place;\n        let address;\n        let monthEvents = [];\n        let widget = this.widget;\n        let schedulerRoot = widget.monthSchedulerRoot;\n        let calendarWidgetRoot = schedulerRoot.parentNode.parentNode.parentNode;\n        let spinner = schedulerRoot.querySelector('.spinner-container');\n        let prm = [];\n        let url = 'https://app.ticketmaster.com/discovery/v2/events.json?apikey=aJVApdB1RoA41ejGebe0o4Ai9gufoCbd&latlong=36.1697096,-115.1236952&keyword=&startDateTime=2016-08-01T00:00:00Z&endDateTime=2016-09-02T23:59:59Z&classificationId=&radius=5&size=500&page=0&sort=date,asc';\n\n        if (this && this.readyState == XMLHttpRequest.DONE) {\n\n            if (this.status == 200) {\n                events = JSON.parse(this.responseText);\n\n                if (events.page.totalPages <= 1) {\n\n                    spinner.classList.add('hide');\n\n                    if (events.page.totalElements != 0) {\n                        let currentMonth = calendarWidgetRoot.getAttribute('w-period').substr(5, 2);\n                        let currentMonthDef = new Date(calendarWidgetRoot.getAttribute('w-period')).getMonth() + 1;\n                        if (currentMonthDef <= 9) currentMonthDef = '0' + currentMonthDef;\n                            if (currentMonth == '') {\n                              currentMonth = new Date().getMonth() + 1;\n                              if (parseInt(currentMonth) <= 9) currentMonth = '0' + currentMonth;\n                            }\n                        events._embedded.events.forEach(function (item) {\n                            if (item.hasOwnProperty('_embedded') && item._embedded.hasOwnProperty('venues')) {\n                                if (item._embedded.venues[0].hasOwnProperty('name')) {\n                                    place = item._embedded.venues[0].name + ', ';\n                                }\n                                else {\n                                    place = '';\n                                }\n                                if (item._embedded.venues[0].hasOwnProperty('address')) {\n                                    address = item._embedded.venues[0].address.line1;\n                                } else {\n                                    address = '';\n                                }\n                            }\n                            else {\n                                place = '';\n                                address = '';\n                            }\n\n                            let imgWidth;\n                            let index;\n                            item.images.forEach(function (img, i) {\n                                if (i == 0) imgWidth = img.width;\n                                if (imgWidth > img.width) {\n                                    imgWidth = img.width;\n                                    index = i;\n                                }\n                            });\n                            if (currentMonth == item.dates.start.localDate.substr(5, 2) || currentMonthDef == item.dates.start.localDate.substr(5, 2)) {\n                                if (+new Date( +new Date().getFullYear(), +new Date().getMonth(), + new Date().getDate()) <= +new Date(+item.dates.start.localDate.split('-')[0],(+item.dates.start.localDate.split('-')[1])-1,+item.dates.start.localDate.split('-')[2])) {\n                                    monthEvents.push({\n                                        'name': item.name,\n                                        'date': item.dates.start.localDate,\n                                        'time': item.dates.start.localTime,\n                                        'datetime': widget.formatDate({\n                                            day: item.dates.start.localDate,\n                                            time: item.dates.start.localTime\n                                        }),\n                                        'place': place + address,\n                                        'url': item.url,\n                                        'img': (item.hasOwnProperty('images') && item.images[index] != undefined) ? item.images[index].url : '',\n                                    });\n                                }\n                            }\n\n                        });\n                    }\n                    else {\n                        monthEvents[0] = ({\n                            date: '',\n                            time: '',\n                        });\n                        widget.showMessage(\"No results were found.<br/>Here other options for you.\");\n                        widget.hideMessageWithDelay(widget.hideMessageDelay);\n                    }\n\n                    let monthEventsSort = {};\n                    let eventsArr = [];\n                    let tDate = '';\n\n                    if (monthEvents[0]) {\n                        tDate = monthEvents[0].date;\n                    }\n                    else {\n                        tDate = '';\n                    }\n\n                    for (let e = 0, l = monthEvents.length; e < l; e++) {\n                        if (tDate == monthEvents[e].date) {\n                            eventsArr.push(monthEvents[e]);\n                            let day = tDate.toString().substr(8,2);\n                            if (day.substr(0,1) == '0') day = day.substr(1,1);\n                            monthEventsSort[day] = monthEvents[e];\n                        }\n                        else {\n                            let day = tDate.toString().substr(8,2);\n                            if (day.substr(0,1) == '0') day = day.substr(1,1);\n                            monthEventsSort[day] = eventsArr;\n                            eventsArr = [];\n                            eventsArr.push(monthEvents[e]);\n                        }\n                        tDate = monthEvents[e].date;\n\n                        if (eventsArr.lenght != 0) {\n                            let dayNo = eventsArr[0].date.substr(8,2);\n                            if (dayNo.substr(0,1) == '0') dayNo = dayNo.substr(1,1);\n                            monthEventsSort[dayNo] = eventsArr;\n                        }\n                    }\n\n                    let calendarClass = 'calendar';\n                    let year = new Date().getFullYear();\n                    let month = new Date().getMonth() + 1;\n\n\n                    if (calendarWidgetRoot.getAttribute(\"w-period\") != 'week') {\n                        if (calendarWidgetRoot.getAttribute(\"w-period\").length == 7) {\n                            year = calendarWidgetRoot.getAttribute(\"w-period\").substr(0, 4);\n                            month = calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 7);\n                        }\n                    }\n\n                    var elem = schedulerRoot.getElementsByClassName(calendarClass)[0];\n                    var mon = parseInt(month) - 1;\n                    var d = new Date(year, mon);\n                    var table = '<table><tr><th>s</th><th>m</th><th>t</th><th>w</th><th>t</th><th>f</th><th>s</th></tr><tr>';\n                    var tmpD = new Date(year, mon);\n                    var outEnd = [];\n                    for (var i = 0; i < d.getDay(); i++) {\n                        tmpD.setDate(tmpD.getDate() - 1);\n                        outEnd[i] = '<td class=\"dis\">' + tmpD.getDate() + '</td>';\n                    }\n                    outEnd.reverse();\n                    table += outEnd.join('');\n                    let tableRowMonth = 0;\n                    let tail_ = 'tail';\n                    let popup_ = 'popup ';\n\n                    while (d.getMonth() == mon) {\n                        table += '<td';\n                        if (new Date().getMonth() == d.getMonth() && new Date().getDate() == d.getDate()) table += ' class=\"today\"';\n                        table += '>';\n                        if (monthEventsSort[d.getDate()] != undefined) {\n                            let eventsCount = monthEventsSort[d.getDate()].length;\n                            if (eventsCount === undefined) eventsCount = 1;\n                            table += '<span class=\"round-holder\"><span class=\"round\">' + d.getDate() + '<span class=\"count\">' + eventsCount + '</span></span></span>';\n\n                            table += '<span class=\"' + tail_ + '\"></span>';\n                            table += '<div class=\"' + popup_ + ' ';\n                            if (eventsCount == 1) table += 'single ';\n                            table += 'ss\" tabindex=\"-1\">';\n\n                            table += '<div class=\"ss-container\">';\n\n                            let url, img, name, datetime, place, eventsLenght;\n\n                            if (monthEventsSort[d.getDate()].length == undefined) eventsLenght = 1;\n                            else eventsLenght = monthEventsSort[d.getDate()].length;\n\n                            for(let e=0, l = eventsLenght; e < l; e++) {\n                                if (monthEventsSort[d.getDate()] && monthEventsSort[d.getDate()][e]) {\n                                    url = monthEventsSort[d.getDate()][e].url;\n                                    img = monthEventsSort[d.getDate()][e].img;\n                                    name = monthEventsSort[d.getDate()][e].name;\n                                    datetime = monthEventsSort[d.getDate()][e].datetime;\n                                    place = monthEventsSort[d.getDate()][e].place;\n                                }\n                                else {\n                                    url = monthEventsSort[d.getDate()].url;\n                                    img = monthEventsSort[d.getDate()].img;\n                                    name = monthEventsSort[d.getDate()].name;\n                                    datetime = monthEventsSort[d.getDate()].datetime;\n                                    place = monthEventsSort[d.getDate()].place;\n                                }\n                                table += '<span class=\"event\">';\n                                table += '<span class=\"event-holder\">';\n                                table += '<a href=\"' + url + '\" target=\"_blank\">';\n                                if (img !=='' && img.length !== 0){\n                                    table += '<span class=\"img bg-cover-default\" style=\"background: url(' + img + ') center center no-repeat\"></span>'\n                                }else{ table += '<span class=\"img bg-cover-default\" ></span>';}\n                                table += '<span class=\"name\">' + name + '</span>';\n                                table += '</a>';\n                                table += '<span class=\"date\">' + datetime + '</span>';\n                                table += '<span class=\"place\">' + place + '</span>';\n                                table += '</span>';\n                                table += '</span>';\n                            }\n\n                            table += '</div>';\n                            table += '</div>';\n                        }\n                        else {\n                            table += d.getDate();\n                        }\n                        table += '</td>';\n\n                        if (d.getDay() % 7 == 6) {\n                            tableRowMonth++;\n                            if (tableRowMonth > 1) {\n                                tail_ = 'tail-up';\n                                popup_ = 'popup-up ';\n                            }\n                            table += '</tr><tr>';\n                        }\n\n                        d.setDate(d.getDate() + 1);\n                    }\n                    if (d.getDay() != 0) {\n                        d.setDate(d.getDate() - 1);\n                        for (var i = d.getDay(); i < 6; i++) {\n                            d.setDate(d.getDate() + 1);\n                            table += '<td class=\"dis\">' + d.getDate() + '</td>';\n                        }\n                    }\n                    table += '</tr></table><span class=\"month-update\"></span>';\n                    elem.innerHTML = table;\n                    widget.addScroll();\n\n                }\n                else {\n                    monthEvents = [];\n                    let monthEventsConcat = [];\n                    let l = parseInt(events.page.totalPages)-1;\n                    for (i = 0; i <= l; i++) {\n                        let attrs = widget.eventReqAttrs;\n                        attrs.page = i;\n                        attrs = Object.keys(attrs).map(function (key) {\n                            return `${key}=${attrs[key]}`;\n                        }).join(\"&\");\n                        let url;\n                        url= widget.apiUrl + [url, attrs].join(\"?\");\n                        let thisSchedulerRoot = widget.monthSchedulerRoot.parentNode.parentNode.parentNode;\n                        if (thisSchedulerRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + thisSchedulerRoot.getAttribute('w-postalcodeapi');\n                        url += '&sort=date,asc';\n                        prm.push(widget.getJsonAsync(url));\n                    }\n\n                    Promise.all(prm).then(value => {\n                        spinner.classList.add('hide');\n                        let le = value.length + 1;\n                        var curMonth;\n                        if (calendarWidgetRoot.getAttribute(\"w-period\") == 'week') {\n                            curMonth = new Date().getMonth() + 1;\n                        }\n                        else {\n                            if (calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 1) == '0') {\n                                curMonth = calendarWidgetRoot.getAttribute(\"w-period\").substr(6, 1);\n                            }\n                            else {\n                                curMonth = calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 2);\n                            }\n                        }\n                        for (var e = 0; e <= le; e++) {\n                            if(value[e] && value[e]._embedded && value[e]._embedded.events){\n                                value[e]._embedded.events.forEach(function (item) {\n                                    if (item.hasOwnProperty('_embedded') && item._embedded.hasOwnProperty('venues')) {\n                                        if (item._embedded.venues[0].hasOwnProperty('name')) {\n                                            place = item._embedded.venues[0].name + ', ';\n                                        }\n                                        else {\n                                            place = '';\n                                        }\n                                        if (item._embedded.venues[0].hasOwnProperty('address')) {\n                                            address = item._embedded.venues[0].address.line1;\n                                        } else {\n                                            address = '';\n                                        }\n                                    }\n                                    else {\n                                        place = '';\n                                        address = '';\n                                    }\n\n                                    let imgWidth;\n                                    let index;\n                                    if (item.hasOwnProperty('images')) {\n                                        item.images.forEach(function (img, i) {\n                                            if (i == 0) imgWidth = img.width;\n                                            if (imgWidth > img.width) {\n                                                imgWidth = img.width;\n                                                index = i;\n                                            }\n                                        });\n                                    }\n                                    let newDate = item.dates.start.localDate.substr(5,2);\n                                    if (parseInt(curMonth) === parseInt(newDate))  {\n                                        if (+new Date( +new Date().getFullYear(), +new Date().getMonth(), +new Date().getDate()) <= +new Date(+item.dates.start.localDate.split('-')[0],(+item.dates.start.localDate.split('-')[1])-1,+item.dates.start.localDate.split('-')[2])) {\n                                            monthEvents.push({\n                                                'name': item.name,\n                                                'date': item.dates.start.localDate,\n                                                'time': item.dates.start.localTime,\n                                                'datetime': widget.formatDate({\n                                                    day: item.dates.start.localDate,\n                                                    time: item.dates.start.localTime\n                                                }),\n                                                'place': place + address,\n                                                'url': item.url,\n                                                'img': (item.hasOwnProperty('images') && item.images[index] != undefined) ? item.images[index].url : '',\n                                            });\n                                        }\n                                    }\n                                });\n                            }\n                        }\n                        monthEventsConcat.push(monthEvents);\n                        monthEvents = monthEventsConcat[0];\n\n                        let monthEventsSort = {};\n                        let eventsArr = [];\n                        let tDate = '';\n                        if (monthEvents[0]) {\n                            tDate = monthEvents[0].date;\n                        }\n                        else {\n                            tDate = '';\n                        }\n\n                        for (let e = 0, l = monthEvents.length; e < l; e++) {\n                            if (tDate == monthEvents[e].date) {\n                                eventsArr.push(monthEvents[e]);\n                                let day = tDate.toString().substr(8,2);\n                                if (day.substr(0,1) == '0') day = day.substr(1,1);\n                                monthEventsSort[day] = monthEvents[e];\n                            }\n                            else {\n                                let day = tDate.toString().substr(8,2);\n                                if (day.substr(0,1) == '0') day = day.substr(1,1);\n                                monthEventsSort[day] = eventsArr;\n                                eventsArr = [];\n                                eventsArr.push(monthEvents[e]);\n                            }\n                            tDate = monthEvents[e].date;\n\n                            if (eventsArr.lenght != 0) {\n                                let dayNo = eventsArr[0].date.substr(8,2);\n                                if (dayNo.substr(0,1) == '0') dayNo = dayNo.substr(1,1);\n                                monthEventsSort[dayNo] = eventsArr;\n                            }\n                        }\n\n                        let calendarClass = 'calendar';\n                        let year = new Date().getFullYear();\n                        let month = new Date().getMonth() + 1;\n\n\n                        if (calendarWidgetRoot.getAttribute(\"w-period\") != 'week') {\n                            if (calendarWidgetRoot.getAttribute(\"w-period\").length == 7) {\n                                year = calendarWidgetRoot.getAttribute(\"w-period\").substr(0, 4);\n                                month = calendarWidgetRoot.getAttribute(\"w-period\").substr(5, 7);\n                            }\n                        }\n\n                        var elem = schedulerRoot.getElementsByClassName(calendarClass)[0];\n                        var mon = parseInt(month) - 1;\n                        var d = new Date(year, mon);\n                        var table = '<table><tr><th>s</th><th>m</th><th>t</th><th>w</th><th>t</th><th>f</th><th>s</th></tr><tr>';\n                        var tmpD = new Date(year, mon);\n                        var outEnd = [];\n                        for (var i = 0; i < d.getDay(); i++) {\n                            tmpD.setDate(tmpD.getDate() - 1);\n                            outEnd[i] = '<td class=\"dis\">' + tmpD.getDate() + '</td>';\n                        }\n                        outEnd.reverse();\n                        table += outEnd.join('');\n                        let tableRowMonth = 0;\n                        let tail_ = 'tail';\n                        let popup_ = 'popup ';\n\n                        while (d.getMonth() == mon) {\n                            table += '<td';\n                            if (new Date().getMonth() == d.getMonth() && new Date().getDate() == d.getDate()) table += ' class=\"today\"';\n                            table += '>';\n                            if (monthEventsSort[d.getDate()] != undefined) {\n                                let eventsCount = monthEventsSort[d.getDate()].length;\n                                if (eventsCount === undefined) eventsCount = 1;\n                                table += '<span class=\"round-holder\"><span class=\"round\">' + d.getDate() + '<span class=\"count\">' + eventsCount + '</span></span></span>';\n\n                                table += '<span class=\"' + tail_ + '\"></span>';\n                                table += '<div class=\"' + popup_ + ' ';\n                                if (eventsCount == 1) table += 'single ';\n                                table += 'ss\" tabindex=\"-1\">';\n\n                                table += '<div class=\"ss-container\">';\n\n                                let url, img, name, datetime, place, eventsLenght;\n\n                                if (monthEventsSort[d.getDate()].length == undefined) eventsLenght = 1;\n                                else eventsLenght = monthEventsSort[d.getDate()].length;\n\n                                for(let e=0, l = eventsLenght; e < l; e++) {\n                                    if (monthEventsSort[d.getDate()] && monthEventsSort[d.getDate()][e]) {\n                                        url = monthEventsSort[d.getDate()][e].url;\n                                        img = monthEventsSort[d.getDate()][e].img;\n                                        name = monthEventsSort[d.getDate()][e].name;\n                                        datetime = monthEventsSort[d.getDate()][e].datetime;\n                                        place = monthEventsSort[d.getDate()][e].place;\n                                    }\n                                    else {\n                                        url = monthEventsSort[d.getDate()].url;\n                                        img = monthEventsSort[d.getDate()].img;\n                                        name = monthEventsSort[d.getDate()].name;\n                                        datetime = monthEventsSort[d.getDate()].datetime;\n                                        place = monthEventsSort[d.getDate()].place;\n                                    }\n                                    table += '<span class=\"event\">';\n                                    table += '<span class=\"event-holder\">';\n                                    table += '<a href=\"' + url + '\" target=\"_blank\">';\n                                    if (img !=='' && img.length !== 0){\n                                        table += '<span class=\"img bg-cover-default\" style=\"background: url(' + img + ') center center no-repeat\"></span>'\n                                    }else{ table += '<span class=\"img bg-cover-default\" ></span>';}\n                                    table += '<span class=\"name\">' + name + '</span>';\n                                    table += '</a>';\n                                    table += '<span class=\"date\">' + datetime + '</span>';\n                                    table += '<span class=\"place\">' + place + '</span>';\n                                    table += '</span>';\n                                    table += '</span>';\n                                }\n\n                                table += '</div>';\n                                table += '</div>';\n                            }\n                            else {\n                                table += d.getDate();\n                            }\n                            table += '</td>';\n\n                            if (d.getDay() % 7 == 6) {\n                                tableRowMonth++;\n                                if (tableRowMonth > 1) {\n                                    tail_ = 'tail-up';\n                                    popup_ = 'popup-up ';\n                                }\n                                table += '</tr><tr>';\n                            }\n\n                            d.setDate(d.getDate() + 1);\n                        }\n                        if (d.getDay() != 0) {\n                            d.setDate(d.getDate() - 1);\n                            for (var i = d.getDay(); i < 6; i++) {\n                                d.setDate(d.getDate() + 1);\n                                table += '<td class=\"dis\">' + d.getDate() + '</td>';\n                            }\n                        }\n                        table += '</tr></table><span class=\"month-update\"></span>';\n                        elem.innerHTML = table;\n                        widget.addScroll();\n\n\n                        var rounds = schedulerRoot.querySelectorAll(\"span.round-holder\");\n                        for (var x = 0; x < rounds.length; x++) {\n                            rounds[x].addEventListener(\"click\", function (e) {\n                                this.classList.add(\"active\");\n                                this.nextElementSibling.classList.add(\"show\");\n                                this.nextElementSibling.nextElementSibling.classList.add(\"show\");\n                                this.nextElementSibling.nextElementSibling.focus();\n                            }, false);\n                        }\n\n                        var popups = schedulerRoot.querySelectorAll(\".popup, .popup-up\");\n                        for (var y = 0; y < popups.length; y++) {\n                            popups[y].addEventListener(\"blur\", function (e) {\n                                let self = this;\n                                setTimeout(function () {\n                                    self.previousElementSibling.classList.remove(\"show\");\n                                    self.classList.remove(\"show\");\n                                    self.previousElementSibling.previousElementSibling.classList.remove('active');\n                                }, 127);\n                            }, false);\n                        }\n\n                        var monthUpdate = schedulerRoot.getElementsByClassName('month-update')[0];\n                        if (monthUpdate != null) {\n                            monthUpdate.addEventListener('click', function () {\n                                widget.update();\n                            });\n                        }\n\n                    }, reason => {\n                        console.log(reason)\n                    });\n                }\n\n            }\n            else if (this.status == 400) {\n                console.log('There was an error 400');\n            }\n            else {\n                console.log('something else other than 200 was returned');\n            }\n        }\n\n        var rounds = schedulerRoot.querySelectorAll(\"span.round-holder\");\n        for (var x = 0; x < rounds.length; x++) {\n            rounds[x].addEventListener(\"click\", function (e) {\n                this.classList.add(\"active\");\n                this.nextElementSibling.classList.add(\"show\");\n                this.nextElementSibling.nextElementSibling.classList.add(\"show\");\n                this.nextElementSibling.nextElementSibling.focus();\n            }, false);\n        }\n\n        var popups = schedulerRoot.querySelectorAll(\".popup, .popup-up\");\n        for (var y = 0; y < popups.length; y++) {\n            popups[y].addEventListener(\"blur\", function (e) {\n                let self = this;\n                setTimeout(function () {\n                    self.previousElementSibling.classList.remove(\"show\");\n                    self.classList.remove(\"show\");\n                    self.previousElementSibling.previousElementSibling.classList.remove('active');\n                }, 127);\n            }, false);\n        }\n\n        var monthUpdate = schedulerRoot.getElementsByClassName('month-update')[0];\n        if (monthUpdate != null) {\n            monthUpdate.addEventListener('click', function () {\n                widget.update();\n            });\n        }\n\n    }\n\n    getMonthes() {\n        var MONTH_NAMES = ['January','February','March','April','May','June','July','August','September','October','November','December'];\n        let year = new Date().getFullYear();\n        let month = new Date().getMonth();\n        let nowMonth = new Date().getMonth();\n        let nowMonthTmp = nowMonth;\n        let calendarWidgetRoot = this.monthSchedulerRoot.parentNode.parentNode.parentNode;\n\n        if (calendarWidgetRoot.getAttribute(\"w-period\") != 'week') {\n\n            if (calendarWidgetRoot.getAttribute(\"w-period\").length != 7) {\n                year =  new Date().getFullYear();\n                month = new Date().getMonth() + 1;\n                if (month <= 9) month = '0' + month;\n                nowMonth = new Date().getMonth();\n            }\n            else {\n                year = calendarWidgetRoot.getAttribute(\"w-period\").substr(0,4);\n                month = calendarWidgetRoot.getAttribute(\"w-period\").substr(5,2);\n                nowMonth = calendarWidgetRoot.getAttribute(\"w-period\").substr(5,2);\n                if (calendarWidgetRoot.getAttribute(\"w-period\").substr(5,1) == '0') nowMonth = calendarWidgetRoot.getAttribute(\"w-period\").substr(6,1);\n                nowMonth = parseInt(nowMonth - 1);\n            }\n            nowMonthTmp = nowMonth;\n            if (new Date().getFullYear() != year) {\n                nowMonth = 0;\n            }\n            else {\n                nowMonth = new Date().getMonth();\n            }\n        }\n\n        let content = '';\n        content += '<span class=\"selector-title\">' + MONTH_NAMES[nowMonthTmp]+ '</span>';\n        content += '<span class=\"selector-content\" tabindex=\"-1\">';\n\n        let countMonth = 11;\n        if (new Date().getFullYear() != year) countMonth = 6;\n        for (let i = nowMonth; i<=countMonth; i++) {\n            content += '<span ';\n            if (i == nowMonth) content += 'class=\"active\" ';\n            if (i < 9) month = '0' + parseInt(i+1); else month = parseInt(i+1);\n            content += 'w-period=\"' + year + '-' + month + '\">' + MONTH_NAMES[i] + '</span>';\n        }\n        content += '</span>';\n        return content;\n    }\n\n    getCategories() {\n        let calendarWidgetRoot = this.monthSchedulerRoot.parentNode.parentNode.parentNode;\n        let active = calendarWidgetRoot.getAttribute('w-classificationid');\n        let activeId = calendarWidgetRoot.getAttribute('w-classificationid');\n        switch (active) {\n            case 'KZFzniwnSyZfZ7v7na':\n                active = 'Arts & Theatre';\n                break\n            case 'KZFzniwnSyZfZ7v7nn':\n                active = 'Film';\n                break\n            case 'KZFzniwnSyZfZ7v7n1':\n                active = 'Miscellaneous';\n                break\n            case 'KZFzniwnSyZfZ7v7nJ':\n                active = 'Music';\n                break\n            case 'KZFzniwnSyZfZ7v7nE':\n                active = 'Sports';\n                break\n            default:\n                active = 'All Events';\n        }\n        let content = '<span class=\"selector-title\" w-classificationid=\"' + activeId + '\">';\n        content += active;\n        content += '</span>';\n        content += '<span class=\"selector-content\" tabindex=\"-1\">';\n        content += '<span class=\"active\" w-classificationId=\"\">All Events</span>';\n        content += '<span w-classificationId=\"KZFzniwnSyZfZ7v7na\">Arts & Theatre</span>';\n        content += '<span w-classificationId=\"KZFzniwnSyZfZ7v7nn\">Film</span>';\n        content += '<span w-classificationId=\"KZFzniwnSyZfZ7v7n1\">Miscellaneous</span>';\n        content += '<span w-classificationId=\"KZFzniwnSyZfZ7v7nJ\">Music</span>';\n        content += '<span w-classificationId=\"KZFzniwnSyZfZ7v7nE\">Sports</span>';\n        content += '</span>';\n        return content;\n    }\n\n    update() {\n        let schedulerRoot = this.monthSchedulerRoot;\n        let delLeftselector = schedulerRoot.parentNode.getElementsByClassName('sliderLeftSelector')[0];\n        delLeftselector.parentElement.removeChild(delLeftselector);\n        let delRightselector = schedulerRoot.parentNode.getElementsByClassName('sliderRightSelector')[0];\n        delRightselector.parentElement.removeChild(delRightselector);\n\n        let leftSelector = new SelectorControls(schedulerRoot.parentNode, 'sliderLeftSelector', this.getMonthes(), 'period', this.update.bind(this));\n        let RightSelector = new SelectorControls(schedulerRoot.parentNode, 'sliderRightSelector', this.getCategories(), 'classificationId', this.update.bind(this));\n        let month = schedulerRoot.getElementsByClassName('calendar')[0];\n        schedulerRoot.removeChild(month);\n        this.monthRootContainer = document.createElement(\"div\");\n        this.monthRootContainer.classList.add(\"calendar\");\n        schedulerRoot.appendChild(this.monthRootContainer);\n        this.startMonth();\n    }\n\n    constructor(root) {\n        if (!root) return;\n        this.monthSchedulerRoot = root;\n        if (this.monthSchedulerRoot.parentNode.querySelector('.sliderLeftSelector') == null) {\n            let leftSelector = new SelectorControls(this.monthSchedulerRoot.parentNode, 'sliderLeftSelector', this.getMonthes(), 'period', this.update.bind(this));\n            let RightSelector = new SelectorControls(this.monthSchedulerRoot.parentNode, 'sliderRightSelector', this.getCategories(), 'classificationId', this.update.bind(this));\n        }\n        if (this.monthSchedulerRoot.querySelector('.calendar') == null) {\n            this.initMessage(this.monthSchedulerRoot);\n            this.calendarRootContainer = document.createElement(\"div\");\n            this.calendarRootContainer.classList.add(\"calendar\");\n            this.monthSchedulerRoot.appendChild(this.calendarRootContainer);\n            this.startMonth();\n        }\n    }\n\n\n}\n\nclass YearScheduler {\n\n    get apiUrl(){ return \"https://app.ticketmaster.com/discovery/v2/events.json\"; }\n\n    get eventReqAttrs(){\n        let calendarWidgetRoot = this.yearSchedulerRoot.parentNode.parentNode.parentNode;\n        let tmapikey = '',\n            keyword = '',\n            radius;\n        let attrs = {},\n            params = [\n                {\n                    attr: 'tmapikey',\n                    verboseName: 'apikey'\n                },\n                {\n                    attr: 'keyword',\n                    verboseName: 'keyword'\n                },\n                {\n                    attr: 'city',\n                    verboseName: 'city'\n                },\n                {\n                    attr: 'countrycode',\n                    verboseName: 'countryCode'\n                },\n                {\n                    attr: 'size',\n                    verboseName: 'size'\n                },\n                {\n                    attr: 'radius',\n                    verboseName: 'radius'\n                },\n                {\n                    attr: 'classificationid',\n                    verboseName: 'classificationId'\n                },\n                {\n                    attr: 'attractionid',\n                    verboseName: 'attractionId'\n                },\n                {\n                    attr: 'promoterid',\n                    verboseName: 'promoterId'\n                },\n                {\n                    attr: 'venueid',\n                    verboseName: 'venueId'\n                },\n                {\n                    attr: 'segmentid',\n                    verboseName: 'segmentId'\n                }\n            ];\n\n        let date = new Date();\n        let startmonth, startdate, endmonth, enddate, startDateTime, endDateTime;\n        let classificationid = '';\n        let countrycode = '';\n        let city = '';\n        let firstDay = new Date(date.getFullYear(), date.getMonth(), 1);\n        let lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n        let latlong = '34.0390107,-118.2672801';\n\n        if (firstDay.getMonth()+1 <=9) startmonth = '0' + (firstDay.getMonth()+1); else startmonth = firstDay.getMonth()+1;\n        startdate = '0' + firstDay.getDate();\n        if (lastDay.getMonth()+1 <=9) endmonth = '0' + (lastDay.getMonth()+1); else endmonth = lastDay.getMonth()+1;\n        enddate = lastDay.getDate();\n        startDateTime = firstDay.getFullYear() + '-' + startmonth + '-' + startdate + 'T00:00:00Z';\n        endDateTime = lastDay.getFullYear() + '-12-31T23:59:59Z';\n\n        if (calendarWidgetRoot.getAttribute(\"w-period\") != 'week') {\n\n            if (calendarWidgetRoot.getAttribute(\"w-period\").length != 4) {\n                firstDay =  new Date(date.getFullYear()) + '-01-01T00:00:00Z';\n                lastDay = new Date(date.getFullYear()) + '-12-31T23:59:59Z';\n            }\n            else {\n                firstDay = calendarWidgetRoot.getAttribute(\"w-period\") + '-01-01T00:00:00Z';\n                lastDay = parseInt(firstDay + 1) + '-12-31T23:59:59Z';\n            }\n            startDateTime = firstDay;\n            endDateTime = lastDay;\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-tmapikey\") != '') {\n            tmapikey = calendarWidgetRoot.getAttribute(\"w-tmapikey\");\n            /*\n            if (sessionStorage.getItem('tk-api-key')) {\n                tmapikey = sessionStorage.getItem('tk-api-key');\n                calendarWidgetRoot.setAttribute(\"w-tmapikey\", tmapikey);\n            }\n            */\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-latlong\") != '') {\n            latlong = document.querySelector('[w-type=\"calendar\"]').getAttribute(\"w-latlong\");\n        }\n\n        // if (latlong === null) latlong = '34.0390107,-118.2672801';\n\n        if (calendarWidgetRoot.getAttribute(\"w-keyword\") != '') {\n            keyword = calendarWidgetRoot.getAttribute(\"w-keyword\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-radius\") != '') {\n            radius = calendarWidgetRoot.getAttribute(\"w-radius\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-classificationId\") != '') {\n            classificationid = calendarWidgetRoot.getAttribute(\"w-classificationId\");\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-countrycode\") != null) {\n            countrycode = calendarWidgetRoot.getAttribute(\"w-countrycode\");\n            latlong = '';\n        }\n\n        if (calendarWidgetRoot.getAttribute(\"w-city\") != null) {\n            city = calendarWidgetRoot.getAttribute(\"w-city\");\n            latlong = '';\n        }\n\n        return {\n            \"apikey\": tmapikey,\n            \"latlong\": latlong,\n            \"countryCode\": countrycode,\n            \"city\": city,\n            \"keyword\": keyword,\n            \"startDateTime\": startDateTime,\n            \"endDateTime\": endDateTime,\n            \"classificationId\": classificationid,\n            \"radius\": radius,\n            \"size\": \"1\"\n        }\n    }\n\n    get messageRootContainer(){ return 'yearScheduler'; }\n\n    get hideMessageDelay(){ return 3000; }\n\n    getJsonAsync(url) {\n        return new Promise(function (resolve, reject) {\n            var xhr = new XMLHttpRequest();\n            xhr.open('GET', url);\n\n            xhr.onload = () => {\n                if (xhr.status === 200) {\n                    var result = JSON.parse(xhr.response);\n                    resolve(result.page.totalElements);\n                } else {\n                    reject(\"Error loading JSON!\");\n                }\n            }\n            xhr.onerror = () => {\n                reject(\"Error loading JSON!\");\n            };\n            xhr.send();\n        });\n    }\n\n    formatDate(date) {\n        var result = '';\n        if(!date.day) return result; // Day is required\n\n        function LZ(x) {\n            return (x < 0 || x > 9 ? \"\" : \"0\") + x\n        }\n        var MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],\n            DAY_NAMES = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],\n            dayArray = date.day.split('-'),\n            d = parseInt(dayArray[2]),\n            M = parseInt(dayArray[1]);\n\n        // var E = new Date(date.day).getDay();\n        var E = new Date(+date.day.split('-')[0],(+date.day.split('-')[1])-1,+date.day.split('-')[2]).getDay();\n        result = DAY_NAMES[E] + ', ' + MONTH_NAMES[M - 1] + ' ' + d + ', ' + dayArray[0];\n\n        if(!date.time) return result;\n\n        var timeArray = date.time.split(':'),\n            H = parseInt(timeArray[0]),\n            m = timeArray[1],\n            a = \"AM\";\n\n        if (H > 11) a = \"PM\";\n        if (H == 0) {\n            H = 12;\n        } else if (H > 12) {\n            H = H - 12;\n        }\n\n        return result + ' ' + LZ(H) + ':' + m + ' ' + a;\n    }\n\n    addScroll() {\n        (function(n,t){function u(n){n.hasOwnProperty(\"data-simple-scrollbar\")||Object.defineProperty(n,\"data-simple-scrollbar\",new SimpleScrollbar(n))}function e(n,i){function f(n){var t=n.pageY-u;u=n.pageY;r(function(){i.el.scrollTop+=t/i.scrollRatio})}function e(){n.classList.remove(\"ss-grabbed\");t.body.classList.remove(\"ss-grabbed\");t.removeEventListener(\"mousemove\",f);t.removeEventListener(\"mouseup\",e)}var u;n.addEventListener(\"mousedown\",function(i){return u=i.pageY,n.classList.add(\"ss-grabbed\"),t.body.classList.add(\"ss-grabbed\"),t.addEventListener(\"mousemove\",f),t.addEventListener(\"mouseup\",e),!1})}function i(n){for(this.target=n,this.bar='<div class=\"ss-scroll\">',this.wrapper=t.createElement(\"div\"),this.wrapper.setAttribute(\"class\",\"ss-wrapper\"),this.el=t.createElement(\"div\"),this.el.setAttribute(\"class\",\"ss-content\"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper);this.target.insertAdjacentHTML(\"beforeend\",this.bar);this.bar=this.target.lastChild;e(this.bar,this);this.moveBar();this.el.addEventListener(\"scroll\",this.moveBar.bind(this));this.el.addEventListener(\"mouseenter\",this.moveBar.bind(this));this.target.classList.add(\"ss-container\")}function f(){for(var i=t.querySelectorAll(\"*[ss-container]\"),n=0;n<i.length;n++)u(i[n])}var r=n.requestAnimationFrame||n.setImmediate||function(n){return setTimeout(n,0)};i.prototype={moveBar:function(){var t=this.el.scrollHeight,i=this.el.clientHeight,n=this;this.scrollRatio=i/t;r(function(){n.bar.style.cssText=\"height:\"+i/t*100+\"%; top:\"+n.el.scrollTop/t*100+\"%;right:-\"+(n.target.clientWidth-n.bar.clientWidth)+\"px;\"})}};t.addEventListener(\"DOMContentLoaded\",f);i.initEl=u;i.initAll=f;n.SimpleScrollbar=i})(window,document)\n        var scrollRoot = document.querySelectorAll(\".ss\");\n        var maxL = scrollRoot.length;\n        for (let ml = 0; ml < maxL; ml++) {\n            SimpleScrollbar.initEl(scrollRoot[ml]);\n        }\n    }\n\n    initMessage(schedulerRoot){\n        this.eventsRootContainer = schedulerRoot;\n        this.messageDialogContainer = document.createElement('div');\n        this.messageDialogContainer.classList.add(\"event-message-container\");\n        this.messageDialog = document.createElement('div');\n        this.messageDialog.classList.add(\"event-message_\");\n        this.messageContent = document.createElement('div');\n        this.messageContent.classList.add(\"event-message__content\");\n\n        let messageClose = document.createElement('div');\n        messageClose.classList.add(\"event-message__btn\");\n        messageClose.addEventListener(\"click\", ()=> {\n            this.hideMessage();\n        });\n\n        this.messageDialog.appendChild(this.messageContent);\n        this.messageDialog.appendChild(messageClose);\n        this.messageDialogContainer.appendChild(this.messageDialog);\n        this.eventsRootContainer.appendChild(this.messageDialogContainer);\n    }\n\n    showMessage(message, hideMessageWithoutDelay){\n\n        if(message.length){\n            this.hideMessageWithoutDelay = hideMessageWithoutDelay;\n            this.messageContent.innerHTML = message;\n            this.messageDialog.classList.add(\"event-message_-visible\");\n            if (this.messageTimeout) {\n                clearTimeout(this.messageTimeout); // Clear timeout if before 'hideMessageWithDelay' was called\n            }\n        }\n    }\n\n    hideMessageWithDelay(delay){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout if this method was called before\n        this.messageTimeout = setTimeout(()=>{\n            this.hideMessage();\n        }, delay);\n    }\n\n    hideMessage(){\n        if(this.messageTimeout) clearTimeout(this.messageTimeout); // Clear timeout and hide message immediately.\n        this.messageDialog.classList.remove(\"event-message_-visible\");\n    }\n\n    getYears() {\n        let now = new Date().getFullYear();\n        let content = '';\n        content += '<span class=\"selector-title\">Events in ' + now + '</span>';\n        content += '<span class=\"selector-content\" tabindex=\"-1\">';\n        for (let i = (now-1); i<(now+1); i++) {\n            content += '<span ';\n            if (i == now) content += 'class=\"active\" ';\n            content += 'w-period=\"' + (i+1) + '\">Events in ' + (i+1) + '</span>';\n        }\n        content += '</span>';\n        return content;\n    }\n\n    getLastDayOfMonth(year, month) {\n        var date = new Date(year, month + 1, 0);\n        return date.getDate();\n    }\n\n    startYear() {\n        let MONTH_NAMES = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];\n        let prm = [];\n        let year;\n        let schedulerRoot = this.yearSchedulerRoot.parentNode.parentNode.parentNode;\n        if (schedulerRoot.getAttribute(\"w-period\").length != 4) {\n            year = new Date().getFullYear();\n        }\n        else {\n            year = this.eventReqAttrs.startDateTime.substring(0,4);\n        }\n\n        let month = '01';\n\n        var xhr = new XMLHttpRequest();\n        var resp, dateOffset;\n\n\n        let latlongOffset = schedulerRoot.getAttribute(\"w-latlong\");\n        if (latlongOffset != null) {\n            xhr.open('GET', 'https://maps.googleapis.com/maps/api/timezone/json?language=en&location=' + schedulerRoot.getAttribute(\"w-latlong\") + '&timestamp=1331161200');\n            xhr.onload = function (e) {\n                if (xhr.readyState == 4 && xhr.status == 200) {\n                    resp = JSON.parse(xhr.responseText);\n                    dateOffset = parseInt(resp.rawOffset) + parseInt(resp.dstOffset);\n                }\n            };\n            xhr.send(null);\n        }\n        else {\n            dateOffset = undefined;\n        }\n\n        var currentMonth = parseInt(new Date().getMonth()) + 1;\n\n        for(let i = 1; i <= 12; i++) {\n\n            if (i<=9) month = '0' + i; else month = i;\n            let attrs = this.eventReqAttrs;\n\n            if (dateOffset !== undefined) {\n                var startDT = new Date(new Date(year, (i-1), 1, 0, 0, 0, 0).valueOf() - dateOffset*1000);\n                var finishDT = new Date(new Date(year, (i-1), this.getLastDayOfMonth(year, (i-1)), 23, 59, 59, 0).valueOf() - dateOffset*1000);\n                var startY = startDT.getFullYear();\n                var startM = startDT.getMonth() + 1;\n                if (startM <= 9) startM = '0' + startM;\n                var startD = startDT.getDate();\n                if (startD <= 9) startD = '0' + startD;\n                var startH = startDT.getHours();\n                if (startDT.getHours() <= 9) startH = '0' + startDT.getHours();\n                var startMn = startDT.getMinutes();\n                if (startDT.getMinutes() <= 9) startMn = '0' + startDT.getMinutes();\n                var startS = startDT.getSeconds();\n                if (startDT.getSeconds() <= 9) startS = '0' + startDT.getSeconds();\n                var finishY = finishDT.getFullYear();\n                var finishM = finishDT.getMonth() + 1;\n                if (finishM <= 9) finishM = '0' + finishM;\n                var finishD = finishDT.getDate();\n                if (finishD <= 9) finishD = '0' + finishD;\n                var finishH = finishDT.getHours();\n                if (finishDT.getHours() <= 9) finishH = '0' + finishDT.getHours();\n                var finishMn = finishDT.getMinutes();\n                if (finishDT.getMinutes() <= 9) finishMn = '0' + finishDT.getMinutes();\n                var finishS = finishDT.getSeconds();\n                if (finishDT.getSeconds() <= 9) finishS = '0' + finishDT.getSeconds();\n                attrs.startDateTime = startY + '-' + startM + '-' + startD + 'T' + startH + ':' + startMn + ':' + startS + 'Z';\n                attrs.endDateTime = finishY + '-' + finishM + '-' + finishD + 'T' + finishH + ':' + finishMn + ':' + finishS + 'Z';\n            }\n            else {\n                var currentMonth = parseInt(new Date().getMonth()) + 1;\n                if (currentMonth <=9) currentMonth = '0' + currentMonth;\n                var currentDay = new Date().getDate();\n                if (currentDay <=9) currentDay = '0' + currentDay;\n                if (!(year == new Date().getFullYear() && month == currentMonth)) currentDay = '01';\n                attrs.startDateTime = year + '-' + month + '-' + currentDay + 'T00:00:00Z';\n                attrs.endDateTime = year + '-' + month + '-' + this.getLastDayOfMonth(year, (i - 1)) + 'T23:59:59Z';\n            }\n            attrs = Object.keys(attrs).map(function(key){\n                return `${key}=${attrs[key]}`;\n            }).join(\"&\");\n            let url;\n            url = this.apiUrl + [url,attrs].join(\"?\");\n            let thisSchedulerRoot = this.yearSchedulerRoot.parentNode.parentNode.parentNode;\n            if (thisSchedulerRoot.getAttribute('w-postalcodeapi') != null) url += '&postalCode=' + thisSchedulerRoot.getAttribute('w-postalcodeapi');\n            url += '&sort=date,asc';\n            prm.push(this.getJsonAsync(url));\n        }\n\n\n        Promise.all(prm).then(value => {\n            var elem = this.yearSchedulerRoot.querySelector(\".year\");\n            let table = '<div class=\"monthes-container\">';\n            let month;\n            let curMonth = new Date().getMonth();\n            let curYear = new Date().getFullYear();\n            let noResults = true;\n            let messageContainer = schedulerRoot.querySelector('.event-message-container');\n\n            for (var i = 0; i < MONTH_NAMES.length; i++) {\n                table += '<div class=\"month\">';\n                table += '<span class=\"name';\n                if (year == curYear && curMonth == i) table += ' current';\n                table += '\">' + MONTH_NAMES[i] + '</span>';\n                if (parseInt(i+1) <= 9) month = '0' + parseInt(i+1); else month = parseInt(i+1);\n                if (value[i] !=0) table += '<a href=\"javascript:void(0)\" class=\"count\" rel=\"' + year + '-' + month + '\">' + value[i] + '</a>';\n                table += '</div>';\n                if (value[i] != 0) noResults = false;\n            }\n            table += '</div>';\n            elem.innerHTML = table;\n\n            this.yearSchedulerRoot.getElementsByClassName('spinner-container')[0].classList.add('hide');\n\n            if (noResults === true) {\n                this.showMessage(\"No results were found.<br/>Here other options for you.\", true);\n                this.hideMessageWithDelay(this.hideMessageDelay);\n            }\n\n            var rounds = schedulerRoot.querySelectorAll(\"a.count\");\n            for (var x = 0; x < rounds.length; x++) {\n                rounds[x].addEventListener(\"click\", function (e) {\n                    schedulerRoot.setAttribute('w-period', e.target.getAttribute('rel'));\n                    schedulerRoot.querySelectorAll('.tb')[2].click();\n                    schedulerRoot.getElementsByClassName('month-update')[0].click();\n                }, false);\n            }\n\n\n        }, reason => {\n            console.log(reason)\n        });\n\n    }\n\n    update() {\n        let schedulerRoot = this.yearSchedulerRoot;\n        let spinner = schedulerRoot.querySelector('.spinner-container');\n        spinner.classList.remove('hide');\n        let year = schedulerRoot.querySelector('.year');\n        schedulerRoot.removeChild(year);\n        this.yearRootContainer = document.createElement(\"div\");\n        this.yearRootContainer.classList.add(\"year\");\n        this.yearSchedulerRoot.appendChild(this.yearRootContainer);\n        this.startYear();\n    }\n\n    constructor(root) {\n        if (!root) return;\n        this.yearSchedulerRoot = root;\n        if (this.yearSchedulerRoot.parentNode.querySelector('.sliderLeftSelector') == null) {\n            let leftSelector = new SelectorControls(this.yearSchedulerRoot.parentNode, 'sliderLeftSelector', this.getYears(), 'period', this.update.bind(this));\n            let RightSelector = new SelectorControls(this.yearSchedulerRoot.parentNode, 'sliderRightSelector', '<span class=\"selector-title\">All Events</span><span class=\"selector-content\" tabindex=\"-1\"><span class=\"active\" w-classificationId=\"\">All Events</span><span w-classificationId=\"KZFzniwnSyZfZ7v7na\">Arts & Theatre</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nn\">Film</span><span w-classificationId=\"KZFzniwnSyZfZ7v7n1\">Miscellaneous</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nJ\">Music</span><span w-classificationId=\"KZFzniwnSyZfZ7v7nE\">Sports</span></span>', 'classificationId', this.update.bind(this));\n        }\n        if (this.yearSchedulerRoot.querySelector('.year') == null) {\n            this.yearRootContainer = document.createElement(\"div\");\n            this.yearRootContainer.classList.add(\"year\");\n            this.yearSchedulerRoot.appendChild(this.yearRootContainer);\n            this.initMessage(this.yearSchedulerRoot);\n            this.startYear();\n        }\n    }\n}\n\nlet widgetsCalendar = [];\nlet weekSchedulers = [];\nlet monthSchedulers = [];\nlet yearSchedulers = [];\n\n(function () {\n    let widgetContainers = document.querySelectorAll(\"div[w-type='calendar']\");\n    for (let i = 0; i < widgetContainers.length; ++i) {\n        widgetsCalendar.push(new TicketmasterCalendarWidget(widgetContainers[i]));\n        weekSchedulers.push(new WeekScheduler(widgetContainers[i].querySelector('.weekSсheduler')));\n        monthSchedulers.push(new MonthScheduler(widgetContainers[i].querySelector('.monthScheduler')));\n        yearSchedulers.push(new YearScheduler(widgetContainers[i].querySelector('.yearScheduler')));\n    }\n\n})();\n\nlet controls = new TabsControls;\n\nif(typeof module !== \"undefined\") {\n    module.exports = { widgetsCalendar , weekSchedulers, monthSchedulers, yearSchedulers };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./products-and-docs/widgets/calendar/1.0.0/src/main-widget.es6"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AChEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6mFA;AAkJA;AA+HA;AAoDA;AAQA;AAaA;AAIA;AA4CA;AAqGA;AAMA;AAOA;;;;;;;;AAaA;AA4CA;AAcA;AAkGA;AAQA;AAQA;AAQA;AAQA;AAmBA;AAMA;AAiBA;AAiBA;AAIA;AACA;AAIA;AAiCA;AAUA;AAoFA;AAoFA;AAeA;AAIA;AAYA;;;AAgDA;AAwFA;;;;;;AAQA;;AAkFA;AAmIA;AAGA;AAKA;AAGA;AAeA;AAUA;AAwRA;AAMA;AAOA;AA+CA;AAUA;;;;AA7KA;AAQA;AAk7BA;AAUA;AA0DA;AAMA;AAOA;;;;;AA9KA;AAQA;AAm+BA;AAUA;AA0DA;AAMA;AAOA;;;;;AAzJA;AAQA;;;","sourceRoot":""}