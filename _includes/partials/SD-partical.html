{% assign sorted_article = (site.pages | sort: 'order') %}
{% assign carousel_array = "" | split:"|"  %}
{% assign tab_array = "" | split:"|"  %}
{% assign topApp_array = "" | split:"|"  %}
{% assign topApp_showItems = 1 %}

{% for article in sorted_article %}
    {% if article.category == "sd-article" %}
        {% if article.places contains "header" %}
            {% assign carousel_array = carousel_array | push: {{article.img}} %}
        {% endif %}
        {% if article.tab %}
            {% assign tab_array = tab_array | push: {{article}} %}
        {% endif %}
        {% if article.places contains "top" %}
            {% assign topApp_array = topApp_array | push: {{article}} %}
        {% endif %}
    {% endif %}
{% endfor %}

{% for article in sorted_article %}
{% if article.category == "sd-article" %}
<h4>article.title : {{article.title}} , order: {{article.order}}</h4>
<h5>article.img : {{article.img}}</h5>
<h5>article.places : {{article.places | split: " ,"}}</h5>
<h5>article.summary : {{article.summary}}</h5>
<h5>article.tab : {{article.tab}}</h5>
<h5>carousel_array.length : {{carousel_array.size}}</h5>
{% endif %}
{% endfor %}


<div class="sd-article">
    <div class="article-header">
        <div id="myCarousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
                {%for slide in carousel_array %}
                    <li data-target="#myCarousel" data-slide-to="{{forloop.index0}}" {% if forloop.first == true %}class="active" {% endif %}></li>
                {% endfor %}
            </ol>

            <!-- Wrapper for slides -->
            <div class="carousel-inner" role="listbox">
                {%for slide in carousel_array %}
                    <div class="item{% if forloop.first == true %} active{% endif %}">
                        <img src="{{slide}}">
                    </div>
                {% endfor %}

                <!--show static img if carousel_array.size < 1 -->
                {% if carousel_array.size < 1 %}
                    <img src="http://www.w3schools.com/bootstrap/img_flower.jpg">
                    <div class="item active">
                        <img src="http://www.w3schools.com/bootstrap/img_flower.jpg">
                    </div>
                {% endif %}
            </div>

            <!-- Left and right controls -->
            <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                <span class="" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                <span class="" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>

    <h3>Procucts and application</h3>
    {%for tab in tab_array %}
        <div class="item">
            <p>tab name: {{ tab.tab }}</p>
            <p>tab full info: {{tab }}</p>
        </div>
    {% endfor %}

    {% if topApp_array.size > 0 %}
    <h3>our top application</h3>
    {%for topApp in topApp_array %}
    <div class="item" {% if forloop.index0 >= topApp_showItems %}style="display:none" {% endif %}>
        <p>topApp title: {{ topApp.title }}</p>
        <p>topApp full info: {{topApp  | markdownify }}</p>
    </div>
    {% endfor %}
    {% if topApp_array.size >= topApp_showItems %}
    <button>show more</button>
    {% endif %}

    {% endif %}

</div>
<script>
var tabExample = [
    {% for item in tab_array %}
    {tab:'{{ item.tab | escape }}', img: '{{ item.img | escape}}', summary: '{{ item.summary | escape }}'}{% unless forloop.last %},{% endunless %}
    {% endfor %}
];
console.log(tabExample);
</script>