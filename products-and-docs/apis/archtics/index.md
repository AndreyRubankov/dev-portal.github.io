---
layout: documentation
categories:
- documentation
- archtics
title: Archtics API
excerpt: The Ticketmaster Archtics API
keywords: Archtics API
---

{: .article}
# Archtics API

Archtics Ticketing Service (ATS) API Specification
{: .lead}

## Overview
{: #overview }
API Specification for add/update and receive an Archtics account, or add a name to an existing Archtics account

## Customer Query

**Purpose:** Customer query returns basic account and name information based on an input account-id, email address or external-id.   It can also be used to validate a customer’s pin.

**Cache:**	No.  

**Use:** This API call can be used to return customer (name) attributes.  There are several input parameter options:

### NOTES:
When providing email-address:  Based on the name that is associated with the input email address, the attributes of the name returned, along with all accounts linked to the email address and certain account-level information for the main account that the name associated with the email address is primary.

When providing alternate-id:  Based on the name associated with the input external-id, the attributes of the name are returned, along with all accounts linked to the email address and certain account-level information for the account that the name associated with the email address is primary.    Note: the referenced alternate-id (name level) is not to be confused with external-id (account level)

Pin vs system account – When customer query is called with an PIN, the pin must match the pin for the name (if email or alternate-id are provided) or the primary name on the account (if account-id is provided) to successfully return.  This is intended as a means of authenticating the consumer.    

Customer query can also be called with a calling reason of 'S' (system), in which case the pin is not required.    The use case is typically a customer service application, where the calling application has other means of authenticating the consumer.

-	input = `acct_id`
    *	the attributes of the primary name are returned, along with certain account-level attributes (login attempts,rec_status,etc. ).
    *	No secondary name information is returned.
-	input = `email_address`
    * the attributes of the name associated with the email address are returned,
    * a delimited list of each account linked to the email address.
    *	certain account-level information for the account associated where the email address is primary.
-	output = `account_group`
    *	returns an array of account groups that an account belongs to
-	output = `account_id_list`
    *	This is a list of ACCOUNTS to which this NAME (email) is associated.  The first `acct_id` in that list is always the primary (main) account for that person/name/email.  The order of the remaining account ID’s is in ‘nickname’ order.
	
+	System only returns `ext_system_id_2` and `ext_system_id_1` (account-level)
+	If the input parameter includes the correct PIN, the same PIN will be returned in the output.  Otherwise, PIN is never returned in the call.


### Input and Output Parameter Details:

|Parm#	| Parameter Name	     |I/O	   |Data Type  |	Reqd	| Description|
|:------|:---------------------|:-----:|:----------|:------:|:-----------|
|I_1.		|`cmd`	|I|	Char(32)	|Y|	Always "customer_query"  |
|I_2.		|`ref`	|I|	Char(32)	|N|	Reference attribute; echoed to result |
|I_3.		|`uid`	|I|	Char(12)	|Y|	User ID (used on connection to DB). <br/> Uid will be provided by TM |
|I_4.		|`pwd`	|I|	Char(36)	|N|	If password is passed, it will be enforced. |
|I_5.		|`dsn`	|I|	Char(32)	|Y|	Data Source Name (e.g. DB) to connect to |
|I_6.		|`site_name`	|I|	Char (24)	|Y|	Identifies the web-site the consumer is logging in from |
|I_7.		|`acct_id`	|I|	Integer	|Y/N/N| Account ID |
|I_8.		|`email`	|I|	Char(100)	|N/Y/N|	Email address |
|I_9.		|`pin`	|I|	Char(250)	|Y/Y/N|	Personal Identification Number (e.g. password). PIN must match either the consumer PIN (on account) –or- a "system" PIN that can be derived from the input email address or acct_id. |  
|I_10.		|`cust_name_id`	|I|	Integer	|N/na/na|	Used in conjunction with acct_id, to get the customer information that is not the primary information on the account. |
|I_11.		|`alt_id`	|I|	Varchar(50)	|na/na/Y|	Optional search by Alternate Id.  Only used if neither acct_id nor email is provided.   If this is provided, can further limit by alt_id_type. alt_id is ignored if email or acct_id is provided |
|I_12.		|`alt_id_type`	|I|	Varchar(6)	|na/na/N|	Only used with input of  alt_id |
|I_13.		|`call_reason`	|I|	Char(1)	|N|	A call reason of "S" means that it is a call generated by an external system, rather than the actual consumer.  For this call reason, the PIN is not required.  The consumer pin is also not returned in these cases. Required when only alt_id is provided. |
|O_1.		|`ref`	|O|	Char(32)	|N|	Reference attribute; echoed from request |
|O_2.		|`result`	|O|	Integer	|Y|	Result (return code) <br/>`0` – OK. Customer record found and returned <br/>`5020` – Account Locked – too many invalid attempts <br/>`5021` – Required input field not supplied <br/>`5022` – Account does not have a PIN established <br/>5023 – PIN does not match <br/>`5024` – Account/Email not found <br/>`10681` – cust_name_id doesn’t exist on acct_id <br/>`10682` – cust_name_id doesn’t match email <br/>`10684` – No record for alt_id <br/>`10685` – Multiple records for alt_id (only value returned is list of acct_ids that alt_id is found on) <br/>`10699` – Temporary Password (PIN), must be updated <br/>`11775` - Email address not in valid state. <br/>All others – Internal error |
|O_3.		|`sql_code`	|O|	Integer	|Y|	SQL Return Code |
|O_4.		|`error_detail`	|O|	Varchar(250)	|N|	English description of any generated errors |
| |`customer`	|O|	Structure {	|Y|	Structure of  "customer" data |
|O_5.		|`acct_id`		||Integer	|Y|	Account ID |
|O_6.		|`name_first`	||	Char(40)	|N|	First Name |
|O_7.		|`name_mi`		||Char(40	|N|	Middle Initial |
|O_8.		|`name_last`	||	Char(80)	|Y/N|	Last Name.  Either Last Name or Company Name are required, depending on the value for name_type. |
|O_9.		|`title`		||Char(30)	|N|	Title |
|O_10.		|`company_name`||		Varchar(100)	|N/Y|	Company Name |
|O_11.		|`street_addr_1`||		Char(40)	|N|	Street Address – line 1 |
|O_12.		|`street_addr_2`||	Char(40)	|N|	Street Address – line 2 |
|O_13.		|`city`||		Char(20)	|N|	City |
|O_14.		|`state`||		Char(2)	|N|	State |
|O_15.		|`zip`||		Char(10)	|N|	Zip Code |
|O_16.		|`country`||		Char(8)	|N|	Country |
|O_17.		|`phone_day`||		Char(15)	|N|	Phone Number – daytime (not formatted – strip all spaces, dashes, parens, etc.) |
|O_18.		|`phone_eve`||		Char(15)	|N|	Phone Number – evening |
|O_19.		|`phone_fax`||		Char(10)	|N|	Phone Number – FAX |
|O_20.		|`phone_cell`||		Char(15)	|N|	Phone Number – Cell |
|O_21.		|`phone_alt1`||		Char(15)	|N|	Phone Number – alternate 1 | 
|O_22.		|`phone_alt2`||		Char(15)	|N|	Phone Number – alternate 2 |
|O_23.		|`email`||		Char(100)	|N|	E-mail address |
|O_24.		|`birth_date`||		Date	|N|	Birth date |
|O_25.		|`gender`||		Char(1)	|N|	Gender (Male, Female) |
|O_26.		|`ext_system_id_1`|| 		Char(10)	|N|	ID for linkage to an external system (1 of 2). This attribute is associated with an account. |
|O_27.		|`ext_system_id_2`|	|	Char(10)	|N|	ID for linkage to an external system (2 of 2). This attribute is associated with an account. |
|O_28.		|`add_date`| 	|	Date	|Y|	Date the customer was added to the system (Note that this column is not available to the Customer_Add or Customer_Update API calls) |
|O_29.		|`acct_type`| |		Char(20)	|Y|	Account type (Note that this column is not available to the Customer_Add or Customer_Update API calls) |
|O_30.		|`email_optout`|	|	Boolean	|N|	Option to not receive email from client (1 = Opt Out) |
|O_31.		|`email_deliv_opt`|	|	Char(1)	|N|	Option to how to get email delivered <br/>H – HTML <br/>T – Text |
|O_32.		|`text_on_mobile_phone`||		Boolean	|N|	Does this consumer allow text messages to be sent to their mobile phone? (0 = No, 1 = Yes) |
|O_33.		|`name_type`|	|	Char(1)	|N|	Is name an "I"ndividual or a "C"ompany <br/>** not allowed on customer_update. |
|O_34.		|`acct_access_level`|	|	Char(1)	|N|	AccountManager Access Level: "F" is full, "R" is restricted., other values TBD.  Defaults to "F" |
|O_35.		|`cust_name_id`||		Integer	|Y|	id of the customer. |
||	`array of alternate ids` |      |{|		| Alt_id_array |
|O_36.		|`alt_id_type`|		|Char(6)	|N|	Name of alternate ID. This attribute is associated with a customer name. |
|O_37.		|`alt_id`|		|Varchar(50)	|N|	Value of alternate ID. This attribute is associated with a customer name. |
|O_38.		|`alt_id_comment`|		|Varchar(100)	|N|	Comment associated with alternate ID |
|O_39.		|`alt_id_action`|		|Char(1)	|N|	Only applies to Customer_Update <br/> ‘A’ to add the alt_id (default)<br/> ‘D’ to delete an existing alt_id |
|         |   | |}  ||		** end of "alternate IDs ** (alt_id_array) |
|         |   | |}	||	** End of  "customer" structure ** |
|O_40.		|`logon_attempts`	|O|	Integer	|Y|	Number of invalid logon attempts  (including this attempt) | 
|O_41.		|`change_pin`	|O|	Boolean	|N|	Force the user to change their PIN (1 = Force change) |
|O_42.		|`other_info_1`	|O|	Char(100)	|N|	acct level free form information |
|O_43.		|`other_info_2`	|O|	Char(100)	|N|	acct level free form information |
|O_44.		|`other_info_3`	|O|	Char(100)	|N|	acct level free form information |
|O_45.		|`other_info_4`	|O|	Char(100)	|N|	acct level free form information |
|O_46.		|`other_info_5`	|O|	Char(100)	|N|	acct level free form information | 
|O_47.		|`other_info_6`	|O|	Char(100)	|N|	acct level free form information |
|O_48.		|`other_info_7`	|O|	Char(100)	|N|	acct level free form information |
|O_49.		|`other_info_8`	|O|	Char(100)	|N|	acct level free form information |
|O_50.		|`other_info_9`	|O|	Char(100)	|N|	acct level free form information |
|O_51.		|`other_info_10`	|O|	Char(100)	|N|	acct level free form information |
|O_52.		|`account_id_list`	|O|	Long varchar	|Y|	Comma delimited list of accounts that input acct id or email is found on.   Only meaningful when email or alt_id is input. |
|O_53.		|`account_nickname`	|O|	Varchar(40)	|Y|	List of Nicknames for account that this customer is associated with |
|O_54.		|`other_info_11`	|O|	Char(100)	|N|	acct level free form information |
|O_55.		|`other_info_12`	|O|	Char(100)	|N|	acct level free form information |
|O_56.		|`other_info_13`	|O|	Char(100)	|N|	acct level free form information |
|O_57.		|`other_info_14`	|O|	Char(100)	|N|	acct level free form information |
|O_58.		|`other_info_15`	|O|	Char(100)	|N|	acct level free form information |
|O_59.		|`other_info_16`	|O|	Char(100)	|N|	acct level free form information |
|O_60.		|`other_info_17`	|O|	Char(100)	|N|	acct level free form information |
|O_61.		|`other_info_18`	|O|	Char(100)	|N|	acct level free form information |
|O_62.		|`other_info_19`	|O|	Char(100)	|N|	acct level free form information |
|O_63.		|`other_info_20`	|O|	Char(100)	|N|	acct level free form information |
|O_64.		|`rec_status`	|O|	Varchar(20)	||	Rec Status |
|O_65.		|`rec_status_list`	|O|	Long Varchar	||	Comma delimited list of rec status that input acct id or email is found on. Only meaningful when Account_id_list is populated. |
|| `array of account group ids` 	| |{|		| account_groups |
|O_66.		|`account_group`		|Integer	|N|	Account Group ID (aka Membership ID) that this consumer is a member of |
|||       |}|    |		** end of "Account Group IDs" ** (account_groups)


### Sample JSON Call - using [acct_id]:

{% highlight http %}
POST /url HTTP/1.1
Content-Type: application/json;

{
  "header": {
    "ver": 1,
    "src_sys_type": 2,
    "src_sys_name": "test",
    "archtics_version": "V999"
  },
  "command1": {
    "cmd": "customer_query",
    "ref": "optional-reference",
    "uid": "user99",
    "dsn": "apigee",
    "site_name": "vanilla",
    "acct_id": 100479,
    "call_reason": "S"
  }
}
{% endhighlight %}

### Sample JSON Call - using [alt_id] and [alt_id_type]:

{% highlight http %}
POST /url HTTP/1.1
Content-Type: application/json;

{
  "header": {
    "ver": 1,
    "src_sys_type": 2,
    "src_sys_name": "test",
    "archtics_version": "V999"
  },
  "command1": {
    "cmd": "customer_query",
    "uid": "user99",
    "dsn": "apigee",
    "alt_id": "LOYALTY-123",
    "alt_id_type": "LOY",
    "call_reason": "S"
  }
}
{% endhighlight %}

### Sample JSON Call - using [PIN]:
{% highlight http %}
POST /url HTTP/1.1
Content-Type: application/json;

{
  "header": {
    "ver": 1,
    "src_sys_type": 2,
    "src_sys_name": "test",
    "archtics_version": "V999"
  },
  "command1": {
    "cmd": "customer_query",
     "ref": "optional-123",
     "uid": "user99",
     "dsn": "apigee",
     "site_name": "vanilla",
     "acct_id": 100479,
     "pin": "123123"
  }
}
{% endhighlight %}

### Sample JSON Call/Response - using [email address]:

>[Request](#req)
>[Response](#res)
{: .reqres}

{% highlight http %}
POST /url HTTP/1.1
Content-Type: application/json;

{
  "header": {
    "ver": 1,
    "src_sys_type": 2,
    "src_sys_name": "test",
    "archtics_version": "V999"
  },
  "command1": {
    "cmd": "customer_query",
    "ref": "optional-123",
    "uid": "user99",
    "dsn": "apigee",
    "site_name": "vanilla",
    "email": "john.q@mailinator.com ",
    "call_reason": "S"
  }
}
{% endhighlight %}

{% highlight http %}
HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8

{
  "command1": {
      "cmd": "customer_query",
      "account_groups": [
        {
          "account_group": "0"
        },
        {
          "account_group": "1"
        }
      ],
      "logon_attempts": 0,
      "account_id_list": "100479",
      "customer": {
        "name_type": "I",
        "phone_fax": "5310869753",
        "name_mi": "Q",
        "add_date": "2016-04-11",
        "name_last": "Public",
        "email_deliv_opt": "H",
        "zip": "43201",
        "acct_access_level": "F",
        "acct_type": "Personal",
        "state": "OH",
        "acct_id": 100479,
        "owner_name": "John Q. Public",
        "cust_name_id": "2",
        "country": "USA",
        "name_first": "John",
        "email_optout": 0,
        "city": "Columbus",
        "text_on_mobile_phone": 0,
        "phone_day": "9876543210",
        "phone_eve": "7654321098",
        "street_addr_2": "Apt 307",
        "street_addr_1": "85 Treetop Lane",
        "email": "john.q@mailinator.com"
      },
      "change_pin": 0,
      "rec_status": "Active",
      "result": 0,
      "ref": "optional-reference",
      "sql_code": 0
    },
    "header": {
      "src_sys_type": 2,
      "archtics_version": "V999",
      "ver": 1,
      "src_sys_name": "test",
      "ats_version": "4.23.3",
      "result": 0
    }
}
{% endhighlight %}